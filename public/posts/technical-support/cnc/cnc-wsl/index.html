<!doctype html><html lang=ko dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>RyanLabs</title>
<meta name=keywords content><meta name=description content="curl -k -vvv https://bd-82898.local ì‹¤íŒ¨
ğŸ” ë¬¸ì œ ë¶„ì„: curl -k -vvv https://bd-82898.local ì‹¤íŒ¨ (SSL_ERROR_SYSCALL)
ğŸš¨ ë¬¸ì œ ìš”ì•½

curl -k -vvv https://bd-82898.local ì‹¤í–‰ ì‹œ TLS í•¸ë“œì…°ì´í¬ ì‹¤íŒ¨ (SSL_ERROR_SYSCALL).
curl ë¡œê·¸:
* OpenSSL SSL_connect: SSL_ERROR_SYSCALL in connection to bd-82898.local:443

bd-82898.localì˜ IP ì£¼ì†ŒëŠ” 127.0.0.1ë¡œ í•´ì„ë¨ (ë¡œì»¬ í˜¸ìŠ¤íŠ¸ì—ì„œ ì‹¤í–‰ ì¤‘).
kubectl ë¡œê·¸ì—ì„œ Ingress Nginx ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ì •ìƒì ìœ¼ë¡œ ì‹¤í–‰ë˜ì§€ ì•ŠìŒ (Deployment is not ready: 0 out of 1 expected pods are ready).


ğŸ” ì›ì¸ ë¶„ì„
1ï¸âƒ£ Ingress Nginxê°€ ì •ìƒì ìœ¼ë¡œ ì‹¤í–‰ë˜ì§€ ì•ŠìŒ

ë¡œê·¸ì—ì„œ Ingress Nginx ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ì •ìƒì ìœ¼ë¡œ ê¸°ë™ë˜ì§€ ì•Šì•˜ë‹¤ëŠ” ë©”ì‹œì§€ê°€ ë°˜ë³µë¨:
Deployment is not ready: ingress-nginx/my-nginx-ingress-nginx-controller. 0 out of 1 expected pods are ready

kubectl get pods -n ingress-nginx ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ì—¬ Ingress Controller Pod ìƒíƒœë¥¼ í™•ì¸í•´ì•¼ í•¨.

âœ… í•´ê²° ë°©ë²•"><meta name=author content><link rel=canonical href=https://jongyongpark.github.io/posts/technical-support/cnc/cnc-wsl/><link crossorigin=anonymous href=/assets/css/stylesheet.9de45e225101e4f99701d2b68fc6b8a1ef6027928be6391fa15bf7f56326c909.css integrity="sha256-neReIlEB5PmXAdK2j8a4oe9gJ5KL5jkfoVv39WMmyQk=" rel="preload stylesheet" as=style><link rel=icon href=https://jongyongpark.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://jongyongpark.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://jongyongpark.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://jongyongpark.github.io/apple-touch-icon.png><link rel=mask-icon href=https://jongyongpark.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=ko href=https://jongyongpark.github.io/posts/technical-support/cnc/cnc-wsl/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://jongyongpark.github.io/posts/technical-support/cnc/cnc-wsl/"><meta property="og:site_name" content="RyanLabs"><meta property="og:title" content="RyanLabs"><meta property="og:description" content="curl -k -vvv https://bd-82898.local ì‹¤íŒ¨ ğŸ” ë¬¸ì œ ë¶„ì„: curl -k -vvv https://bd-82898.local ì‹¤íŒ¨ (SSL_ERROR_SYSCALL) ğŸš¨ ë¬¸ì œ ìš”ì•½ curl -k -vvv https://bd-82898.local ì‹¤í–‰ ì‹œ TLS í•¸ë“œì…°ì´í¬ ì‹¤íŒ¨ (SSL_ERROR_SYSCALL). curl ë¡œê·¸: * OpenSSL SSL_connect: SSL_ERROR_SYSCALL in connection to bd-82898.local:443 bd-82898.localì˜ IP ì£¼ì†ŒëŠ” 127.0.0.1ë¡œ í•´ì„ë¨ (ë¡œì»¬ í˜¸ìŠ¤íŠ¸ì—ì„œ ì‹¤í–‰ ì¤‘). kubectl ë¡œê·¸ì—ì„œ Ingress Nginx ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ì •ìƒì ìœ¼ë¡œ ì‹¤í–‰ë˜ì§€ ì•ŠìŒ (Deployment is not ready: 0 out of 1 expected pods are ready). ğŸ” ì›ì¸ ë¶„ì„ 1ï¸âƒ£ Ingress Nginxê°€ ì •ìƒì ìœ¼ë¡œ ì‹¤í–‰ë˜ì§€ ì•ŠìŒ ë¡œê·¸ì—ì„œ Ingress Nginx ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ì •ìƒì ìœ¼ë¡œ ê¸°ë™ë˜ì§€ ì•Šì•˜ë‹¤ëŠ” ë©”ì‹œì§€ê°€ ë°˜ë³µë¨: Deployment is not ready: ingress-nginx/my-nginx-ingress-nginx-controller. 0 out of 1 expected pods are ready kubectl get pods -n ingress-nginx ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ì—¬ Ingress Controller Pod ìƒíƒœë¥¼ í™•ì¸í•´ì•¼ í•¨. âœ… í•´ê²° ë°©ë²•"><meta property="og:locale" content="ko"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta name=twitter:card content="summary"><meta name=twitter:title content><meta name=twitter:description content="curl -k -vvv https://bd-82898.local ì‹¤íŒ¨
ğŸ” ë¬¸ì œ ë¶„ì„: curl -k -vvv https://bd-82898.local ì‹¤íŒ¨ (SSL_ERROR_SYSCALL)
ğŸš¨ ë¬¸ì œ ìš”ì•½

curl -k -vvv https://bd-82898.local ì‹¤í–‰ ì‹œ TLS í•¸ë“œì…°ì´í¬ ì‹¤íŒ¨ (SSL_ERROR_SYSCALL).
curl ë¡œê·¸:
* OpenSSL SSL_connect: SSL_ERROR_SYSCALL in connection to bd-82898.local:443

bd-82898.localì˜ IP ì£¼ì†ŒëŠ” 127.0.0.1ë¡œ í•´ì„ë¨ (ë¡œì»¬ í˜¸ìŠ¤íŠ¸ì—ì„œ ì‹¤í–‰ ì¤‘).
kubectl ë¡œê·¸ì—ì„œ Ingress Nginx ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ì •ìƒì ìœ¼ë¡œ ì‹¤í–‰ë˜ì§€ ì•ŠìŒ (Deployment is not ready: 0 out of 1 expected pods are ready).


ğŸ” ì›ì¸ ë¶„ì„
1ï¸âƒ£ Ingress Nginxê°€ ì •ìƒì ìœ¼ë¡œ ì‹¤í–‰ë˜ì§€ ì•ŠìŒ

ë¡œê·¸ì—ì„œ Ingress Nginx ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ì •ìƒì ìœ¼ë¡œ ê¸°ë™ë˜ì§€ ì•Šì•˜ë‹¤ëŠ” ë©”ì‹œì§€ê°€ ë°˜ë³µë¨:
Deployment is not ready: ingress-nginx/my-nginx-ingress-nginx-controller. 0 out of 1 expected pods are ready

kubectl get pods -n ingress-nginx ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ì—¬ Ingress Controller Pod ìƒíƒœë¥¼ í™•ì¸í•´ì•¼ í•¨.

âœ… í•´ê²° ë°©ë²•"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://jongyongpark.github.io/posts/"},{"@type":"ListItem","position":2,"name":"","item":"https://jongyongpark.github.io/posts/technical-support/cnc/cnc-wsl/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"","name":"","description":"curl -k -vvv https://bd-82898.local ì‹¤íŒ¨ ğŸ” ë¬¸ì œ ë¶„ì„: curl -k -vvv https://bd-82898.local ì‹¤íŒ¨ (SSL_ERROR_SYSCALL) ğŸš¨ ë¬¸ì œ ìš”ì•½ curl -k -vvv https://bd-82898.local ì‹¤í–‰ ì‹œ TLS í•¸ë“œì…°ì´í¬ ì‹¤íŒ¨ (SSL_ERROR_SYSCALL). curl ë¡œê·¸: * OpenSSL SSL_connect: SSL_ERROR_SYSCALL in connection to bd-82898.local:443 bd-82898.localì˜ IP ì£¼ì†ŒëŠ” 127.0.0.1ë¡œ í•´ì„ë¨ (ë¡œì»¬ í˜¸ìŠ¤íŠ¸ì—ì„œ ì‹¤í–‰ ì¤‘). kubectl ë¡œê·¸ì—ì„œ Ingress Nginx ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ì •ìƒì ìœ¼ë¡œ ì‹¤í–‰ë˜ì§€ ì•ŠìŒ (Deployment is not ready: 0 out of 1 expected pods are ready). ğŸ” ì›ì¸ ë¶„ì„ 1ï¸âƒ£ Ingress Nginxê°€ ì •ìƒì ìœ¼ë¡œ ì‹¤í–‰ë˜ì§€ ì•ŠìŒ ë¡œê·¸ì—ì„œ Ingress Nginx ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ì •ìƒì ìœ¼ë¡œ ê¸°ë™ë˜ì§€ ì•Šì•˜ë‹¤ëŠ” ë©”ì‹œì§€ê°€ ë°˜ë³µë¨: Deployment is not ready: ingress-nginx/my-nginx-ingress-nginx-controller. 0 out of 1 expected pods are ready kubectl get pods -n ingress-nginx ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ì—¬ Ingress Controller Pod ìƒíƒœë¥¼ í™•ì¸í•´ì•¼ í•¨. âœ… í•´ê²° ë°©ë²•\n","keywords":[],"articleBody":"curl -k -vvv https://bd-82898.local ì‹¤íŒ¨ ğŸ” ë¬¸ì œ ë¶„ì„: curl -k -vvv https://bd-82898.local ì‹¤íŒ¨ (SSL_ERROR_SYSCALL) ğŸš¨ ë¬¸ì œ ìš”ì•½ curl -k -vvv https://bd-82898.local ì‹¤í–‰ ì‹œ TLS í•¸ë“œì…°ì´í¬ ì‹¤íŒ¨ (SSL_ERROR_SYSCALL). curl ë¡œê·¸: * OpenSSL SSL_connect: SSL_ERROR_SYSCALL in connection to bd-82898.local:443 bd-82898.localì˜ IP ì£¼ì†ŒëŠ” 127.0.0.1ë¡œ í•´ì„ë¨ (ë¡œì»¬ í˜¸ìŠ¤íŠ¸ì—ì„œ ì‹¤í–‰ ì¤‘). kubectl ë¡œê·¸ì—ì„œ Ingress Nginx ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ì •ìƒì ìœ¼ë¡œ ì‹¤í–‰ë˜ì§€ ì•ŠìŒ (Deployment is not ready: 0 out of 1 expected pods are ready). ğŸ” ì›ì¸ ë¶„ì„ 1ï¸âƒ£ Ingress Nginxê°€ ì •ìƒì ìœ¼ë¡œ ì‹¤í–‰ë˜ì§€ ì•ŠìŒ ë¡œê·¸ì—ì„œ Ingress Nginx ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ì •ìƒì ìœ¼ë¡œ ê¸°ë™ë˜ì§€ ì•Šì•˜ë‹¤ëŠ” ë©”ì‹œì§€ê°€ ë°˜ë³µë¨: Deployment is not ready: ingress-nginx/my-nginx-ingress-nginx-controller. 0 out of 1 expected pods are ready kubectl get pods -n ingress-nginx ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ì—¬ Ingress Controller Pod ìƒíƒœë¥¼ í™•ì¸í•´ì•¼ í•¨. âœ… í•´ê²° ë°©ë²•\nkubectl get pods -n ingress-nginx ë§Œì•½ CrashLoopBackOff ë˜ëŠ” Error ìƒíƒœë¼ë©´ ë¡œê·¸ í™•ì¸: kubectl logs -n ingress-nginx 2ï¸âƒ£ HTTPS í¬íŠ¸(443)ê°€ ì œëŒ€ë¡œ ë¦¬ìŠ¤ë‹ë˜ì§€ ì•ŠìŒ curlì´ 127.0.0.1:443ì— ì—°ê²°í•˜ë ¤ í•˜ì§€ë§Œ TLS í•¸ë“œì…°ì´í¬ê°€ ì‹¤íŒ¨í•¨. netstat ë˜ëŠ” ss ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•˜ì—¬ í¬íŠ¸ 443ì´ ì—´ë ¤ ìˆëŠ”ì§€ í™•ì¸í•´ì•¼ í•¨. âœ… í•´ê²° ë°©ë²•\nnetstat -tulnp | grep :443 ì •ìƒì ì¸ ê²½ìš°: tcp LISTEN 0 128 0.0.0.0:443 0.0.0.0:* nginx ë§Œì•½ ì•„ë¬´ê²ƒë„ ì¶œë ¥ë˜ì§€ ì•ŠëŠ”ë‹¤ë©´ Ingress Nginxê°€ í¬íŠ¸ë¥¼ ì œëŒ€ë¡œ ë¦¬ìŠ¤ë‹í•˜ì§€ ì•ŠëŠ” ê²ƒ. 3ï¸âƒ£ TLS ì¸ì¦ì„œ ë¬¸ì œ curl -k ì˜µì…˜ì„ ì‚¬ìš©í•´ë„ TLS ì˜¤ë¥˜ê°€ ë°œìƒí•¨ â†’ ì¸ì¦ì„œê°€ ì œëŒ€ë¡œ êµ¬ì„±ë˜ì§€ ì•Šì•˜ì„ ê°€ëŠ¥ì„±ì´ ìˆìŒ. cnc-deploy ë¡œê·¸ë¥¼ ë³´ë©´ CNC_CIM_TLS_NGINX_SECRET_NAME=\"cnc-cim-tls-nginx\" í™˜ê²½ ë³€ìˆ˜ê°€ ì„¤ì •ë˜ì–´ ìˆìŒ. âœ… í•´ê²° ë°©ë²•\nkubectl get secret -n ingress-nginx cnc-cim-tls-nginx -o yaml ë§Œì•½ ì¡´ì¬í•˜ì§€ ì•ŠëŠ”ë‹¤ë©´: echo \"TLS Secretì´ ì¡´ì¬í•˜ì§€ ì•ŠìŒ. ìƒˆë¡œ ìƒì„± í•„ìš”\" TLS ì¸ì¦ì„œë¥¼ ë‹¤ì‹œ ìƒì„±í•˜ê³  ì ìš©í•´ì•¼ í•¨. ğŸš€ í•´ê²° ë°©ë²• ìš”ì•½ âœ… 1. Ingress Nginx Pod ìƒíƒœ í™•ì¸\nkubectl get pods -n ingress-nginx kubectl logs -n ingress-nginx ì˜¤ë¥˜ ë¡œê·¸ ë¶„ì„ í›„ ì¡°ì¹˜. âœ… 2. 443 í¬íŠ¸ í™•ì¸\nnetstat -tulnp | grep :443 í¬íŠ¸ê°€ ë¦¬ìŠ¤ë‹ ì¤‘ì¸ì§€ í™•ì¸. âœ… 3. TLS ì¸ì¦ì„œ í™•ì¸ ë° ì¬ì„¤ì •\nkubectl get secret -n ingress-nginx cnc-cim-tls-nginx -o yaml ì¡´ì¬í•˜ì§€ ì•Šìœ¼ë©´ ìƒˆë¡œìš´ ì¸ì¦ì„œ ìƒì„± í›„ ì ìš©. ì´ì œ ìœ„ ë‹¨ê³„ë¥¼ ì‹¤í–‰í•˜ê³  ê²°ê³¼ë¥¼ í™•ì¸í•œ í›„ ì¶”ê°€ì ì¸ ì¡°ì¹˜ë¥¼ ì·¨í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ğŸš€ curl -k -vvv https://bd-82898.local ì‹¤íŒ¨ ğŸ” ë¬¸ì œ ë¶„ì„ \u0026 í•´ê²° ë°©ë²•: curl -k -vvv https://bd-82898.local ì‹¤íŒ¨ (SSL_ERROR_SYSCALL) ğŸš¨ ë¬¸ì œ ìš”ì•½ Ingress Controllerê°€ ì •ìƒì ìœ¼ë¡œ ì‹¤í–‰ ì¤‘ (1/1 Running)\nkubectl get pods -n ingress-nginx NAME READY STATUS RESTARTS AGE\rmy-nginx-ingress-nginx-controller-57f6bc457c-k9x7c 1/1 Running 0 59m TLS ì¸ì¦ì„œ cnc-cim-tls-nginxê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŒ\nkubectl get secret -n ingress-nginx cnc-cim-tls-nginx -o yaml Error from server (NotFound): secrets \"cnc-cim-tls-nginx\" not found Ingress Controller ë¡œê·¸ì—ì„œ SSL ì¸ì¦ì„œ ë¡œë”© ì‹¤íŒ¨\nW0312 09:56:08.059301 10 controller.go:1306] Error getting SSL certificate \"cnc/cnc-cim-tls-nginx\": local SSL certificate cnc/cnc-cim-tls-nginx was not found. Using default certificate ì„œë¹„ìŠ¤ Endpoint ì—†ìŒ\nW0312 09:56:08.059231 10 controller.go:1083] Service \"cnc/cnc-minio\" does not have any active Endpoint.\rW0312 09:56:08.059231 10 controller.go:1083] Service \"cnc/cnc-cim-cnc-storage-proxy\" does not have any active Endpoint. ğŸ” ë¬¸ì œì˜ ì›ì¸ TLS ì¸ì¦ì„œê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŒ (cnc-cim-tls-nginx secret ëˆ„ë½)\nIngressëŠ” cnc-cim-tls-nginxë¥¼ ì°¸ì¡°í•˜ì§€ë§Œ, í•´ë‹¹ Secretì´ ìƒì„±ë˜ì§€ ì•ŠìŒ. í˜„ì¬ ê¸°ë³¸ fake-certificate.pemì„ ì‚¬ìš© ì¤‘. Ingressì— ì—°ê²°ëœ ì„œë¹„ìŠ¤(cnc-minio, cnc-cim-cnc-storage-proxy, cnc-cim-cim)ê°€ í™œì„±í™”ë˜ì§€ ì•ŠìŒ\nIngress ControllerëŠ” ëŒ€ìƒ ì„œë¹„ìŠ¤ë¡œ ìš”ì²­ì„ ì „ë‹¬í•´ì•¼ í•˜ì§€ë§Œ, ì„œë¹„ìŠ¤ Endpointê°€ í™œì„±í™”ë˜ì§€ ì•ŠìŒ. IngressëŠ” ì •ìƒ ì‘ë™í•˜ì§€ë§Œ, ë°±ì—”ë“œ ì„œë¹„ìŠ¤ê°€ ì¤€ë¹„ë˜ì§€ ì•ŠìŒ. Ingressê°€ 127.0.0.1ì—ì„œ ë¦¬ìŠ¤ë‹í•˜ëŠ”ì§€ í™•ì¸ í•„ìš”\ncurl ëª…ë ¹ì–´ê°€ 127.0.0.1:443ë¡œ ìš”ì²­ì„ ë³´ë‚´ê³  ìˆìŒ. kubectl get svc -n ingress-nginxë¡œ ingress-nginx ì„œë¹„ìŠ¤ê°€ ì–´ë–¤ IPì—ì„œ ë¦¬ìŠ¤ë‹í•˜ëŠ”ì§€ í™•ì¸ í•„ìš”. ğŸš€ í•´ê²° ë°©ë²• 1ï¸âƒ£ TLS ì¸ì¦ì„œ (cnc-cim-tls-nginx) ìƒì„± ë° ì ìš© í˜„ì¬ cnc-cim-tls-nginx Secretì´ ì—†ê¸° ë•Œë¬¸ì— ìƒˆë¡œ ìƒì„±í•´ì•¼ í•©ë‹ˆë‹¤.\nkubectl create secret tls cnc-cim-tls-nginx -n ingress-nginx \\ --cert=/path/to/your/cert.pem \\ --key=/path/to/your/key.pem âœ… í™•ì¸ ë°©ë²•\nkubectl get secret -n ingress-nginx cnc-cim-tls-nginx Secretì´ ì •ìƒì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆëŠ”ì§€ í™•ì¸ í›„, Ingress Controllerë¥¼ ë‹¤ì‹œ ì‹œì‘í•©ë‹ˆë‹¤. kubectl rollout restart deployment -n ingress-nginx my-nginx-ingress-nginx-controller 2ï¸âƒ£ Ingress Controllerê°€ 443 í¬íŠ¸ë¥¼ ë¦¬ìŠ¤ë‹í•˜ëŠ”ì§€ í™•ì¸ í˜„ì¬ curlì´ 127.0.0.1:443ë¡œ ìš”ì²­ì„ ë³´ë‚´ê³  ìˆìœ¼ë¯€ë¡œ, ingress-nginx ì„œë¹„ìŠ¤ê°€ ì‹¤ì œë¡œ 443ì—ì„œ ë¦¬ìŠ¤ë‹í•˜ëŠ”ì§€ í™•ì¸í•´ì•¼ í•©ë‹ˆë‹¤.\nkubectl get svc -n ingress-nginx âœ… ì˜ˆì œ ì¶œë ¥\nNAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE\rmy-nginx-ingress-nginx-controller LoadBalancer 10.96.58.210 80:31873/TCP,443:31874/TCP 59m PORT(S)ì—ì„œ 443ì´ ë¦¬ìŠ¤ë‹í•˜ëŠ”ì§€ í™•ì¸. ğŸš¨ í¬íŠ¸ê°€ 443ì´ ì•„ë‹ˆë¼ë©´ Ingress ì„¤ì •ì„ ë³€ê²½í•´ì•¼ í•¨.\ningress-nginxê°€ NodePort ë˜ëŠ” LoadBalancerë¡œ ë°°í¬ë˜ì—ˆëŠ”ì§€ í™•ì¸ í›„ ìˆ˜ì •. 3ï¸âƒ£ ì„œë¹„ìŠ¤ Endpoint ë¬¸ì œ í•´ê²° Ingressê°€ ì •ìƒ ì‘ë™í•˜ë ¤ë©´ cnc-minio, cnc-cim-cnc-storage-proxy, cnc-cim-cim ì„œë¹„ìŠ¤ê°€ í™œì„±í™”ë˜ì–´ ìˆì–´ì•¼ í•©ë‹ˆë‹¤.\nkubectl get pods -n cnc kubectl get svc -n cnc âœ… ì„œë¹„ìŠ¤ê°€ ë¹„í™œì„± ìƒíƒœì´ë©´ ë‹¤ì‹œ ì‹œì‘\nkubectl rollout restart deployment -n cnc cnc-minio cnc-cim-cnc-storage-proxy cnc-cim-cim ğŸš¨ íŠ¹ì • ì„œë¹„ìŠ¤ì˜ Podì´ CrashLoopBackOff ìƒíƒœë¼ë©´ ë¡œê·¸ í™•ì¸\nkubectl logs -n cnc í•´ë‹¹ ì„œë¹„ìŠ¤ê°€ ì •ìƒì ìœ¼ë¡œ ì‹¤í–‰ë˜ì§€ ì•Šìœ¼ë©´ Ingressê°€ íŠ¸ë˜í”½ì„ ì „ë‹¬í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\nâœ… ìµœì¢… ì ê²€ TLS ì¸ì¦ì„œ Secret ìƒì„±\nkubectl get secret -n ingress-nginx cnc-cim-tls-nginx ì¡´ì¬í•˜ì§€ ì•Šìœ¼ë©´ ìƒì„± í›„ Ingress Controller ì¬ì‹œì‘. Ingressê°€ 443 í¬íŠ¸ì—ì„œ ë¦¬ìŠ¤ë‹ ì¤‘ì¸ì§€ í™•ì¸\nkubectl get svc -n ingress-nginx ì—°ê²°ëœ ì„œë¹„ìŠ¤ê°€ ì •ìƒì ìœ¼ë¡œ ì‹¤í–‰ ì¤‘ì¸ì§€ í™•ì¸\nkubectl get pods -n cnc kubectl get svc -n cnc ëª¨ë“  ì„¤ì • í›„ curl ë‹¤ì‹œ ì‹¤í–‰\ncurl -k -vvv https://bd-82898.local ì´ì œ ìœ„ ë‹¨ê³„ëŒ€ë¡œ ìˆ˜í–‰í•˜ë©´ TLS ë¬¸ì œì™€ ì„œë¹„ìŠ¤ ì—°ê²° ë¬¸ì œë¥¼ í•´ê²°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤! ğŸš€ Secret ìƒì„± í›„ Helm ì¬ì„¤ì¹˜(install) í•„ìš” ì—¬ë¶€ ğŸ” Secret ìƒì„± í›„ Helm ì¬ì„¤ì¹˜(install) í•„ìš” ì—¬ë¶€ ë¶„ì„ í˜„ì¬ kubectl create secret tls ... | kubectl apply -f - ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ì—¬ TLS Secretì„ ìƒì„±í•˜ê³  ì ìš©í•˜ì˜€ìŠµë‹ˆë‹¤.\nâœ… Secretì´ ì •ìƒì ìœ¼ë¡œ ì ìš©ë˜ì—ˆëŠ”ì§€ í™•ì¸:\nkubectl get secret -n ingress-nginx cnc-cim-tls-nginx -o yaml kubectl get secret -n ingress-nginx cnc-certificate -o yaml Secretì´ ingress-nginx ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì— ì •ìƒì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤. ğŸš€ Helm ì¬ì„¤ì¹˜ê°€ í•„ìš”í•œê°€? âœ… Helm ì¬ì„¤ì¹˜ê°€ í•„ìš” ì—†ëŠ” ê²½ìš° ê¸°ì¡´ Helm ì°¨íŠ¸ê°€ Secretì„ ì°¸ì¡°í•  ë•Œ ì§ì ‘ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì—ì„œ ê°€ì ¸ì˜¤ë„ë¡ êµ¬ì„±ëœ ê²½ìš°. Ingress ë˜ëŠ” ë‹¤ë¥¸ ê´€ë ¨ ë¦¬ì†ŒìŠ¤ê°€ Secretì„ ì°¸ì¡°í•˜ê³  ìˆìœ¼ë©°, Secretì´ ìƒˆë¡œ ì ìš©ëœ ê²½ìš° Helm ì¬ì„¤ì¹˜ ì—†ì´ ì ìš©ë¨. ì•„ë˜ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ì—¬ Ingress ì„¤ì •ì´ ìë™ìœ¼ë¡œ ë°˜ì˜ë˜ëŠ”ì§€ í™•ì¸: kubectl rollout restart deployment -n ingress-nginx my-nginx-ingress-nginx-controller Ingress Controllerê°€ Secret ë³€ê²½ ì‚¬í•­ì„ ìë™ìœ¼ë¡œ ê°ì§€í•˜ë©´ Helm ì¬ì„¤ì¹˜ ì—†ì´ ì ìš©ë¨. âŒ Helm ì¬ì„¤ì¹˜ê°€ í•„ìš”í•œ ê²½ìš° Helm ì°¨íŠ¸ê°€ Secretì„ ë¯¸ë¦¬ ìƒì„±í•˜ëŠ” ë°©ì‹(Helmì˜ values.yamlì—ì„œ Secretì„ ê´€ë¦¬)ìœ¼ë¡œ ë˜ì–´ ìˆë‹¤ë©´, Helmì´ Secretì„ ë‹¤ì‹œ ë°°í¬í•  í•„ìš”ê°€ ìˆìŒ. ê¸°ì¡´ Ingress ë¦¬ì†ŒìŠ¤ê°€ ìƒˆë¡œìš´ Secretì„ ì°¸ì¡°í•˜ë„ë¡ ì—…ë°ì´íŠ¸ë˜ì§€ ì•Šì€ ê²½ìš°. í™•ì¸ ë°©ë²•: helm get values my-helm-release -n cnc tls.secretName ê°’ì´ cnc-cim-tls-nginxë¡œ ì„¤ì •ë˜ì–´ ìˆì§€ ì•Šë‹¤ë©´, Helm ê°’ì„ ì—…ë°ì´íŠ¸í•´ì•¼ í•¨. âœ… Helm ì¬ì„¤ì¹˜ ì—†ì´ ì ìš© ê°€ëŠ¥í•œ ë°©ë²• (Ingress ê°•ì œ ì—…ë°ì´íŠ¸)\nkubectl annotate ingress cnc-cim --overwrite kubernetes.io/ingress.class=nginx kubectl rollout restart deployment -n ingress-nginx my-nginx-ingress-nginx-controller Ingressë¥¼ ê°•ì œë¡œ ë‹¤ì‹œ ì ìš©í•˜ì—¬ ìƒˆë¡œìš´ Secretì„ ì‚¬ìš©í•˜ë„ë¡ í•¨. âœ… Helm ì—…ë°ì´íŠ¸ ì ìš©ì´ í•„ìš”í•œ ê²½ìš°\nhelm upgrade --install my-helm-release ./helm-chart -n cnc helm upgradeë¥¼ ì‚¬ìš©í•˜ë©´ ê¸°ì¡´ ë¦¬ì†ŒìŠ¤ë¥¼ ìœ ì§€í•˜ë©´ì„œ ë³€ê²½ ì‚¬í•­ì„ ì ìš©í•  ìˆ˜ ìˆìŒ. ğŸš€ ìµœì¢… ê²°ë¡  ìƒí™© Helm ì¬ì„¤ì¹˜ í•„ìš” ì—¬ë¶€ Ingress Controllerê°€ Secret ë³€ê²½ ì‚¬í•­ì„ ìë™ ê°ì§€í•˜ëŠ” ê²½ìš° âŒ í•„ìš” ì—†ìŒ (Ingress ì¬ì‹œì‘ë§Œ í•„ìš”) Helm ì°¨íŠ¸ê°€ Secretì„ ì§ì ‘ ìƒì„±í•˜ëŠ” ê²½ìš° (values.yamlì— ì •ì˜) âœ… helm upgrade í•„ìš” Ingress ë¦¬ì†ŒìŠ¤ê°€ ìƒˆë¡œìš´ Secretì„ ìë™ìœ¼ë¡œ ì°¸ì¡°í•˜ì§€ ì•ŠëŠ” ê²½ìš° âœ… Ingress ê°•ì œ ì¬ì ìš© í•„ìš” (kubectl annotate ingress) ğŸ“Œ ê¶Œì¥ í•´ê²° ë°©ë²•:\nIngress Controller ì¬ì‹œì‘ í›„ í…ŒìŠ¤íŠ¸\nkubectl rollout restart deployment -n ingress-nginx my-nginx-ingress-nginx-controller Ingress ë¦¬ì†ŒìŠ¤ ê°•ì œ ì—…ë°ì´íŠ¸ í›„ í…ŒìŠ¤íŠ¸\nkubectl annotate ingress cnc-cim --overwrite kubernetes.io/ingress.class=nginx ê·¸ë˜ë„ ì ìš©ë˜ì§€ ì•ŠëŠ”ë‹¤ë©´ Helm ì¬ì„¤ì¹˜\nhelm upgrade --install my-helm-release ./helm-chart -n cnc ğŸš€ ìœ„ ë‹¨ê³„ë¥¼ ìˆœì„œëŒ€ë¡œ ì‹¤í–‰ í›„ curl -k -vvv https://bd-82898.localì„ ë‹¤ì‹œ ì‹¤í–‰í•˜ì—¬ ì •ìƒ ì‘ë™í•˜ëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”! /etc/hostsì—ì„œ bd-82898.local ì„¤ì • ë°©ë²• ğŸ” /etc/hostsì—ì„œ bd-82898.local ì„¤ì • ë°©ë²• í˜„ì¬ Ingress Controllerê°€ ë°°í¬ëœ Kubernetes í´ëŸ¬ìŠ¤í„°ì—ì„œ bd-82898.localì„ ì˜¬ë°”ë¥´ê²Œ ì„¤ì •í•˜ë ¤ë©´ /etc/hosts íŒŒì¼ì„ ì ì ˆíˆ ìˆ˜ì •í•´ì•¼ í•©ë‹ˆë‹¤.\nâœ… 1ï¸âƒ£ /etc/hostsì— ì˜¬ë°”ë¥¸ IP ì¶”ê°€í•˜ê¸° í˜„ì¬ curl -k -vvv https://bd-82898.local ì‹¤í–‰ ì‹œ 127.0.0.1ë¡œ í•´ì„ë˜ëŠ”ë°, ì´ê²ƒì´ ì˜¬ë°”ë¥¸ Ingress Controllerì˜ IPê°€ ì•„ë‹ ê°€ëŠ¥ì„±ì´ í½ë‹ˆë‹¤.\nğŸ“Œ Ingressì˜ ì‹¤ì œ External IP í™•ì¸\nkubectl get svc -n ingress-nginx âœ… ì˜ˆì œ ì¶œë ¥:\nNAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE\rmy-nginx-ingress-nginx-controller LoadBalancer 10.96.58.210 192.168.1.100 80:31873/TCP,443:31874/TCP 59m EXTERNAL-IP ê°’ (192.168.1.100)ì´ Ingress Controllerê°€ ì œê³µí•˜ëŠ” ì™¸ë¶€ ì ‘ì† IP. âœ… 2ï¸âƒ£ /etc/hosts ìˆ˜ì • bd-82898.localì„ ì˜¬ë°”ë¥´ê²Œ í•´ì„í•˜ë„ë¡ /etc/hosts íŒŒì¼ì„ ìˆ˜ì •í•´ì•¼ í•©ë‹ˆë‹¤.\nsudo nano /etc/hosts ğŸš€ ì¶”ê°€í•´ì•¼ í•  ë‚´ìš© (ì˜ˆì œ)\n192.168.1.100 bd-82898.local ìœ„ì—ì„œ í™•ì¸í•œ Ingress Controllerì˜ External IP(192.168.1.100)ë¥¼ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤. ë§Œì•½ Ingressê°€ NodePortë¥¼ ì‚¬ìš©í•˜ê³  ìˆë‹¤ë©´, ë§ˆìŠ¤í„° ë…¸ë“œì˜ IPë¥¼ ì‚¬ìš©í•´ì•¼ í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. âœ… íŒŒì¼ ì €ì¥ í›„ ë³€ê²½ ì‚¬í•­ ì ìš©\nsudo systemctl restart networking âœ… 3ï¸âƒ£ ì„¤ì • í™•ì¸ ì„¤ì •ì´ ì œëŒ€ë¡œ ë°˜ì˜ë˜ì—ˆëŠ”ì§€ ping ë˜ëŠ” nslookupìœ¼ë¡œ í™•ì¸í•©ë‹ˆë‹¤.\nping -c 4 bd-82898.local âœ… ì •ìƒì ì¸ ê²½ìš°:\nPING bd-82898.local (192.168.1.100) 56(84) bytes of data.\r64 bytes from 192.168.1.100: icmp_seq=1 ttl=64 time=0.053 ms nslookup bd-82898.local âœ… ì •ìƒì ì¸ ê²½ìš°:\nServer: 127.0.0.53\rAddress: 127.0.0.53#53\rNon-authoritative answer:\rName: bd-82898.local\rAddress: 192.168.1.100 âœ… 4ï¸âƒ£ curlë¡œ í…ŒìŠ¤íŠ¸ ì´ì œ /etc/hostsë¥¼ ìˆ˜ì •í–ˆìœ¼ë¯€ë¡œ ë‹¤ì‹œ curlì„ ì‹¤í–‰í•˜ì—¬ Ingress Controllerê°€ ì •ìƒì ìœ¼ë¡œ ì‘ë‹µí•˜ëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.\ncurl -k -vvv https://bd-82898.local âœ… ì •ìƒì ì¸ ê²½ìš°:\n* Connected to bd-82898.local (192.168.1.100) port 443\r* TLS handshake successful\r...\rHTTP/1.1 200 OK ğŸš¨ ì—¬ì „íˆ SSL/TLS ì˜¤ë¥˜ê°€ ë°œìƒí•œë‹¤ë©´?\nIngressì— ì˜¬ë°”ë¥¸ TLS Secretì´ ì ìš©ë˜ì—ˆëŠ”ì§€ í™•ì¸: kubectl get secret -n ingress-nginx cnc-cim-tls-nginx Ingress ë¦¬ì†ŒìŠ¤ë¥¼ í™•ì¸: kubectl describe ingress -n cnc ğŸš€ ê²°ë¡  Ingress Controllerì˜ External IP í™•ì¸ (kubectl get svc -n ingress-nginx) Ingressì˜ External IPë¥¼ /etc/hostsì— ì¶”ê°€ sudo nano /etc/hosts 192.168.1.100 bd-82898.local ì„¤ì • ì ìš© í›„ í™•ì¸ (ping, nslookup) curlë¡œ HTTPS ìš”ì²­ í…ŒìŠ¤íŠ¸ (curl -k -vvv https://bd-82898.local) ì´ì œ bd-82898.localì´ ì˜¬ë°”ë¥´ê²Œ ì„¤ì •ë˜ì—ˆìœ¼ë¯€ë¡œ, Ingressì™€ ì—°ê²°ì´ ì •ìƒì ìœ¼ë¡œ ì‘ë™í•  ê²ƒì…ë‹ˆë‹¤! ğŸš€ curl -k -vvv https://bd-82898.local ì‹¤íŒ¨ ğŸ” ë¬¸ì œ ë¶„ì„ ë° í•´ê²° ë°©ë²•: curl -k -vvv https://bd-82898.local ì‹¤íŒ¨ (SSL_ERROR_SYSCALL) ğŸš¨ ì£¼ìš” ë¬¸ì œ í™•ì¸ í˜„ì¬ bd-82898.localì´ 127.0.0.1ë¡œ í•´ì„ë¨ (ì˜ëª»ëœ IP)\ncat /etc/hosts 127.0.0.1 localhost bd-82898.local /etc/hosts íŒŒì¼ì—ì„œ bd-82898.localì´ 127.0.0.1ë¡œ ì„¤ì •ë˜ì–´ ìˆìŒ. í•˜ì§€ë§Œ Ingress ControllerëŠ” í´ëŸ¬ìŠ¤í„°ì˜ NodePort ë˜ëŠ” ë…¸ë“œ IPì—ì„œ ì‹¤í–‰ë¨. 127.0.0.1:443ëŠ” í˜„ì¬ Ingress Controllerì™€ ì—°ê²°ë˜ì§€ ì•ŠìŒ. Ingress Controllerê°€ NodePortë¡œ ì‹¤í–‰ë¨\nkubectl get svc -n ingress-nginx NAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE\rmy-nginx-ingress-nginx-controller NodePort 10.96.58.210 80:30105/TCP,443:31813/TCP 69m í˜„ì¬ Ingress Controllerê°€ NodePortë¡œ ì„¤ì •ë¨. ì™¸ë¶€ì—ì„œ 443 í¬íŠ¸ë¡œ ì ‘ê·¼í•˜ë ¤ë©´ í´ëŸ¬ìŠ¤í„° ë…¸ë“œì˜ IP ë° NodePortë¥¼ ì‚¬ìš©í•´ì•¼ í•¨. í˜„ì¬ /etc/hostsì˜ 127.0.0.1ì€ ì˜ëª»ëœ ì£¼ì†Œì´ë©°, ìˆ˜ì •í•´ì•¼ í•¨. hostname -I ê²°ê³¼\nhostname -I 172.31.180.118 172.17.0.1 172.18.0.1 fc00:f853:ccd:e793::1 ì˜¬ë°”ë¥¸ ë…¸ë“œ IPëŠ” 172.31.180.118 (ì´ì „ ì¶œë ¥ì—ì„œ ì²« ë²ˆì§¸ IPê°€ ì¼ë°˜ì ìœ¼ë¡œ ë…¸ë“œ IP) /etc/hostsì—ì„œ bd-82898.localì„ ì´ IPë¡œ ë§¤í•‘í•´ì•¼ í•¨. âœ… í•´ê²° ë°©ë²• 1ï¸âƒ£ /etc/hostsì—ì„œ bd-82898.localì„ ë…¸ë“œ IPë¡œ ë³€ê²½ ğŸ“Œ /etc/hosts ìˆ˜ì •\nsudo nano /etc/hosts ğŸš€ ìˆ˜ì • í›„ ì˜ˆì œ (127.0.0.1ì„ 172.31.180.118ë¡œ ë³€ê²½)\n172.31.180.118 bd-82898.local ğŸ“Œ ë³€ê²½ ì‚¬í•­ ì ìš©\nsudo systemctl restart networking ë˜ëŠ” WSLì„ ë‹¤ì‹œ ì‹œì‘í•˜ë©´ ë³€ê²½ ì‚¬í•­ì´ ë°˜ì˜ë©ë‹ˆë‹¤.\nâœ… ì„¤ì • í™•ì¸\nping bd-82898.local ì •ìƒì ì¸ ê²½ìš°:\nPING bd-82898.local (172.31.180.118) 56(84) bytes of data.\r64 bytes from 172.31.180.118: icmp_seq=1 ttl=64 time=0.053 ms 2ï¸âƒ£ curlë¡œ ì˜¬ë°”ë¥¸ NodePort ì‚¬ìš©í•˜ì—¬ í…ŒìŠ¤íŠ¸ í˜„ì¬ Ingress Controllerê°€ NodePort (31813)ì—ì„œ HTTPSë¥¼ ì œê³µí•˜ë¯€ë¡œ ì˜¬ë°”ë¥¸ í¬íŠ¸ë¡œ ìš”ì²­ì„ ë³´ë‚´ì•¼ í•¨.\nâœ… NodePort í™•ì¸\nkubectl get svc -n ingress-nginx âœ… curl í…ŒìŠ¤íŠ¸ (ì˜¬ë°”ë¥¸ í¬íŠ¸ ì‚¬ìš©)\ncurl -k -vvv https://bd-82898.local:31813 ğŸš€ ì •ìƒì ì¸ ê²½ìš°\n* Connected to bd-82898.local (172.31.180.118) port 31813\r* TLS handshake successful\r...\rHTTP/1.1 200 OK ğŸš¨ ì—¬ì „íˆ SSL_ERROR_SYSCALL ë°œìƒí•˜ë©´?\nIngress ì„¤ì •ì´ ì˜¬ë°”ë¥´ê²Œ ì ìš©ë˜ì—ˆëŠ”ì§€ í™•ì¸: kubectl get ingress -n cnc kubectl describe ingress -n cnc TLS ì„¤ì •ì´ ëˆ„ë½ë˜ì—ˆë‹¤ë©´ Ingress ë¦¬ì†ŒìŠ¤ë¥¼ ì—…ë°ì´íŠ¸í•´ì•¼ í•¨. 3ï¸âƒ£ Ingress Controllerì˜ External IPë¥¼ ì§ì ‘ í™•ì¸ í›„ /etc/hosts ì—…ë°ì´íŠ¸ ğŸ“Œ ì™¸ë¶€ì—ì„œ ì ‘ê·¼ ê°€ëŠ¥í•œ Ingress Controllerì˜ IP í™•ì¸\nkubectl get nodes -o wide âœ… ì˜ˆì œ ì¶œë ¥:\nNAME STATUS ROLES AGE VERSION INTERNAL-IP EXTERNAL-IP\rworker-1 Ready 2d v1.25.2 172.31.180.118 INTERNAL-IP (172.31.180.118)ë¥¼ /etc/hostsì— ì„¤ì •í•´ì•¼ í•¨. ğŸ“Œ Ingress ìƒíƒœ í™•ì¸\nkubectl describe svc -n ingress-nginx my-nginx-ingress-nginx-controller âœ… ê²°ê³¼ì—ì„œ External IPê°€ ì„¤ì •ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸\nLoadBalancer Ingress: 172.31.180.118 ğŸš€ ì˜¬ë°”ë¥¸ /etc/hosts ì„¤ì •\n172.31.180.118 bd-82898.local ğŸš€ ìµœì¢… í•´ê²° ë°©ë²• ìš”ì•½ Ingress Controllerì˜ ë…¸ë“œ IP í™•ì¸ hostname -I NodePortë¡œ ìš”ì²­ (31813 í™•ì¸) curl -k -vvv https://bd-82898.local:31813 /etc/hostsì—ì„œ 127.0.0.1ì„ Ingress Controller IPë¡œ ë³€ê²½ sudo nano /etc/hosts 172.31.180.118 bd-82898.local ë„¤íŠ¸ì›Œí¬ ë³€ê²½ ì‚¬í•­ ì ìš© sudo systemctl restart networking ğŸš€ ì´ì œ ë‹¤ì‹œ curl -k -vvv https://bd-82898.localì„ ì‹¤í–‰í•˜ì—¬ ì •ìƒ ë™ì‘í•˜ëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”! curl -k -vvv https://bd-82898.local:31813 ì‹¤íŒ¨ (Connection refused) ğŸ” ë¬¸ì œ ë¶„ì„ ë° í•´ê²° ë°©ë²•: curl -k -vvv https://bd-82898.local:31813 ì‹¤íŒ¨ (Connection refused) ğŸš¨ ì£¼ìš” ë¬¸ì œ í™•ì¸ bd-82898.localì´ ì˜¬ë°”ë¥¸ ë…¸ë“œ IP(172.31.180.118)ë¡œ í•´ì„ë¨ âœ…\ncat /etc/hosts 172.31.180.118 bd-82898.local /etc/hosts ì„¤ì •ì€ ì˜¬ë°”ë¥´ê²Œ ì ìš©ë¨. ping bd-82898.local í…ŒìŠ¤íŠ¸ ê²°ê³¼ ì •ìƒì ì¸ ì‘ë‹µì„ ë°›ìŒ. Ingress Controllerê°€ NodePortë¡œ ì‹¤í–‰ ì¤‘ âœ…\nkubectl get svc -n ingress-nginx NAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE\rmy-nginx-ingress-nginx-controller NodePort 10.96.58.210 80:30105/TCP,443:31813/TCP 69m HTTPS(443) â†’ NodePort 31813ì—ì„œ ì œê³µë¨. ì™¸ë¶€ì—ì„œ https://bd-82898.local:31813ë¡œ ì ‘ê·¼í•´ì•¼ í•¨. curl ìš”ì²­ ì‹œ Connection refused ë°œìƒ âŒ\ncurl -k -vvv https://bd-82898.local:31813 * connect to 172.31.180.118 port 31813 failed: Connection refused\r* Failed to connect to bd-82898.local port 31813 ì›ì¸: Ingress Controllerê°€ ì‹¤í–‰ ì¤‘ì´ì§€ë§Œ, ë…¸ë“œì˜ 31813 í¬íŠ¸ê°€ ì‹¤ì œë¡œ ì—´ë ¤ ìˆì§€ ì•ŠìŒ. âœ… í•´ê²° ë°©ë²• 1ï¸âƒ£ Ingress Controllerê°€ ì‹¤ì œë¡œ NodePortì—ì„œ ë¦¬ìŠ¤ë‹í•˜ëŠ”ì§€ í™•ì¸ Ingress Controllerê°€ 31813ì—ì„œ ìˆ˜ì‹ í•˜ê³  ìˆëŠ”ì§€ í™•ì¸í•´ì•¼ í•©ë‹ˆë‹¤.\nğŸ“Œ Ingress Controller Podì˜ ìƒíƒœ í™•ì¸\nkubectl get pods -n ingress-nginx âœ… ì •ìƒì ì¸ ê²½ìš°:\nNAME READY STATUS RESTARTS AGE\rmy-nginx-ingress-nginx-controller-57f6bc457c-k9x7c 1/1 Running 0 69m ğŸš¨ Podì´ CrashLoopBackOff ë˜ëŠ” Error ìƒíƒœë¼ë©´ ë¬¸ì œ ë°œìƒ â†’ ë¡œê·¸ í™•ì¸ í•„ìš”\nkubectl logs -n ingress-nginx my-nginx-ingress-nginx-controller-57f6bc457c-k9x7c ğŸ“Œ NodePort(31813)ê°€ ì‹¤ì œë¡œ ì—´ë ¤ ìˆëŠ”ì§€ í™•ì¸\nnetstat -tulnp | grep 31813 âœ… ì •ìƒì ì¸ ê²½ìš°:\ntcp6 0 0 :::31813 :::* LISTEN 1234/nginx ğŸš¨ ì¶œë ¥ì´ ì—†ìœ¼ë©´ Ingress Controllerê°€ NodePortë¥¼ ë¦¬ìŠ¤ë‹í•˜ì§€ ì•ŠìŒ â†’ ì¬ì‹œì‘ í•„ìš”\nkubectl rollout restart deployment -n ingress-nginx my-nginx-ingress-nginx-controller 2ï¸âƒ£ NodePortê°€ ëª¨ë“  ì¸í„°í˜ì´ìŠ¤ì—ì„œ ì—´ë ¤ ìˆëŠ”ì§€ í™•ì¸ ğŸ“Œ Ingress Serviceê°€ External Trafficì„ ì˜¬ë°”ë¥´ê²Œ ë°›ë„ë¡ ì„¤ì •\nkubectl edit svc -n ingress-nginx my-nginx-ingress-nginx-controller ğŸš€ ì•„ë˜ ì„¤ì •ì„ ì¶”ê°€ ë˜ëŠ” í™•ì¸ (ExternalTrafficPolicy: Cluster ìœ ì§€)\nspec: type: NodePort externalTrafficPolicy: Cluster ğŸ“Œ ë³€ê²½ í›„ Ingress Controller ì¬ì‹œì‘\nkubectl rollout restart deployment -n ingress-nginx my-nginx-ingress-nginx-controller 3ï¸âƒ£ ë°©í™”ë²½ ì„¤ì • í™•ì¸ (WSL2 í™˜ê²½) í˜„ì¬ WSL2ì—ì„œ ì‹¤í–‰ ì¤‘ì´ë¯€ë¡œ WSL2ì˜ ë„¤íŠ¸ì›Œí¬ ì„¤ì •ì´ Ingress Controllerì˜ NodePortë¥¼ ì°¨ë‹¨í•  ìˆ˜ ìˆìŒ.\nğŸ“Œ WSL2ì—ì„œ NodePort í¬íŠ¸ë¥¼ í—ˆìš©\nsudo iptables -A INPUT -p tcp --dport 31813 -j ACCEPT sudo iptables -A OUTPUT -p tcp --sport 31813 -j ACCEPT ğŸ“Œ í˜„ì¬ ì—´ë¦° í¬íŠ¸ í™•ì¸\nsudo netstat -tulnp | grep 31813 âœ… ì •ìƒì ì¸ ê²½ìš°:\ntcp6 0 0 :::31813 :::* LISTEN 1234/nginx ğŸš¨ í¬íŠ¸ê°€ ì—´ë ¤ ìˆì§€ ì•Šìœ¼ë©´ WSL2 ë„¤íŠ¸ì›Œí¬ êµ¬ì„±ì„ ë³€ê²½í•´ì•¼ í•¨.\n4ï¸âƒ£ curlë¡œ ë‹¤ì‹œ í…ŒìŠ¤íŠ¸ ğŸ“Œ ì´ì œ ë‹¤ì‹œ curlì„ ì‹¤í–‰í•˜ì—¬ í™•ì¸\ncurl -k -vvv https://bd-82898.local:31813 âœ… ì •ìƒì ì¸ ê²½ìš°\n* Connected to bd-82898.local (172.31.180.118) port 31813\r* TLS handshake successful\r...\rHTTP/1.1 200 OK ğŸš¨ ì—¬ì „íˆ Connection refusedê°€ ë°œìƒí•˜ë©´?\nNodePortê°€ ì •ìƒì ìœ¼ë¡œ ì—´ë ¤ ìˆëŠ”ì§€ ë‹¤ì‹œ í™•ì¸ (netstat -tulnp | grep 31813) Ingress Controller ë¡œê·¸ í™•ì¸ (kubectl logs -n ingress-nginx ) ğŸš€ ìµœì¢… í•´ê²° ë°©ë²• ìš”ì•½ Ingress Controllerê°€ ì‹¤í–‰ ì¤‘ì¸ì§€ í™•ì¸ kubectl get pods -n ingress-nginx NodePort(31813)ê°€ ì—´ë ¤ ìˆëŠ”ì§€ í™•ì¸ netstat -tulnp | grep 31813 Ingress Controllerê°€ ì˜¬ë°”ë¥´ê²Œ ë°°í¬ë˜ì—ˆëŠ”ì§€ í™•ì¸ í›„ ì¬ì‹œì‘ kubectl rollout restart deployment -n ingress-nginx my-nginx-ingress-nginx-controller WSL2ì—ì„œ NodePort(31813) ë°©í™”ë²½ í—ˆìš© sudo iptables -A INPUT -p tcp --dport 31813 -j ACCEPT curl í…ŒìŠ¤íŠ¸ ì¬ì‹¤í–‰ curl -k -vvv https://bd-82898.local:31813 ğŸš€ ì´ì œ ë‹¤ì‹œ ì‹¤í–‰í•´ë³´ê³  curlì´ ì •ìƒì ìœ¼ë¡œ ì‘ë‹µí•˜ëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”! NodePort (31813) Connection Refused ğŸ” ë¬¸ì œ ë¶„ì„ ë° í•´ê²° ë°©ë²•: NodePort (31813) Connection Refused ğŸš¨ ì£¼ìš” ë¬¸ì œ í™•ì¸ /etc/hosts ì„¤ì • í™•ì¸ (bd-82898.localì´ ì˜¬ë°”ë¥´ê²Œ ì„¤ì •ë¨) âœ…\ncat /etc/hosts 172.31.180.118 bd-82898.local ì´ì œ bd-82898.localì´ 172.31.180.118(í´ëŸ¬ìŠ¤í„° ë…¸ë“œ IP)ë¡œ í•´ì„ë¨) â†’ ì˜¬ë°”ë¥´ê²Œ ì„¤ì •ë¨. Ingress Controllerê°€ ì‹¤í–‰ ì¤‘ âœ…\nkubectl get pods -n ingress-nginx NAME READY STATUS RESTARTS AGE\rmy-nginx-ingress-nginx-controller-c6559fb58-296k6 1/1 Running 0 7m28s Ingress Controllerê°€ Running ìƒíƒœì´ë©° ì¬ì‹œì‘ë„ ìˆ˜í–‰ë¨. NodePort (31813)ì´ ì—´ë ¤ ìˆì§€ ì•ŠìŒ âŒ\nnetstat -tulnp | grep 31813 ê²°ê³¼ ì—†ìŒ â†’ Ingress Controllerê°€ NodePort 31813ì„ ë¦¬ìŠ¤ë‹í•˜ì§€ ì•ŠìŒ. Pod ë¡œê·¸ í™•ì¸ ë¶ˆê°€ (Error from server (NotFound)) âŒ\nkubectl logs -n ingress-nginx my-nginx-ingress-nginx-controller-57f6bc457c-k9x7c Pod ì´ë¦„ì´ ë³€ê²½ë¨ â†’ ì˜¬ë°”ë¥¸ Pod ì´ë¦„ ì‚¬ìš©í•´ì•¼ í•¨. í˜„ì¬ ì‹¤í–‰ ì¤‘ì¸ Pod ë¡œê·¸ë¥¼ í™•ì¸í•´ì•¼ í•¨. âœ… í•´ê²° ë°©ë²• 1ï¸âƒ£ ì˜¬ë°”ë¥¸ Ingress Controller Pod ë¡œê·¸ í™•ì¸ í˜„ì¬ my-nginx-ingress-nginx-controller-57f6bc457c-k9x7cê°€ ì¡´ì¬í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ, ì‹¤ì œ ì‹¤í–‰ ì¤‘ì¸ Pod ë¡œê·¸ë¥¼ í™•ì¸í•´ì•¼ í•¨.\nğŸ“Œ í˜„ì¬ ì‹¤í–‰ ì¤‘ì¸ Ingress Pod í™•ì¸\nkubectl get pods -n ingress-nginx âœ… ì˜ˆì œ ì¶œë ¥:\nNAME READY STATUS RESTARTS AGE\rmy-nginx-ingress-nginx-controller-c6559fb58-296k6 1/1 Running 0 10m ğŸš€ ì‹¤ì œ ì‹¤í–‰ ì¤‘ì¸ Podì˜ ë¡œê·¸ í™•ì¸\nkubectl logs -n ingress-nginx my-nginx-ingress-nginx-controller-c6559fb58-296k6 ë¡œê·¸ì— listening on port 31813 ë˜ëŠ” TLS ì„¤ì • ê´€ë ¨ ì˜¤ë¥˜ê°€ ìˆëŠ”ì§€ í™•ì¸. 2ï¸âƒ£ NodePort (31813)ì´ ì—´ë ¤ ìˆëŠ”ì§€ í™•ì¸ ë° Ingress ì„¤ì • í™•ì¸ ğŸ“Œ Ingress Controllerê°€ NodePortì—ì„œ ì„œë¹„ìŠ¤ë˜ê³  ìˆëŠ”ì§€ í™•ì¸\nkubectl get svc -n ingress-nginx âœ… ì •ìƒì ì¸ ê²½ìš°:\nNAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE\rmy-nginx-ingress-nginx-controller NodePort 10.96.58.210 80:30105/TCP,443:31813/TCP 69m NodePort 31813ì´ í• ë‹¹ë˜ì–´ ìˆì–´ì•¼ í•¨. ë§Œì•½ NodePortê°€ ì„¤ì •ë˜ì§€ ì•Šì•˜ë‹¤ë©´, Ingressë¥¼ ë‹¤ì‹œ ì„¤ì •í•´ì•¼ í•¨. ğŸš€ NodePort í¬íŠ¸ê°€ ì‹¤ì œë¡œ ë¦¬ìŠ¤ë‹ ì¤‘ì¸ì§€ í™•ì¸\nnetstat -tulnp | grep 31813 âœ… ì •ìƒì ì¸ ê²½ìš°:\ntcp6 0 0 :::31813 :::* LISTEN 1234/nginx ğŸš¨ ì—¬ì „íˆ ê²°ê³¼ê°€ ì—†ìœ¼ë©´ Ingress Controllerë¥¼ ë‹¤ì‹œ ë°°í¬í•´ì•¼ í•¨.\n3ï¸âƒ£ Ingress Controller ì„¤ì • ìˆ˜ì • (í•„ìš”í•œ ê²½ìš°) ğŸ“Œ NodePort ì„¤ì •ì„ ê°•ì œ ì ìš©\nkubectl edit svc -n ingress-nginx my-nginx-ingress-nginx-controller ğŸš€ ì•„ë˜ ì„¤ì • í™•ì¸ ë° ì¶”ê°€\nspec: type: NodePort externalTrafficPolicy: Cluster ğŸ“Œ ë³€ê²½ í›„ Ingress Controller ì¬ì‹œì‘\nkubectl rollout restart deployment -n ingress-nginx my-nginx-ingress-nginx-controller 4ï¸âƒ£ WSL2ì—ì„œ NodePort (31813) í¬íŠ¸ê°€ ì°¨ë‹¨ë˜ì§€ ì•Šì•˜ëŠ”ì§€ í™•ì¸ í˜„ì¬ WSL2ì—ì„œ ì‹¤í–‰ ì¤‘ì´ë¯€ë¡œ WSL2ì˜ ë„¤íŠ¸ì›Œí¬ ì„¤ì •ì´ NodePortë¥¼ ì°¨ë‹¨í•  ê°€ëŠ¥ì„±ì´ ìˆìŒ.\nğŸ“Œ WSL2ì—ì„œ NodePort (31813) ë°©í™”ë²½ í—ˆìš©\nsudo iptables -A INPUT -p tcp --dport 31813 -j ACCEPT sudo iptables -A OUTPUT -p tcp --sport 31813 -j ACCEPT ğŸ“Œ í˜„ì¬ ì—´ë¦° í¬íŠ¸ í™•ì¸\nsudo netstat -tulnp | grep 31813 âœ… ì •ìƒì ì¸ ê²½ìš°:\ntcp6 0 0 :::31813 :::* LISTEN 1234/nginx ğŸš¨ í¬íŠ¸ê°€ ì—´ë ¤ ìˆì§€ ì•Šìœ¼ë©´ WSL2 ë„¤íŠ¸ì›Œí¬ êµ¬ì„±ì„ ë³€ê²½í•´ì•¼ í•¨.\n5ï¸âƒ£ curlë¡œ ë‹¤ì‹œ í…ŒìŠ¤íŠ¸ ğŸ“Œ ì´ì œ ë‹¤ì‹œ curlì„ ì‹¤í–‰í•˜ì—¬ í™•ì¸\ncurl -k -vvv https://bd-82898.local:31813 âœ… ì •ìƒì ì¸ ê²½ìš°\n* Connected to bd-82898.local (172.31.180.118) port 31813\r* TLS handshake successful\r...\rHTTP/1.1 200 OK ğŸš¨ ì—¬ì „íˆ Connection refusedê°€ ë°œìƒí•˜ë©´?\nNodePortê°€ ì •ìƒì ìœ¼ë¡œ ì—´ë ¤ ìˆëŠ”ì§€ ë‹¤ì‹œ í™•ì¸ (netstat -tulnp | grep 31813) Ingress Controller ë¡œê·¸ í™•ì¸ (kubectl logs -n ingress-nginx ) ğŸš€ ìµœì¢… í•´ê²° ë°©ë²• ìš”ì•½ Ingress Controllerê°€ ì‹¤í–‰ ì¤‘ì¸ì§€ í™•ì¸ kubectl get pods -n ingress-nginx ì‹¤ì œ ì‹¤í–‰ ì¤‘ì¸ Pod ë¡œê·¸ í™•ì¸ kubectl logs -n ingress-nginx my-nginx-ingress-nginx-controller-c6559fb58-296k6 NodePort (31813)ê°€ ì—´ë ¤ ìˆëŠ”ì§€ í™•ì¸ netstat -tulnp | grep 31813 Ingress Controllerê°€ ì˜¬ë°”ë¥´ê²Œ ë°°í¬ë˜ì—ˆëŠ”ì§€ í™•ì¸ í›„ ì¬ì‹œì‘ kubectl rollout restart deployment -n ingress-nginx my-nginx-ingress-nginx-controller WSL2ì—ì„œ NodePort (31813) ë°©í™”ë²½ í—ˆìš© sudo iptables -A INPUT -p tcp --dport 31813 -j ACCEPT curl í…ŒìŠ¤íŠ¸ ì¬ì‹¤í–‰ curl -k -vvv https://bd-82898.local:31813 ğŸš€ ì´ì œ ë‹¤ì‹œ ì‹¤í–‰í•´ë³´ê³  curlì´ ì •ìƒì ìœ¼ë¡œ ì‘ë‹µí•˜ëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”!\nNodePort (31813) Connection Refused ğŸ” ë¬¸ì œ ë¶„ì„ ë° í•´ê²° ë°©ë²•: NodePort (31813) Connection Refused ğŸš¨ ì£¼ìš” ë¬¸ì œ ìš”ì•½ Ingress Controller Podì´ ì •ìƒ ì‹¤í–‰ë¨ (Running) âœ…\nkubectl get pods -n ingress-nginx NAME READY STATUS RESTARTS AGE\rmy-nginx-ingress-nginx-controller-6b7b86d57d-2trlq 1/1 Running 0 80s Ingress Controllerê°€ ì •ìƒì ìœ¼ë¡œ ì‹¤í–‰ ì¤‘ì„. NodePort (31813)ì—ì„œ ì„œë¹„ìŠ¤ë˜ì§€ ì•ŠìŒ (Connection refused) âŒ\ncurl -k -vvv https://bd-82898.local:31813 * connect to 172.31.180.118 port 31813 failed: Connection refused\r* Failed to connect to bd-82898.local port 31813 Ingress Controllerê°€ NodePortë¥¼ ë¦¬ìŠ¤ë‹í•˜ì§€ ì•Šê±°ë‚˜, WSL2ì—ì„œ ì°¨ë‹¨ë¨. netstat -tulnp | grep 31813 ì‹¤í–‰ ì‹œ ì•„ë¬´ëŸ° ê²°ê³¼ê°€ ì—†ìŒ âŒ\nnetstat -tulnp | grep 31813 Ingress Controllerê°€ 31813 í¬íŠ¸ë¥¼ ì—´ì§€ ì•ŠìŒ. Kubernetesì˜ NodePort ì„¤ì • ë¬¸ì œ ê°€ëŠ¥ì„± ìˆìŒ. âœ… í•´ê²° ë°©ë²• 1ï¸âƒ£ NodePort (31813)ê°€ ì˜¬ë°”ë¥´ê²Œ ì„¤ì •ë˜ì—ˆëŠ”ì§€ í™•ì¸ ğŸ“Œ Ingress Controllerì˜ ì„œë¹„ìŠ¤ ì„¤ì •ì„ í™•ì¸\nkubectl get svc -n ingress-nginx âœ… ì˜ˆìƒë˜ëŠ” ì •ìƒì ì¸ ê²½ìš°:\nNAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE\rmy-nginx-ingress-nginx-controller NodePort 10.96.58.210 80:30105/TCP,443:31813/TCP 69m ğŸš¨ ë§Œì•½ 443:31813/TCPê°€ ì—†ê±°ë‚˜ TYPE=ClusterIPì´ë©´, NodePort ì„¤ì •ì´ ì˜ëª»ë¨.\nì´ë¥¼ ìˆ˜ì •í•´ì•¼ í•¨.\n2ï¸âƒ£ NodePort (31813)ê°€ Ingress Controller Podì—ì„œ ë¦¬ìŠ¤ë‹ë˜ëŠ”ì§€ í™•ì¸ ğŸ“Œ Ingress Controllerì˜ ì‹¤ì œ Podì—ì„œ 31813 í¬íŠ¸ë¥¼ ë¦¬ìŠ¤ë‹í•˜ê³  ìˆëŠ”ì§€ í™•ì¸\nkubectl exec -it -n ingress-nginx my-nginx-ingress-nginx-controller-6b7b86d57d-2trlq -- netstat -tulnp | grep 31813 âœ… ì •ìƒì ì¸ ê²½ìš° (Pod ë‚´ë¶€ì—ì„œ 31813 í¬íŠ¸ê°€ ì—´ë ¤ ìˆìŒ):\ntcp6 0 0 :::31813 :::* LISTEN 1234/nginx ğŸš¨ ë§Œì•½ í¬íŠ¸ê°€ ì—´ë ¤ ìˆì§€ ì•Šë‹¤ë©´?\nIngress ì„¤ì •ì´ ì˜ëª»ë˜ì–´ ìˆì„ ê°€ëŠ¥ì„±ì´ í¼. ì•„ë˜ Ingress ì„¤ì •ì„ ê°•ì œ ìˆ˜ì •í•´ì•¼ í•¨. 3ï¸âƒ£ Ingress Controller ì„œë¹„ìŠ¤ ì„¤ì •ì„ ê°•ì œ ìˆ˜ì • ğŸ“Œ Ingress Controllerì˜ NodePortê°€ ì •í™•í•˜ê²Œ ì„¤ì •ë˜ì—ˆëŠ”ì§€ í™•ì¸\nkubectl edit svc -n ingress-nginx my-nginx-ingress-nginx-controller ğŸš€ ì•„ë˜ ì„¤ì • í™•ì¸ ë° ì¶”ê°€ (externalTrafficPolicy: Cluster ìœ ì§€)\nspec: type: NodePort externalTrafficPolicy: Cluster ports: - name: https port: 443 targetPort: https nodePort: 31813 # \u003c- ì˜¬ë°”ë¥´ê²Œ ì„¤ì •ë˜ì–´ì•¼ í•¨ ğŸ“Œ ë³€ê²½ í›„ Ingress Controller ì¬ì‹œì‘\nkubectl rollout restart deployment -n ingress-nginx my-nginx-ingress-nginx-controller 4ï¸âƒ£ WSL2ì—ì„œ NodePort (31813) í¬íŠ¸ê°€ ì°¨ë‹¨ë˜ì§€ ì•Šì•˜ëŠ”ì§€ í™•ì¸ ğŸ“Œ WSL2ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ì™¸ë¶€ íŠ¸ë˜í”½ì„ ì°¨ë‹¨í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ, ìˆ˜ë™ìœ¼ë¡œ NodePortë¥¼ í—ˆìš©í•´ì•¼ í•¨.\nsudo iptables -A INPUT -p tcp --dport 31813 -j ACCEPT sudo iptables -A OUTPUT -p tcp --sport 31813 -j ACCEPT ğŸ“Œ í˜„ì¬ ì—´ë¦° í¬íŠ¸ í™•ì¸\nsudo netstat -tulnp | grep 31813 âœ… ì •ìƒì ì¸ ê²½ìš°:\ntcp6 0 0 :::31813 :::* LISTEN 1234/nginx ğŸš¨ í¬íŠ¸ê°€ ì—´ë ¤ ìˆì§€ ì•Šìœ¼ë©´ WSL2 ë„¤íŠ¸ì›Œí¬ êµ¬ì„±ì„ ë³€ê²½í•´ì•¼ í•¨.\n5ï¸âƒ£ curlë¡œ ë‹¤ì‹œ í…ŒìŠ¤íŠ¸ ğŸ“Œ ì´ì œ ë‹¤ì‹œ curlì„ ì‹¤í–‰í•˜ì—¬ í™•ì¸\ncurl -k -vvv https://bd-82898.local:31813 âœ… ì •ìƒì ì¸ ê²½ìš°\n* Connected to bd-82898.local (172.31.180.118) port 31813\r* TLS handshake successful\r...\rHTTP/1.1 200 OK ğŸš¨ ì—¬ì „íˆ Connection refusedê°€ ë°œìƒí•˜ë©´?\nNodePortê°€ ì •ìƒì ìœ¼ë¡œ ì—´ë ¤ ìˆëŠ”ì§€ ë‹¤ì‹œ í™•ì¸ (netstat -tulnp | grep 31813) Ingress Controller ë¡œê·¸ í™•ì¸ (kubectl logs -n ingress-nginx ) ğŸš€ ìµœì¢… í•´ê²° ë°©ë²• ìš”ì•½ Ingress Controllerê°€ ì‹¤í–‰ ì¤‘ì¸ì§€ í™•ì¸ kubectl get pods -n ingress-nginx Ingress Controllerì˜ NodePort ì„¤ì • í™•ì¸ kubectl get svc -n ingress-nginx Pod ë‚´ë¶€ì—ì„œ NodePort (31813)ê°€ ë¦¬ìŠ¤ë‹ë˜ëŠ”ì§€ í™•ì¸ kubectl exec -it -n ingress-nginx my-nginx-ingress-nginx-controller-6b7b86d57d-2trlq -- netstat -tulnp | grep 31813 Ingress Controller ì„œë¹„ìŠ¤ ì„¤ì •ì„ ê°•ì œ ìˆ˜ì • kubectl edit svc -n ingress-nginx my-nginx-ingress-nginx-controller spec: type: NodePort externalTrafficPolicy: Cluster Ingress Controller ì¬ì‹œì‘ kubectl rollout restart deployment -n ingress-nginx my-nginx-ingress-nginx-controller WSL2ì—ì„œ NodePort (31813) ë°©í™”ë²½ í—ˆìš© sudo iptables -A INPUT -p tcp --dport 31813 -j ACCEPT curl í…ŒìŠ¤íŠ¸ ì¬ì‹¤í–‰ curl -k -vvv https://bd-82898.local:31813 ğŸš€ ì´ì œ ë‹¤ì‹œ ì‹¤í–‰í•´ë³´ê³  curlì´ ì •ìƒì ìœ¼ë¡œ ì‘ë‹µí•˜ëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”!\n","wordCount":"3241","inLanguage":"ko","datePublished":"0001-01-01T00:00:00Z","dateModified":"0001-01-01T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://jongyongpark.github.io/posts/technical-support/cnc/cnc-wsl/"},"publisher":{"@type":"Organization","name":"RyanLabs","logo":{"@type":"ImageObject","url":"https://jongyongpark.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://jongyongpark.github.io/ accesskey=h title="RyanLabs (Alt + H)">RyanLabs</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://jongyongpark.github.io/search/ title=ê²€ìƒ‰><span>ê²€ìƒ‰</span></a></li><li><a href=https://jongyongpark.github.io/categories/ title=ì¹´í…Œê³ ë¦¬><span>ì¹´í…Œê³ ë¦¬</span></a></li><li><a href=https://jongyongpark.github.io/tags/ title=íƒœê·¸><span>íƒœê·¸</span></a></li><li><a href=https://jongyongpark.github.io/archives/ title=ì—°ë„><span>ì—°ë„</span></a></li><li><a href=https://jongyongpark.github.io/lectures/ title=ê°•ì˜><span>ê°•ì˜</span></a></li><li><a href=https://jongyongpark.github.io/about/ title=ì–´ë°”ì›ƒë¯¸><span>ì–´ë°”ì›ƒë¯¸</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent"></h1><div class=post-meta></div></header><div class=post-content><h1 id=curl--k--vvv-httpsbd-82898local-ì‹¤íŒ¨>curl -k -vvv <a href=https://bd-82898.local>https://bd-82898.local</a> ì‹¤íŒ¨<a hidden class=anchor aria-hidden=true href=#curl--k--vvv-httpsbd-82898local-ì‹¤íŒ¨>#</a></h1><h3 id=-ë¬¸ì œ-ë¶„ì„-curl--k--vvv-httpsbd-82898local-ì‹¤íŒ¨-ssl_error_syscall><strong>ğŸ” ë¬¸ì œ ë¶„ì„: <code>curl -k -vvv https://bd-82898.local</code> ì‹¤íŒ¨ (SSL_ERROR_SYSCALL)</strong><a hidden class=anchor aria-hidden=true href=#-ë¬¸ì œ-ë¶„ì„-curl--k--vvv-httpsbd-82898local-ì‹¤íŒ¨-ssl_error_syscall>#</a></h3><h4 id=-ë¬¸ì œ-ìš”ì•½><strong>ğŸš¨ ë¬¸ì œ ìš”ì•½</strong><a hidden class=anchor aria-hidden=true href=#-ë¬¸ì œ-ìš”ì•½>#</a></h4><ol><li><code>curl -k -vvv https://bd-82898.local</code> ì‹¤í–‰ ì‹œ <strong>TLS í•¸ë“œì…°ì´í¬ ì‹¤íŒ¨</strong> (<code>SSL_ERROR_SYSCALL</code>).</li><li><code>curl</code> ë¡œê·¸:<pre tabindex=0><code>* OpenSSL SSL_connect: SSL_ERROR_SYSCALL in connection to bd-82898.local:443
</code></pre></li><li><code>bd-82898.local</code>ì˜ IP ì£¼ì†ŒëŠ” <code>127.0.0.1</code>ë¡œ í•´ì„ë¨ (ë¡œì»¬ í˜¸ìŠ¤íŠ¸ì—ì„œ ì‹¤í–‰ ì¤‘).</li><li><code>kubectl</code> ë¡œê·¸ì—ì„œ <strong>Ingress Nginx ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ì •ìƒì ìœ¼ë¡œ ì‹¤í–‰ë˜ì§€ ì•ŠìŒ</strong> (<code>Deployment is not ready: 0 out of 1 expected pods are ready</code>).</li></ol><hr><h2 id=-ì›ì¸-ë¶„ì„><strong>ğŸ” ì›ì¸ ë¶„ì„</strong><a hidden class=anchor aria-hidden=true href=#-ì›ì¸-ë¶„ì„>#</a></h2><h3 id=1-ingress-nginxê°€-ì •ìƒì ìœ¼ë¡œ-ì‹¤í–‰ë˜ì§€-ì•ŠìŒ><strong>1ï¸âƒ£ Ingress Nginxê°€ ì •ìƒì ìœ¼ë¡œ ì‹¤í–‰ë˜ì§€ ì•ŠìŒ</strong><a hidden class=anchor aria-hidden=true href=#1-ingress-nginxê°€-ì •ìƒì ìœ¼ë¡œ-ì‹¤í–‰ë˜ì§€-ì•ŠìŒ>#</a></h3><ul><li>ë¡œê·¸ì—ì„œ Ingress Nginx ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ì •ìƒì ìœ¼ë¡œ ê¸°ë™ë˜ì§€ ì•Šì•˜ë‹¤ëŠ” ë©”ì‹œì§€ê°€ ë°˜ë³µë¨:<pre tabindex=0><code>Deployment is not ready: ingress-nginx/my-nginx-ingress-nginx-controller. 0 out of 1 expected pods are ready
</code></pre></li><li><code>kubectl get pods -n ingress-nginx</code> ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ì—¬ Ingress Controller Pod ìƒíƒœë¥¼ í™•ì¸í•´ì•¼ í•¨.</li></ul><p>âœ… <strong>í•´ê²° ë°©ë²•</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl get pods -n ingress-nginx
</span></span></code></pre></div><ul><li>ë§Œì•½ <strong>CrashLoopBackOff</strong> ë˜ëŠ” <strong>Error</strong> ìƒíƒœë¼ë©´ ë¡œê·¸ í™•ì¸:<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl logs -n ingress-nginx &lt;nginx-controller-pod&gt;
</span></span></code></pre></div></li></ul><hr><h3 id=2-https-í¬íŠ¸443ê°€-ì œëŒ€ë¡œ-ë¦¬ìŠ¤ë‹ë˜ì§€-ì•ŠìŒ><strong>2ï¸âƒ£ HTTPS í¬íŠ¸(443)ê°€ ì œëŒ€ë¡œ ë¦¬ìŠ¤ë‹ë˜ì§€ ì•ŠìŒ</strong><a hidden class=anchor aria-hidden=true href=#2-https-í¬íŠ¸443ê°€-ì œëŒ€ë¡œ-ë¦¬ìŠ¤ë‹ë˜ì§€-ì•ŠìŒ>#</a></h3><ul><li><code>curl</code>ì´ <code>127.0.0.1:443</code>ì— ì—°ê²°í•˜ë ¤ í•˜ì§€ë§Œ TLS í•¸ë“œì…°ì´í¬ê°€ ì‹¤íŒ¨í•¨.</li><li><code>netstat</code> ë˜ëŠ” <code>ss</code> ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•˜ì—¬ í¬íŠ¸ 443ì´ ì—´ë ¤ ìˆëŠ”ì§€ í™•ì¸í•´ì•¼ í•¨.</li></ul><p>âœ… <strong>í•´ê²° ë°©ë²•</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>netstat -tulnp | grep :443
</span></span></code></pre></div><ul><li>ì •ìƒì ì¸ ê²½ìš°:<pre tabindex=0><code>tcp    LISTEN  0  128  0.0.0.0:443  0.0.0.0:*  nginx
</code></pre></li><li>ë§Œì•½ ì•„ë¬´ê²ƒë„ ì¶œë ¥ë˜ì§€ ì•ŠëŠ”ë‹¤ë©´ Ingress Nginxê°€ í¬íŠ¸ë¥¼ ì œëŒ€ë¡œ ë¦¬ìŠ¤ë‹í•˜ì§€ ì•ŠëŠ” ê²ƒ.</li></ul><hr><h3 id=3-tls-ì¸ì¦ì„œ-ë¬¸ì œ><strong>3ï¸âƒ£ TLS ì¸ì¦ì„œ ë¬¸ì œ</strong><a hidden class=anchor aria-hidden=true href=#3-tls-ì¸ì¦ì„œ-ë¬¸ì œ>#</a></h3><ul><li><code>curl -k</code> ì˜µì…˜ì„ ì‚¬ìš©í•´ë„ TLS ì˜¤ë¥˜ê°€ ë°œìƒí•¨ â†’ ì¸ì¦ì„œê°€ ì œëŒ€ë¡œ êµ¬ì„±ë˜ì§€ ì•Šì•˜ì„ ê°€ëŠ¥ì„±ì´ ìˆìŒ.</li><li><code>cnc-deploy</code> ë¡œê·¸ë¥¼ ë³´ë©´ <code>CNC_CIM_TLS_NGINX_SECRET_NAME="cnc-cim-tls-nginx"</code> í™˜ê²½ ë³€ìˆ˜ê°€ ì„¤ì •ë˜ì–´ ìˆìŒ.</li></ul><p>âœ… <strong>í•´ê²° ë°©ë²•</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl get secret -n ingress-nginx cnc-cim-tls-nginx -o yaml
</span></span></code></pre></div><ul><li>ë§Œì•½ ì¡´ì¬í•˜ì§€ ì•ŠëŠ”ë‹¤ë©´:<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>echo <span style=color:#e6db74>&#34;TLS Secretì´ ì¡´ì¬í•˜ì§€ ì•ŠìŒ. ìƒˆë¡œ ìƒì„± í•„ìš”&#34;</span>
</span></span></code></pre></div></li><li><strong>TLS ì¸ì¦ì„œë¥¼ ë‹¤ì‹œ ìƒì„±í•˜ê³  ì ìš©í•´ì•¼ í•¨</strong>.</li></ul><hr><h3 id=-í•´ê²°-ë°©ë²•-ìš”ì•½><strong>ğŸš€ í•´ê²° ë°©ë²• ìš”ì•½</strong><a hidden class=anchor aria-hidden=true href=#-í•´ê²°-ë°©ë²•-ìš”ì•½>#</a></h3><p>âœ… <strong>1. Ingress Nginx Pod ìƒíƒœ í™•ì¸</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl get pods -n ingress-nginx
</span></span><span style=display:flex><span>kubectl logs -n ingress-nginx &lt;nginx-controller-pod&gt;
</span></span></code></pre></div><ul><li><strong>ì˜¤ë¥˜ ë¡œê·¸ ë¶„ì„ í›„ ì¡°ì¹˜</strong>.</li></ul><p>âœ… <strong>2. 443 í¬íŠ¸ í™•ì¸</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>netstat -tulnp | grep :443
</span></span></code></pre></div><ul><li><strong>í¬íŠ¸ê°€ ë¦¬ìŠ¤ë‹ ì¤‘ì¸ì§€ í™•ì¸</strong>.</li></ul><p>âœ… <strong>3. TLS ì¸ì¦ì„œ í™•ì¸ ë° ì¬ì„¤ì •</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl get secret -n ingress-nginx cnc-cim-tls-nginx -o yaml
</span></span></code></pre></div><ul><li><strong>ì¡´ì¬í•˜ì§€ ì•Šìœ¼ë©´ ìƒˆë¡œìš´ ì¸ì¦ì„œ ìƒì„± í›„ ì ìš©</strong>.</li></ul><h2 id=ì´ì œ-ìœ„-ë‹¨ê³„ë¥¼-ì‹¤í–‰í•˜ê³ -ê²°ê³¼ë¥¼-í™•ì¸í•œ-í›„-ì¶”ê°€ì ì¸-ì¡°ì¹˜ë¥¼-ì·¨í• -ìˆ˜-ìˆìŠµë‹ˆë‹¤->ì´ì œ ìœ„ ë‹¨ê³„ë¥¼ ì‹¤í–‰í•˜ê³  ê²°ê³¼ë¥¼ í™•ì¸í•œ í›„ ì¶”ê°€ì ì¸ ì¡°ì¹˜ë¥¼ ì·¨í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ğŸš€<a hidden class=anchor aria-hidden=true href=#ì´ì œ-ìœ„-ë‹¨ê³„ë¥¼-ì‹¤í–‰í•˜ê³ -ê²°ê³¼ë¥¼-í™•ì¸í•œ-í›„-ì¶”ê°€ì ì¸-ì¡°ì¹˜ë¥¼-ì·¨í• -ìˆ˜-ìˆìŠµë‹ˆë‹¤->#</a></h2><h1 id=curl--k--vvv-httpsbd-82898local-ì‹¤íŒ¨-1>curl -k -vvv <a href=https://bd-82898.local>https://bd-82898.local</a> ì‹¤íŒ¨<a hidden class=anchor aria-hidden=true href=#curl--k--vvv-httpsbd-82898local-ì‹¤íŒ¨-1>#</a></h1><h3 id=-ë¬¸ì œ-ë¶„ì„--í•´ê²°-ë°©ë²•-curl--k--vvv-httpsbd-82898local-ì‹¤íŒ¨-ssl_error_syscall><strong>ğŸ” ë¬¸ì œ ë¶„ì„ & í•´ê²° ë°©ë²•: <code>curl -k -vvv https://bd-82898.local</code> ì‹¤íŒ¨ (SSL_ERROR_SYSCALL)</strong><a hidden class=anchor aria-hidden=true href=#-ë¬¸ì œ-ë¶„ì„--í•´ê²°-ë°©ë²•-curl--k--vvv-httpsbd-82898local-ì‹¤íŒ¨-ssl_error_syscall>#</a></h3><h3 id=-ë¬¸ì œ-ìš”ì•½-1><strong>ğŸš¨ ë¬¸ì œ ìš”ì•½</strong><a hidden class=anchor aria-hidden=true href=#-ë¬¸ì œ-ìš”ì•½-1>#</a></h3><ol><li><p><strong>Ingress Controllerê°€ ì •ìƒì ìœ¼ë¡œ ì‹¤í–‰ ì¤‘ (<code>1/1 Running</code>)</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl get pods -n ingress-nginx
</span></span></code></pre></div><pre tabindex=0><code>NAME                                                 READY   STATUS    RESTARTS   AGE
my-nginx-ingress-nginx-controller-57f6bc457c-k9x7c   1/1     Running   0          59m
</code></pre></li><li><p><strong>TLS ì¸ì¦ì„œ <code>cnc-cim-tls-nginx</code>ê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŒ</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl get secret -n ingress-nginx cnc-cim-tls-nginx -o yaml
</span></span></code></pre></div><pre tabindex=0><code>Error from server (NotFound): secrets &#34;cnc-cim-tls-nginx&#34; not found
</code></pre></li><li><p><strong>Ingress Controller ë¡œê·¸ì—ì„œ SSL ì¸ì¦ì„œ ë¡œë”© ì‹¤íŒ¨</strong></p><pre tabindex=0><code>W0312 09:56:08.059301 10 controller.go:1306] Error getting SSL certificate &#34;cnc/cnc-cim-tls-nginx&#34;: local SSL certificate cnc/cnc-cim-tls-nginx was not found. Using default certificate
</code></pre></li><li><p><strong>ì„œë¹„ìŠ¤ Endpoint ì—†ìŒ</strong></p><pre tabindex=0><code>W0312 09:56:08.059231 10 controller.go:1083] Service &#34;cnc/cnc-minio&#34; does not have any active Endpoint.
W0312 09:56:08.059231 10 controller.go:1083] Service &#34;cnc/cnc-cim-cnc-storage-proxy&#34; does not have any active Endpoint.
</code></pre></li></ol><hr><h2 id=-ë¬¸ì œì˜-ì›ì¸><strong>ğŸ” ë¬¸ì œì˜ ì›ì¸</strong><a hidden class=anchor aria-hidden=true href=#-ë¬¸ì œì˜-ì›ì¸>#</a></h2><ol><li><p><strong>TLS ì¸ì¦ì„œê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŒ (<code>cnc-cim-tls-nginx</code> secret ëˆ„ë½)</strong></p><ul><li>IngressëŠ” <code>cnc-cim-tls-nginx</code>ë¥¼ ì°¸ì¡°í•˜ì§€ë§Œ, í•´ë‹¹ Secretì´ ìƒì„±ë˜ì§€ ì•ŠìŒ.</li><li>í˜„ì¬ ê¸°ë³¸ <code>fake-certificate.pem</code>ì„ ì‚¬ìš© ì¤‘.</li></ul></li><li><p><strong>Ingressì— ì—°ê²°ëœ ì„œë¹„ìŠ¤(<code>cnc-minio</code>, <code>cnc-cim-cnc-storage-proxy</code>, <code>cnc-cim-cim</code>)ê°€ í™œì„±í™”ë˜ì§€ ì•ŠìŒ</strong></p><ul><li>Ingress ControllerëŠ” ëŒ€ìƒ ì„œë¹„ìŠ¤ë¡œ ìš”ì²­ì„ ì „ë‹¬í•´ì•¼ í•˜ì§€ë§Œ, ì„œë¹„ìŠ¤ Endpointê°€ í™œì„±í™”ë˜ì§€ ì•ŠìŒ.</li><li>IngressëŠ” ì •ìƒ ì‘ë™í•˜ì§€ë§Œ, ë°±ì—”ë“œ ì„œë¹„ìŠ¤ê°€ ì¤€ë¹„ë˜ì§€ ì•ŠìŒ.</li></ul></li><li><p><strong>Ingressê°€ <code>127.0.0.1</code>ì—ì„œ ë¦¬ìŠ¤ë‹í•˜ëŠ”ì§€ í™•ì¸ í•„ìš”</strong></p><ul><li><code>curl</code> ëª…ë ¹ì–´ê°€ <code>127.0.0.1:443</code>ë¡œ ìš”ì²­ì„ ë³´ë‚´ê³  ìˆìŒ.</li><li><code>kubectl get svc -n ingress-nginx</code>ë¡œ <code>ingress-nginx</code> ì„œë¹„ìŠ¤ê°€ ì–´ë–¤ IPì—ì„œ ë¦¬ìŠ¤ë‹í•˜ëŠ”ì§€ í™•ì¸ í•„ìš”.</li></ul></li></ol><hr><h2 id=-í•´ê²°-ë°©ë²•><strong>ğŸš€ í•´ê²° ë°©ë²•</strong><a hidden class=anchor aria-hidden=true href=#-í•´ê²°-ë°©ë²•>#</a></h2><h3 id=1-tls-ì¸ì¦ì„œ-cnc-cim-tls-nginx-ìƒì„±-ë°-ì ìš©><strong>1ï¸âƒ£ TLS ì¸ì¦ì„œ (<code>cnc-cim-tls-nginx</code>) ìƒì„± ë° ì ìš©</strong><a hidden class=anchor aria-hidden=true href=#1-tls-ì¸ì¦ì„œ-cnc-cim-tls-nginx-ìƒì„±-ë°-ì ìš©>#</a></h3><p>í˜„ì¬ <code>cnc-cim-tls-nginx</code> Secretì´ ì—†ê¸° ë•Œë¬¸ì— ìƒˆë¡œ ìƒì„±í•´ì•¼ í•©ë‹ˆë‹¤.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl create secret tls cnc-cim-tls-nginx -n ingress-nginx <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --cert<span style=color:#f92672>=</span>/path/to/your/cert.pem <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --key<span style=color:#f92672>=</span>/path/to/your/key.pem
</span></span></code></pre></div><p>âœ… <strong>í™•ì¸ ë°©ë²•</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl get secret -n ingress-nginx cnc-cim-tls-nginx
</span></span></code></pre></div><ul><li>Secretì´ ì •ìƒì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆëŠ”ì§€ í™•ì¸ í›„, Ingress Controllerë¥¼ ë‹¤ì‹œ ì‹œì‘í•©ë‹ˆë‹¤.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl rollout restart deployment -n ingress-nginx my-nginx-ingress-nginx-controller
</span></span></code></pre></div><hr><h3 id=2-ingress-controllerê°€-443-í¬íŠ¸ë¥¼-ë¦¬ìŠ¤ë‹í•˜ëŠ”ì§€-í™•ì¸><strong>2ï¸âƒ£ Ingress Controllerê°€ 443 í¬íŠ¸ë¥¼ ë¦¬ìŠ¤ë‹í•˜ëŠ”ì§€ í™•ì¸</strong><a hidden class=anchor aria-hidden=true href=#2-ingress-controllerê°€-443-í¬íŠ¸ë¥¼-ë¦¬ìŠ¤ë‹í•˜ëŠ”ì§€-í™•ì¸>#</a></h3><p>í˜„ì¬ <code>curl</code>ì´ <code>127.0.0.1:443</code>ë¡œ ìš”ì²­ì„ ë³´ë‚´ê³  ìˆìœ¼ë¯€ë¡œ, <code>ingress-nginx</code> ì„œë¹„ìŠ¤ê°€ ì‹¤ì œë¡œ 443ì—ì„œ ë¦¬ìŠ¤ë‹í•˜ëŠ”ì§€ í™•ì¸í•´ì•¼ í•©ë‹ˆë‹¤.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl get svc -n ingress-nginx
</span></span></code></pre></div><p>âœ… <strong>ì˜ˆì œ ì¶œë ¥</strong></p><pre tabindex=0><code>NAME                                 TYPE           CLUSTER-IP       EXTERNAL-IP   PORT(S)                      AGE
my-nginx-ingress-nginx-controller    LoadBalancer   10.96.58.210     &lt;pending&gt;     80:31873/TCP,443:31874/TCP   59m
</code></pre><ul><li><code>PORT(S)</code>ì—ì„œ <code>443</code>ì´ ë¦¬ìŠ¤ë‹í•˜ëŠ”ì§€ í™•ì¸.</li></ul><p>ğŸš¨ <strong>í¬íŠ¸ê°€ <code>443</code>ì´ ì•„ë‹ˆë¼ë©´ Ingress ì„¤ì •ì„ ë³€ê²½í•´ì•¼ í•¨.</strong></p><ul><li><code>ingress-nginx</code>ê°€ <code>NodePort</code> ë˜ëŠ” <code>LoadBalancer</code>ë¡œ ë°°í¬ë˜ì—ˆëŠ”ì§€ í™•ì¸ í›„ ìˆ˜ì •.</li></ul><hr><h3 id=3-ì„œë¹„ìŠ¤-endpoint-ë¬¸ì œ-í•´ê²°><strong>3ï¸âƒ£ ì„œë¹„ìŠ¤ Endpoint ë¬¸ì œ í•´ê²°</strong><a hidden class=anchor aria-hidden=true href=#3-ì„œë¹„ìŠ¤-endpoint-ë¬¸ì œ-í•´ê²°>#</a></h3><p>Ingressê°€ ì •ìƒ ì‘ë™í•˜ë ¤ë©´ <code>cnc-minio</code>, <code>cnc-cim-cnc-storage-proxy</code>, <code>cnc-cim-cim</code> ì„œë¹„ìŠ¤ê°€ í™œì„±í™”ë˜ì–´ ìˆì–´ì•¼ í•©ë‹ˆë‹¤.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl get pods -n cnc
</span></span><span style=display:flex><span>kubectl get svc -n cnc
</span></span></code></pre></div><p>âœ… <strong>ì„œë¹„ìŠ¤ê°€ ë¹„í™œì„± ìƒíƒœì´ë©´ ë‹¤ì‹œ ì‹œì‘</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl rollout restart deployment -n cnc cnc-minio cnc-cim-cnc-storage-proxy cnc-cim-cim
</span></span></code></pre></div><p>ğŸš¨ <strong>íŠ¹ì • ì„œë¹„ìŠ¤ì˜ Podì´ CrashLoopBackOff ìƒíƒœë¼ë©´ ë¡œê·¸ í™•ì¸</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl logs -n cnc &lt;pod-name&gt;
</span></span></code></pre></div><p>í•´ë‹¹ ì„œë¹„ìŠ¤ê°€ ì •ìƒì ìœ¼ë¡œ ì‹¤í–‰ë˜ì§€ ì•Šìœ¼ë©´ Ingressê°€ íŠ¸ë˜í”½ì„ ì „ë‹¬í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p><hr><h2 id=-ìµœì¢…-ì ê²€><strong>âœ… ìµœì¢… ì ê²€</strong><a hidden class=anchor aria-hidden=true href=#-ìµœì¢…-ì ê²€>#</a></h2><ol><li><p><strong>TLS ì¸ì¦ì„œ Secret ìƒì„±</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl get secret -n ingress-nginx cnc-cim-tls-nginx
</span></span></code></pre></div><ul><li>ì¡´ì¬í•˜ì§€ ì•Šìœ¼ë©´ ìƒì„± í›„ Ingress Controller ì¬ì‹œì‘.</li></ul></li><li><p><strong>Ingressê°€ 443 í¬íŠ¸ì—ì„œ ë¦¬ìŠ¤ë‹ ì¤‘ì¸ì§€ í™•ì¸</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl get svc -n ingress-nginx
</span></span></code></pre></div></li><li><p><strong>ì—°ê²°ëœ ì„œë¹„ìŠ¤ê°€ ì •ìƒì ìœ¼ë¡œ ì‹¤í–‰ ì¤‘ì¸ì§€ í™•ì¸</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl get pods -n cnc
</span></span><span style=display:flex><span>kubectl get svc -n cnc
</span></span></code></pre></div></li><li><p><strong>ëª¨ë“  ì„¤ì • í›„ <code>curl</code> ë‹¤ì‹œ ì‹¤í–‰</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>curl -k -vvv https://bd-82898.local
</span></span></code></pre></div></li></ol><h2 id=ì´ì œ-ìœ„-ë‹¨ê³„ëŒ€ë¡œ-ìˆ˜í–‰í•˜ë©´-tls-ë¬¸ì œì™€-ì„œë¹„ìŠ¤-ì—°ê²°-ë¬¸ì œë¥¼-í•´ê²°í• -ìˆ˜-ìˆìŠµë‹ˆë‹¤->ì´ì œ ìœ„ ë‹¨ê³„ëŒ€ë¡œ ìˆ˜í–‰í•˜ë©´ <strong>TLS ë¬¸ì œì™€ ì„œë¹„ìŠ¤ ì—°ê²° ë¬¸ì œë¥¼ í•´ê²°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤!</strong> ğŸš€<a hidden class=anchor aria-hidden=true href=#ì´ì œ-ìœ„-ë‹¨ê³„ëŒ€ë¡œ-ìˆ˜í–‰í•˜ë©´-tls-ë¬¸ì œì™€-ì„œë¹„ìŠ¤-ì—°ê²°-ë¬¸ì œë¥¼-í•´ê²°í• -ìˆ˜-ìˆìŠµë‹ˆë‹¤->#</a></h2><h1 id=secret-ìƒì„±-í›„-helm-ì¬ì„¤ì¹˜install-í•„ìš”-ì—¬ë¶€>Secret ìƒì„± í›„ Helm ì¬ì„¤ì¹˜(install) í•„ìš” ì—¬ë¶€<a hidden class=anchor aria-hidden=true href=#secret-ìƒì„±-í›„-helm-ì¬ì„¤ì¹˜install-í•„ìš”-ì—¬ë¶€>#</a></h1><h3 id=-secret-ìƒì„±-í›„-helm-ì¬ì„¤ì¹˜install-í•„ìš”-ì—¬ë¶€-ë¶„ì„><strong>ğŸ” Secret ìƒì„± í›„ Helm ì¬ì„¤ì¹˜(install) í•„ìš” ì—¬ë¶€ ë¶„ì„</strong><a hidden class=anchor aria-hidden=true href=#-secret-ìƒì„±-í›„-helm-ì¬ì„¤ì¹˜install-í•„ìš”-ì—¬ë¶€-ë¶„ì„>#</a></h3><p>í˜„ì¬ <code>kubectl create secret tls ... | kubectl apply -f -</code> ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ì—¬ TLS Secretì„ ìƒì„±í•˜ê³  ì ìš©í•˜ì˜€ìŠµë‹ˆë‹¤.</p><p>âœ… <strong>Secretì´ ì •ìƒì ìœ¼ë¡œ ì ìš©ë˜ì—ˆëŠ”ì§€ í™•ì¸:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl get secret -n ingress-nginx cnc-cim-tls-nginx -o yaml
</span></span><span style=display:flex><span>kubectl get secret -n ingress-nginx cnc-certificate -o yaml
</span></span></code></pre></div><ul><li>Secretì´ <code>ingress-nginx</code> ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì— ì •ìƒì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.</li></ul><hr><h3 id=-helm-ì¬ì„¤ì¹˜ê°€-í•„ìš”í•œê°€><strong>ğŸš€ Helm ì¬ì„¤ì¹˜ê°€ í•„ìš”í•œê°€?</strong><a hidden class=anchor aria-hidden=true href=#-helm-ì¬ì„¤ì¹˜ê°€-í•„ìš”í•œê°€>#</a></h3><h4 id=-helm-ì¬ì„¤ì¹˜ê°€-í•„ìš”-ì—†ëŠ”-ê²½ìš°>âœ… <strong>Helm ì¬ì„¤ì¹˜ê°€ í•„ìš” ì—†ëŠ” ê²½ìš°</strong><a hidden class=anchor aria-hidden=true href=#-helm-ì¬ì„¤ì¹˜ê°€-í•„ìš”-ì—†ëŠ”-ê²½ìš°>#</a></h4><ul><li>ê¸°ì¡´ Helm ì°¨íŠ¸ê°€ <strong>Secretì„ ì°¸ì¡°í•  ë•Œ ì§ì ‘ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì—ì„œ ê°€ì ¸ì˜¤ë„ë¡ êµ¬ì„±ëœ ê²½ìš°</strong>.</li><li>Ingress ë˜ëŠ” ë‹¤ë¥¸ ê´€ë ¨ ë¦¬ì†ŒìŠ¤ê°€ Secretì„ ì°¸ì¡°í•˜ê³  ìˆìœ¼ë©°, Secretì´ ìƒˆë¡œ ì ìš©ëœ ê²½ìš° <strong>Helm ì¬ì„¤ì¹˜ ì—†ì´ ì ìš©ë¨</strong>.</li><li>ì•„ë˜ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ì—¬ Ingress ì„¤ì •ì´ ìë™ìœ¼ë¡œ ë°˜ì˜ë˜ëŠ”ì§€ í™•ì¸:<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl rollout restart deployment -n ingress-nginx my-nginx-ingress-nginx-controller
</span></span></code></pre></div><ul><li>Ingress Controllerê°€ Secret ë³€ê²½ ì‚¬í•­ì„ ìë™ìœ¼ë¡œ ê°ì§€í•˜ë©´ Helm ì¬ì„¤ì¹˜ ì—†ì´ ì ìš©ë¨.</li></ul></li></ul><h4 id=-helm-ì¬ì„¤ì¹˜ê°€-í•„ìš”í•œ-ê²½ìš°>âŒ <strong>Helm ì¬ì„¤ì¹˜ê°€ í•„ìš”í•œ ê²½ìš°</strong><a hidden class=anchor aria-hidden=true href=#-helm-ì¬ì„¤ì¹˜ê°€-í•„ìš”í•œ-ê²½ìš°>#</a></h4><ul><li>Helm ì°¨íŠ¸ê°€ Secretì„ ë¯¸ë¦¬ ìƒì„±í•˜ëŠ” ë°©ì‹(Helmì˜ <code>values.yaml</code>ì—ì„œ Secretì„ ê´€ë¦¬)ìœ¼ë¡œ ë˜ì–´ ìˆë‹¤ë©´, Helmì´ Secretì„ ë‹¤ì‹œ ë°°í¬í•  í•„ìš”ê°€ ìˆìŒ.</li><li>ê¸°ì¡´ Ingress ë¦¬ì†ŒìŠ¤ê°€ ìƒˆë¡œìš´ Secretì„ ì°¸ì¡°í•˜ë„ë¡ ì—…ë°ì´íŠ¸ë˜ì§€ ì•Šì€ ê²½ìš°.</li><li>í™•ì¸ ë°©ë²•:<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>helm get values my-helm-release -n cnc
</span></span></code></pre></div><ul><li><code>tls.secretName</code> ê°’ì´ <code>cnc-cim-tls-nginx</code>ë¡œ ì„¤ì •ë˜ì–´ ìˆì§€ ì•Šë‹¤ë©´, Helm ê°’ì„ ì—…ë°ì´íŠ¸í•´ì•¼ í•¨.</li></ul></li></ul><p>âœ… <strong>Helm ì¬ì„¤ì¹˜ ì—†ì´ ì ìš© ê°€ëŠ¥í•œ ë°©ë²• (Ingress ê°•ì œ ì—…ë°ì´íŠ¸)</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl annotate ingress cnc-cim --overwrite kubernetes.io/ingress.class<span style=color:#f92672>=</span>nginx
</span></span><span style=display:flex><span>kubectl rollout restart deployment -n ingress-nginx my-nginx-ingress-nginx-controller
</span></span></code></pre></div><ul><li>Ingressë¥¼ ê°•ì œë¡œ ë‹¤ì‹œ ì ìš©í•˜ì—¬ ìƒˆë¡œìš´ Secretì„ ì‚¬ìš©í•˜ë„ë¡ í•¨.</li></ul><p>âœ… <strong>Helm ì—…ë°ì´íŠ¸ ì ìš©ì´ í•„ìš”í•œ ê²½ìš°</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>helm upgrade --install my-helm-release ./helm-chart -n cnc
</span></span></code></pre></div><ul><li><code>helm upgrade</code>ë¥¼ ì‚¬ìš©í•˜ë©´ ê¸°ì¡´ ë¦¬ì†ŒìŠ¤ë¥¼ ìœ ì§€í•˜ë©´ì„œ ë³€ê²½ ì‚¬í•­ì„ ì ìš©í•  ìˆ˜ ìˆìŒ.</li></ul><hr><h3 id=-ìµœì¢…-ê²°ë¡ ><strong>ğŸš€ ìµœì¢… ê²°ë¡ </strong><a hidden class=anchor aria-hidden=true href=#-ìµœì¢…-ê²°ë¡ >#</a></h3><table><thead><tr><th>ìƒí™©</th><th>Helm ì¬ì„¤ì¹˜ í•„ìš” ì—¬ë¶€</th></tr></thead><tbody><tr><td>Ingress Controllerê°€ Secret ë³€ê²½ ì‚¬í•­ì„ ìë™ ê°ì§€í•˜ëŠ” ê²½ìš°</td><td>âŒ í•„ìš” ì—†ìŒ (Ingress ì¬ì‹œì‘ë§Œ í•„ìš”)</td></tr><tr><td>Helm ì°¨íŠ¸ê°€ Secretì„ ì§ì ‘ ìƒì„±í•˜ëŠ” ê²½ìš° (<code>values.yaml</code>ì— ì •ì˜)</td><td>âœ… <code>helm upgrade</code> í•„ìš”</td></tr><tr><td>Ingress ë¦¬ì†ŒìŠ¤ê°€ ìƒˆë¡œìš´ Secretì„ ìë™ìœ¼ë¡œ ì°¸ì¡°í•˜ì§€ ì•ŠëŠ” ê²½ìš°</td><td>âœ… Ingress ê°•ì œ ì¬ì ìš© í•„ìš” (<code>kubectl annotate ingress</code>)</td></tr></tbody></table><p>ğŸ“Œ <strong>ê¶Œì¥ í•´ê²° ë°©ë²•:</strong></p><ol><li><p><strong>Ingress Controller ì¬ì‹œì‘ í›„ í…ŒìŠ¤íŠ¸</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl rollout restart deployment -n ingress-nginx my-nginx-ingress-nginx-controller
</span></span></code></pre></div></li><li><p><strong>Ingress ë¦¬ì†ŒìŠ¤ ê°•ì œ ì—…ë°ì´íŠ¸ í›„ í…ŒìŠ¤íŠ¸</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl annotate ingress cnc-cim --overwrite kubernetes.io/ingress.class<span style=color:#f92672>=</span>nginx
</span></span></code></pre></div></li><li><p><strong>ê·¸ë˜ë„ ì ìš©ë˜ì§€ ì•ŠëŠ”ë‹¤ë©´ Helm ì¬ì„¤ì¹˜</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>helm upgrade --install my-helm-release ./helm-chart -n cnc
</span></span></code></pre></div></li></ol><h2 id=-ìœ„-ë‹¨ê³„ë¥¼-ìˆœì„œëŒ€ë¡œ-ì‹¤í–‰-í›„-curl--k--vvv-httpsbd-82898localì„-ë‹¤ì‹œ-ì‹¤í–‰í•˜ì—¬-ì •ìƒ-ì‘ë™í•˜ëŠ”ì§€-í™•ì¸í•˜ì„¸ìš”>ğŸš€ <strong>ìœ„ ë‹¨ê³„ë¥¼ ìˆœì„œëŒ€ë¡œ ì‹¤í–‰ í›„ <code>curl -k -vvv https://bd-82898.local</code>ì„ ë‹¤ì‹œ ì‹¤í–‰í•˜ì—¬ ì •ìƒ ì‘ë™í•˜ëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”!</strong><a hidden class=anchor aria-hidden=true href=#-ìœ„-ë‹¨ê³„ë¥¼-ìˆœì„œëŒ€ë¡œ-ì‹¤í–‰-í›„-curl--k--vvv-httpsbd-82898localì„-ë‹¤ì‹œ-ì‹¤í–‰í•˜ì—¬-ì •ìƒ-ì‘ë™í•˜ëŠ”ì§€-í™•ì¸í•˜ì„¸ìš”>#</a></h2><h1 id=etchostsì—ì„œ-bd-82898local-ì„¤ì •-ë°©ë²•>/etc/hostsì—ì„œ bd-82898.local ì„¤ì • ë°©ë²•<a hidden class=anchor aria-hidden=true href=#etchostsì—ì„œ-bd-82898local-ì„¤ì •-ë°©ë²•>#</a></h1><h3 id=-etchostsì—ì„œ-bd-82898local-ì„¤ì •-ë°©ë²•><strong>ğŸ” <code>/etc/hosts</code>ì—ì„œ <code>bd-82898.local</code> ì„¤ì • ë°©ë²•</strong><a hidden class=anchor aria-hidden=true href=#-etchostsì—ì„œ-bd-82898local-ì„¤ì •-ë°©ë²•>#</a></h3><p>í˜„ì¬ <strong>Ingress Controllerê°€ ë°°í¬ëœ Kubernetes í´ëŸ¬ìŠ¤í„°</strong>ì—ì„œ <code>bd-82898.local</code>ì„ ì˜¬ë°”ë¥´ê²Œ ì„¤ì •í•˜ë ¤ë©´ <code>/etc/hosts</code> íŒŒì¼ì„ ì ì ˆíˆ ìˆ˜ì •í•´ì•¼ í•©ë‹ˆë‹¤.</p><hr><h2 id=-1-etchostsì—-ì˜¬ë°”ë¥¸-ip-ì¶”ê°€í•˜ê¸°><strong>âœ… 1ï¸âƒ£ <code>/etc/hosts</code>ì— ì˜¬ë°”ë¥¸ IP ì¶”ê°€í•˜ê¸°</strong><a hidden class=anchor aria-hidden=true href=#-1-etchostsì—-ì˜¬ë°”ë¥¸-ip-ì¶”ê°€í•˜ê¸°>#</a></h2><p>í˜„ì¬ <code>curl -k -vvv https://bd-82898.local</code> ì‹¤í–‰ ì‹œ <strong><code>127.0.0.1</code>ë¡œ í•´ì„</strong>ë˜ëŠ”ë°, ì´ê²ƒì´ ì˜¬ë°”ë¥¸ Ingress Controllerì˜ IPê°€ ì•„ë‹ ê°€ëŠ¥ì„±ì´ í½ë‹ˆë‹¤.</p><p>ğŸ“Œ <strong>Ingressì˜ ì‹¤ì œ External IP í™•ì¸</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl get svc -n ingress-nginx
</span></span></code></pre></div><p>âœ… ì˜ˆì œ ì¶œë ¥:</p><pre tabindex=0><code>NAME                                 TYPE           CLUSTER-IP       EXTERNAL-IP     PORT(S)                      AGE
my-nginx-ingress-nginx-controller    LoadBalancer   10.96.58.210     192.168.1.100   80:31873/TCP,443:31874/TCP   59m
</code></pre><ul><li><code>EXTERNAL-IP</code> ê°’ (<code>192.168.1.100</code>)ì´ Ingress Controllerê°€ ì œê³µí•˜ëŠ” ì™¸ë¶€ ì ‘ì† IP.</li></ul><hr><h2 id=-2-etchosts-ìˆ˜ì •><strong>âœ… 2ï¸âƒ£ <code>/etc/hosts</code> ìˆ˜ì •</strong><a hidden class=anchor aria-hidden=true href=#-2-etchosts-ìˆ˜ì •>#</a></h2><p><code>bd-82898.local</code>ì„ ì˜¬ë°”ë¥´ê²Œ í•´ì„í•˜ë„ë¡ <code>/etc/hosts</code> íŒŒì¼ì„ ìˆ˜ì •í•´ì•¼ í•©ë‹ˆë‹¤.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>sudo nano /etc/hosts
</span></span></code></pre></div><p>ğŸš€ <strong>ì¶”ê°€í•´ì•¼ í•  ë‚´ìš© (ì˜ˆì œ)</strong></p><pre tabindex=0><code>192.168.1.100    bd-82898.local
</code></pre><ul><li>ìœ„ì—ì„œ í™•ì¸í•œ <strong>Ingress Controllerì˜ External IP</strong>(<code>192.168.1.100</code>)ë¥¼ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤.</li><li>ë§Œì•½ Ingressê°€ <code>NodePort</code>ë¥¼ ì‚¬ìš©í•˜ê³  ìˆë‹¤ë©´, ë§ˆìŠ¤í„° ë…¸ë“œì˜ IPë¥¼ ì‚¬ìš©í•´ì•¼ í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.</li></ul><p>âœ… <strong>íŒŒì¼ ì €ì¥ í›„ ë³€ê²½ ì‚¬í•­ ì ìš©</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>sudo systemctl restart networking
</span></span></code></pre></div><hr><h2 id=-3-ì„¤ì •-í™•ì¸><strong>âœ… 3ï¸âƒ£ ì„¤ì • í™•ì¸</strong><a hidden class=anchor aria-hidden=true href=#-3-ì„¤ì •-í™•ì¸>#</a></h2><p>ì„¤ì •ì´ ì œëŒ€ë¡œ ë°˜ì˜ë˜ì—ˆëŠ”ì§€ <code>ping</code> ë˜ëŠ” <code>nslookup</code>ìœ¼ë¡œ í™•ì¸í•©ë‹ˆë‹¤.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>ping -c <span style=color:#ae81ff>4</span> bd-82898.local
</span></span></code></pre></div><p>âœ… ì •ìƒì ì¸ ê²½ìš°:</p><pre tabindex=0><code>PING bd-82898.local (192.168.1.100) 56(84) bytes of data.
64 bytes from 192.168.1.100: icmp_seq=1 ttl=64 time=0.053 ms
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>nslookup bd-82898.local
</span></span></code></pre></div><p>âœ… ì •ìƒì ì¸ ê²½ìš°:</p><pre tabindex=0><code>Server:        127.0.0.53
Address:       127.0.0.53#53

Non-authoritative answer:
Name:   bd-82898.local
Address: 192.168.1.100
</code></pre><hr><h2 id=-4-curlë¡œ-í…ŒìŠ¤íŠ¸><strong>âœ… 4ï¸âƒ£ <code>curl</code>ë¡œ í…ŒìŠ¤íŠ¸</strong><a hidden class=anchor aria-hidden=true href=#-4-curlë¡œ-í…ŒìŠ¤íŠ¸>#</a></h2><p>ì´ì œ <code>/etc/hosts</code>ë¥¼ ìˆ˜ì •í–ˆìœ¼ë¯€ë¡œ ë‹¤ì‹œ <code>curl</code>ì„ ì‹¤í–‰í•˜ì—¬ Ingress Controllerê°€ ì •ìƒì ìœ¼ë¡œ ì‘ë‹µí•˜ëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>curl -k -vvv https://bd-82898.local
</span></span></code></pre></div><p>âœ… <strong>ì •ìƒì ì¸ ê²½ìš°:</strong></p><pre tabindex=0><code>* Connected to bd-82898.local (192.168.1.100) port 443
* TLS handshake successful
...
HTTP/1.1 200 OK
</code></pre><p>ğŸš¨ <strong>ì—¬ì „íˆ SSL/TLS ì˜¤ë¥˜ê°€ ë°œìƒí•œë‹¤ë©´?</strong></p><ul><li>Ingressì— ì˜¬ë°”ë¥¸ TLS Secretì´ ì ìš©ë˜ì—ˆëŠ”ì§€ í™•ì¸:<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl get secret -n ingress-nginx cnc-cim-tls-nginx
</span></span></code></pre></div></li><li>Ingress ë¦¬ì†ŒìŠ¤ë¥¼ í™•ì¸:<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl describe ingress -n cnc
</span></span></code></pre></div></li></ul><hr><h2 id=-ê²°ë¡ ><strong>ğŸš€ ê²°ë¡ </strong><a hidden class=anchor aria-hidden=true href=#-ê²°ë¡ >#</a></h2><ol><li><strong>Ingress Controllerì˜ External IP í™•ì¸ (<code>kubectl get svc -n ingress-nginx</code>)</strong></li><li><strong>Ingressì˜ External IPë¥¼ <code>/etc/hosts</code>ì— ì¶”ê°€</strong><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>sudo nano /etc/hosts
</span></span></code></pre></div><pre tabindex=0><code>192.168.1.100    bd-82898.local
</code></pre></li><li><strong>ì„¤ì • ì ìš© í›„ í™•ì¸ (<code>ping</code>, <code>nslookup</code>)</strong></li><li><strong><code>curl</code>ë¡œ HTTPS ìš”ì²­ í…ŒìŠ¤íŠ¸ (<code>curl -k -vvv https://bd-82898.local</code>)</strong></li></ol><h2 id=ì´ì œ-bd-82898localì´-ì˜¬ë°”ë¥´ê²Œ-ì„¤ì •ë˜ì—ˆìœ¼ë¯€ë¡œ-ingressì™€-ì—°ê²°ì´-ì •ìƒì ìœ¼ë¡œ-ì‘ë™í• -ê²ƒì…ë‹ˆë‹¤->ì´ì œ <code>bd-82898.local</code>ì´ ì˜¬ë°”ë¥´ê²Œ ì„¤ì •ë˜ì—ˆìœ¼ë¯€ë¡œ, Ingressì™€ ì—°ê²°ì´ ì •ìƒì ìœ¼ë¡œ ì‘ë™í•  ê²ƒì…ë‹ˆë‹¤! ğŸš€<a hidden class=anchor aria-hidden=true href=#ì´ì œ-bd-82898localì´-ì˜¬ë°”ë¥´ê²Œ-ì„¤ì •ë˜ì—ˆìœ¼ë¯€ë¡œ-ingressì™€-ì—°ê²°ì´-ì •ìƒì ìœ¼ë¡œ-ì‘ë™í• -ê²ƒì…ë‹ˆë‹¤->#</a></h2><h1 id=curl--k--vvv-httpsbd-82898local-ì‹¤íŒ¨-2>curl -k -vvv <a href=https://bd-82898.local>https://bd-82898.local</a> ì‹¤íŒ¨<a hidden class=anchor aria-hidden=true href=#curl--k--vvv-httpsbd-82898local-ì‹¤íŒ¨-2>#</a></h1><h3 id=-ë¬¸ì œ-ë¶„ì„-ë°-í•´ê²°-ë°©ë²•-curl--k--vvv-httpsbd-82898local-ì‹¤íŒ¨-ssl_error_syscall><strong>ğŸ” ë¬¸ì œ ë¶„ì„ ë° í•´ê²° ë°©ë²•: <code>curl -k -vvv https://bd-82898.local</code> ì‹¤íŒ¨ (<code>SSL_ERROR_SYSCALL</code>)</strong><a hidden class=anchor aria-hidden=true href=#-ë¬¸ì œ-ë¶„ì„-ë°-í•´ê²°-ë°©ë²•-curl--k--vvv-httpsbd-82898local-ì‹¤íŒ¨-ssl_error_syscall>#</a></h3><h2 id=-ì£¼ìš”-ë¬¸ì œ-í™•ì¸><strong>ğŸš¨ ì£¼ìš” ë¬¸ì œ í™•ì¸</strong><a hidden class=anchor aria-hidden=true href=#-ì£¼ìš”-ë¬¸ì œ-í™•ì¸>#</a></h2><ol><li><p><strong>í˜„ì¬ <code>bd-82898.local</code>ì´ <code>127.0.0.1</code>ë¡œ í•´ì„ë¨ (ì˜ëª»ëœ IP)</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>cat /etc/hosts
</span></span></code></pre></div><pre tabindex=0><code>127.0.0.1       localhost bd-82898.local
</code></pre><ul><li><code>/etc/hosts</code> íŒŒì¼ì—ì„œ <code>bd-82898.local</code>ì´ <code>127.0.0.1</code>ë¡œ ì„¤ì •ë˜ì–´ ìˆìŒ.</li><li>í•˜ì§€ë§Œ Ingress ControllerëŠ” <strong>í´ëŸ¬ìŠ¤í„°ì˜ NodePort ë˜ëŠ” ë…¸ë“œ IPì—ì„œ ì‹¤í–‰ë¨.</strong></li><li><code>127.0.0.1:443</code>ëŠ” í˜„ì¬ Ingress Controllerì™€ ì—°ê²°ë˜ì§€ ì•ŠìŒ.</li></ul></li><li><p><strong>Ingress Controllerê°€ <code>NodePort</code>ë¡œ ì‹¤í–‰ë¨</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl get svc -n ingress-nginx
</span></span></code></pre></div><pre tabindex=0><code>NAME                                          TYPE        CLUSTER-IP     EXTERNAL-IP   PORT(S)                      AGE
my-nginx-ingress-nginx-controller             NodePort    10.96.58.210   &lt;none&gt;        80:30105/TCP,443:31813/TCP   69m
</code></pre><ul><li>í˜„ì¬ Ingress Controllerê°€ <code>NodePort</code>ë¡œ ì„¤ì •ë¨.</li><li>ì™¸ë¶€ì—ì„œ <code>443</code> í¬íŠ¸ë¡œ ì ‘ê·¼í•˜ë ¤ë©´ <strong>í´ëŸ¬ìŠ¤í„° ë…¸ë“œì˜ IP ë° <code>NodePort</code>ë¥¼ ì‚¬ìš©í•´ì•¼ í•¨.</strong></li><li>í˜„ì¬ <code>/etc/hosts</code>ì˜ <code>127.0.0.1</code>ì€ <strong>ì˜ëª»ëœ ì£¼ì†Œ</strong>ì´ë©°, ìˆ˜ì •í•´ì•¼ í•¨.</li></ul></li><li><p><strong><code>hostname -I</code> ê²°ê³¼</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>hostname -I
</span></span></code></pre></div><pre tabindex=0><code>172.31.180.118 172.17.0.1 172.18.0.1 fc00:f853:ccd:e793::1
</code></pre><ul><li><strong>ì˜¬ë°”ë¥¸ ë…¸ë“œ IPëŠ” <code>172.31.180.118</code> (ì´ì „ ì¶œë ¥ì—ì„œ ì²« ë²ˆì§¸ IPê°€ ì¼ë°˜ì ìœ¼ë¡œ ë…¸ë“œ IP)</strong></li><li><code>/etc/hosts</code>ì—ì„œ <code>bd-82898.local</code>ì„ ì´ IPë¡œ ë§¤í•‘í•´ì•¼ í•¨.</li></ul></li></ol><hr><h2 id=-í•´ê²°-ë°©ë²•-1><strong>âœ… í•´ê²° ë°©ë²•</strong><a hidden class=anchor aria-hidden=true href=#-í•´ê²°-ë°©ë²•-1>#</a></h2><h3 id=1-etchostsì—ì„œ-bd-82898localì„-ë…¸ë“œ-ipë¡œ-ë³€ê²½><strong>1ï¸âƒ£ <code>/etc/hosts</code>ì—ì„œ <code>bd-82898.local</code>ì„ ë…¸ë“œ IPë¡œ ë³€ê²½</strong><a hidden class=anchor aria-hidden=true href=#1-etchostsì—ì„œ-bd-82898localì„-ë…¸ë“œ-ipë¡œ-ë³€ê²½>#</a></h3><p>ğŸ“Œ <strong><code>/etc/hosts</code> ìˆ˜ì •</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>sudo nano /etc/hosts
</span></span></code></pre></div><p>ğŸš€ <strong>ìˆ˜ì • í›„ ì˜ˆì œ (<code>127.0.0.1</code>ì„ <code>172.31.180.118</code>ë¡œ ë³€ê²½)</strong></p><pre tabindex=0><code>172.31.180.118   bd-82898.local
</code></pre><p>ğŸ“Œ <strong>ë³€ê²½ ì‚¬í•­ ì ìš©</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>sudo systemctl restart networking
</span></span></code></pre></div><p>ë˜ëŠ” WSLì„ ë‹¤ì‹œ ì‹œì‘í•˜ë©´ ë³€ê²½ ì‚¬í•­ì´ ë°˜ì˜ë©ë‹ˆë‹¤.</p><p>âœ… <strong>ì„¤ì • í™•ì¸</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>ping bd-82898.local
</span></span></code></pre></div><p>ì •ìƒì ì¸ ê²½ìš°:</p><pre tabindex=0><code>PING bd-82898.local (172.31.180.118) 56(84) bytes of data.
64 bytes from 172.31.180.118: icmp_seq=1 ttl=64 time=0.053 ms
</code></pre><hr><h3 id=2-curlë¡œ-ì˜¬ë°”ë¥¸-nodeport-ì‚¬ìš©í•˜ì—¬-í…ŒìŠ¤íŠ¸><strong>2ï¸âƒ£ <code>curl</code>ë¡œ ì˜¬ë°”ë¥¸ NodePort ì‚¬ìš©í•˜ì—¬ í…ŒìŠ¤íŠ¸</strong><a hidden class=anchor aria-hidden=true href=#2-curlë¡œ-ì˜¬ë°”ë¥¸-nodeport-ì‚¬ìš©í•˜ì—¬-í…ŒìŠ¤íŠ¸>#</a></h3><p>í˜„ì¬ Ingress Controllerê°€ <code>NodePort (31813)</code>ì—ì„œ HTTPSë¥¼ ì œê³µí•˜ë¯€ë¡œ <strong>ì˜¬ë°”ë¥¸ í¬íŠ¸ë¡œ ìš”ì²­ì„ ë³´ë‚´ì•¼ í•¨</strong>.</p><p>âœ… <strong>NodePort í™•ì¸</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl get svc -n ingress-nginx
</span></span></code></pre></div><p>âœ… <strong><code>curl</code> í…ŒìŠ¤íŠ¸ (ì˜¬ë°”ë¥¸ í¬íŠ¸ ì‚¬ìš©)</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>curl -k -vvv https://bd-82898.local:31813
</span></span></code></pre></div><p>ğŸš€ <strong>ì •ìƒì ì¸ ê²½ìš°</strong></p><pre tabindex=0><code>* Connected to bd-82898.local (172.31.180.118) port 31813
* TLS handshake successful
...
HTTP/1.1 200 OK
</code></pre><p>ğŸš¨ <strong>ì—¬ì „íˆ <code>SSL_ERROR_SYSCALL</code> ë°œìƒí•˜ë©´?</strong></p><ul><li>Ingress ì„¤ì •ì´ ì˜¬ë°”ë¥´ê²Œ ì ìš©ë˜ì—ˆëŠ”ì§€ í™•ì¸:</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl get ingress -n cnc
</span></span><span style=display:flex><span>kubectl describe ingress -n cnc
</span></span></code></pre></div><ul><li>TLS ì„¤ì •ì´ ëˆ„ë½ë˜ì—ˆë‹¤ë©´ Ingress ë¦¬ì†ŒìŠ¤ë¥¼ ì—…ë°ì´íŠ¸í•´ì•¼ í•¨.</li></ul><hr><h3 id=3-ingress-controllerì˜-external-ipë¥¼-ì§ì ‘-í™•ì¸-í›„-etchosts-ì—…ë°ì´íŠ¸><strong>3ï¸âƒ£ Ingress Controllerì˜ External IPë¥¼ ì§ì ‘ í™•ì¸ í›„ <code>/etc/hosts</code> ì—…ë°ì´íŠ¸</strong><a hidden class=anchor aria-hidden=true href=#3-ingress-controllerì˜-external-ipë¥¼-ì§ì ‘-í™•ì¸-í›„-etchosts-ì—…ë°ì´íŠ¸>#</a></h3><p>ğŸ“Œ <strong>ì™¸ë¶€ì—ì„œ ì ‘ê·¼ ê°€ëŠ¥í•œ Ingress Controllerì˜ IP í™•ì¸</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl get nodes -o wide
</span></span></code></pre></div><p>âœ… ì˜ˆì œ ì¶œë ¥:</p><pre tabindex=0><code>NAME       STATUS   ROLES    AGE    VERSION   INTERNAL-IP      EXTERNAL-IP
worker-1   Ready    &lt;none&gt;   2d     v1.25.2   172.31.180.118   &lt;none&gt;
</code></pre><ul><li><strong><code>INTERNAL-IP</code> (172.31.180.118)ë¥¼ <code>/etc/hosts</code>ì— ì„¤ì •í•´ì•¼ í•¨.</strong></li></ul><p>ğŸ“Œ <strong>Ingress ìƒíƒœ í™•ì¸</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl describe svc -n ingress-nginx my-nginx-ingress-nginx-controller
</span></span></code></pre></div><p>âœ… <strong>ê²°ê³¼ì—ì„œ External IPê°€ ì„¤ì •ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸</strong></p><pre tabindex=0><code>LoadBalancer Ingress: 172.31.180.118
</code></pre><p>ğŸš€ <strong>ì˜¬ë°”ë¥¸ <code>/etc/hosts</code> ì„¤ì •</strong></p><pre tabindex=0><code>172.31.180.118   bd-82898.local
</code></pre><hr><h2 id=-ìµœì¢…-í•´ê²°-ë°©ë²•-ìš”ì•½><strong>ğŸš€ ìµœì¢… í•´ê²° ë°©ë²• ìš”ì•½</strong><a hidden class=anchor aria-hidden=true href=#-ìµœì¢…-í•´ê²°-ë°©ë²•-ìš”ì•½>#</a></h2><ol><li><strong>Ingress Controllerì˜ ë…¸ë“œ IP í™•ì¸</strong><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>hostname -I
</span></span></code></pre></div></li><li><strong>NodePortë¡œ ìš”ì²­ (<code>31813</code> í™•ì¸)</strong><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>curl -k -vvv https://bd-82898.local:31813
</span></span></code></pre></div></li><li><strong><code>/etc/hosts</code>ì—ì„œ <code>127.0.0.1</code>ì„ Ingress Controller IPë¡œ ë³€ê²½</strong><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>sudo nano /etc/hosts
</span></span></code></pre></div><pre tabindex=0><code>172.31.180.118   bd-82898.local
</code></pre></li><li><strong>ë„¤íŠ¸ì›Œí¬ ë³€ê²½ ì‚¬í•­ ì ìš©</strong><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>sudo systemctl restart networking
</span></span></code></pre></div></li></ol><hr><h2 id=-ì´ì œ-ë‹¤ì‹œ-curl--k--vvv-httpsbd-82898localì„-ì‹¤í–‰í•˜ì—¬-ì •ìƒ-ë™ì‘í•˜ëŠ”ì§€-í™•ì¸í•˜ì„¸ìš”>ğŸš€ <strong>ì´ì œ ë‹¤ì‹œ <code>curl -k -vvv https://bd-82898.local</code>ì„ ì‹¤í–‰í•˜ì—¬ ì •ìƒ ë™ì‘í•˜ëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”!</strong><a hidden class=anchor aria-hidden=true href=#-ì´ì œ-ë‹¤ì‹œ-curl--k--vvv-httpsbd-82898localì„-ì‹¤í–‰í•˜ì—¬-ì •ìƒ-ë™ì‘í•˜ëŠ”ì§€-í™•ì¸í•˜ì„¸ìš”>#</a></h2><h1 id=curl--k--vvv-httpsbd-82898local31813-ì‹¤íŒ¨-connection-refused>curl -k -vvv <a href=https://bd-82898.local:31813>https://bd-82898.local:31813</a> ì‹¤íŒ¨ (Connection refused)<a hidden class=anchor aria-hidden=true href=#curl--k--vvv-httpsbd-82898local31813-ì‹¤íŒ¨-connection-refused>#</a></h1><h3 id=-ë¬¸ì œ-ë¶„ì„-ë°-í•´ê²°-ë°©ë²•-curl--k--vvv-httpsbd-82898local31813-ì‹¤íŒ¨-connection-refused><strong>ğŸ” ë¬¸ì œ ë¶„ì„ ë° í•´ê²° ë°©ë²•: <code>curl -k -vvv https://bd-82898.local:31813</code> ì‹¤íŒ¨ (<code>Connection refused</code>)</strong><a hidden class=anchor aria-hidden=true href=#-ë¬¸ì œ-ë¶„ì„-ë°-í•´ê²°-ë°©ë²•-curl--k--vvv-httpsbd-82898local31813-ì‹¤íŒ¨-connection-refused>#</a></h3><h2 id=-ì£¼ìš”-ë¬¸ì œ-í™•ì¸-1><strong>ğŸš¨ ì£¼ìš” ë¬¸ì œ í™•ì¸</strong><a hidden class=anchor aria-hidden=true href=#-ì£¼ìš”-ë¬¸ì œ-í™•ì¸-1>#</a></h2><ol><li><p><strong><code>bd-82898.local</code>ì´ ì˜¬ë°”ë¥¸ ë…¸ë“œ IP(<code>172.31.180.118</code>)ë¡œ í•´ì„ë¨</strong> âœ…</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>cat /etc/hosts
</span></span></code></pre></div><pre tabindex=0><code>172.31.180.118   bd-82898.local
</code></pre><ul><li><code>/etc/hosts</code> ì„¤ì •ì€ ì˜¬ë°”ë¥´ê²Œ ì ìš©ë¨.</li><li><code>ping bd-82898.local</code> í…ŒìŠ¤íŠ¸ ê²°ê³¼ <strong>ì •ìƒì ì¸ ì‘ë‹µ</strong>ì„ ë°›ìŒ.</li></ul></li><li><p><strong>Ingress Controllerê°€ <code>NodePort</code>ë¡œ ì‹¤í–‰ ì¤‘</strong> âœ…</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl get svc -n ingress-nginx
</span></span></code></pre></div><pre tabindex=0><code>NAME                                          TYPE        CLUSTER-IP     EXTERNAL-IP   PORT(S)                      AGE
my-nginx-ingress-nginx-controller             NodePort    10.96.58.210   &lt;none&gt;        80:30105/TCP,443:31813/TCP   69m
</code></pre><ul><li><strong>HTTPS(443) â†’ NodePort <code>31813</code>ì—ì„œ ì œê³µë¨</strong>.</li><li>ì™¸ë¶€ì—ì„œ <code>https://bd-82898.local:31813</code>ë¡œ ì ‘ê·¼í•´ì•¼ í•¨.</li></ul></li><li><p><strong><code>curl</code> ìš”ì²­ ì‹œ <code>Connection refused</code> ë°œìƒ</strong> âŒ</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>curl -k -vvv https://bd-82898.local:31813
</span></span></code></pre></div><pre tabindex=0><code>* connect to 172.31.180.118 port 31813 failed: Connection refused
* Failed to connect to bd-82898.local port 31813
</code></pre><ul><li><strong>ì›ì¸: Ingress Controllerê°€ ì‹¤í–‰ ì¤‘ì´ì§€ë§Œ, ë…¸ë“œì˜ <code>31813</code> í¬íŠ¸ê°€ ì‹¤ì œë¡œ ì—´ë ¤ ìˆì§€ ì•ŠìŒ.</strong></li></ul></li></ol><hr><h2 id=-í•´ê²°-ë°©ë²•-2><strong>âœ… í•´ê²° ë°©ë²•</strong><a hidden class=anchor aria-hidden=true href=#-í•´ê²°-ë°©ë²•-2>#</a></h2><h3 id=1-ingress-controllerê°€-ì‹¤ì œë¡œ-nodeportì—ì„œ-ë¦¬ìŠ¤ë‹í•˜ëŠ”ì§€-í™•ì¸><strong>1ï¸âƒ£ Ingress Controllerê°€ ì‹¤ì œë¡œ <code>NodePort</code>ì—ì„œ ë¦¬ìŠ¤ë‹í•˜ëŠ”ì§€ í™•ì¸</strong><a hidden class=anchor aria-hidden=true href=#1-ingress-controllerê°€-ì‹¤ì œë¡œ-nodeportì—ì„œ-ë¦¬ìŠ¤ë‹í•˜ëŠ”ì§€-í™•ì¸>#</a></h3><p>Ingress Controllerê°€ <code>31813</code>ì—ì„œ ìˆ˜ì‹ í•˜ê³  ìˆëŠ”ì§€ í™•ì¸í•´ì•¼ í•©ë‹ˆë‹¤.</p><p>ğŸ“Œ <strong>Ingress Controller Podì˜ ìƒíƒœ í™•ì¸</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl get pods -n ingress-nginx
</span></span></code></pre></div><p>âœ… ì •ìƒì ì¸ ê²½ìš°:</p><pre tabindex=0><code>NAME                                                 READY   STATUS    RESTARTS   AGE
my-nginx-ingress-nginx-controller-57f6bc457c-k9x7c   1/1     Running   0          69m
</code></pre><p>ğŸš¨ <strong>Podì´ <code>CrashLoopBackOff</code> ë˜ëŠ” <code>Error</code> ìƒíƒœë¼ë©´ ë¬¸ì œ ë°œìƒ â†’ ë¡œê·¸ í™•ì¸ í•„ìš”</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl logs -n ingress-nginx my-nginx-ingress-nginx-controller-57f6bc457c-k9x7c
</span></span></code></pre></div><p>ğŸ“Œ <strong>NodePort(<code>31813</code>)ê°€ ì‹¤ì œë¡œ ì—´ë ¤ ìˆëŠ”ì§€ í™•ì¸</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>netstat -tulnp | grep <span style=color:#ae81ff>31813</span>
</span></span></code></pre></div><p>âœ… ì •ìƒì ì¸ ê²½ìš°:</p><pre tabindex=0><code>tcp6       0      0 :::31813                :::*                    LISTEN      1234/nginx
</code></pre><p>ğŸš¨ <strong>ì¶œë ¥ì´ ì—†ìœ¼ë©´ Ingress Controllerê°€ <code>NodePort</code>ë¥¼ ë¦¬ìŠ¤ë‹í•˜ì§€ ì•ŠìŒ â†’ ì¬ì‹œì‘ í•„ìš”</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl rollout restart deployment -n ingress-nginx my-nginx-ingress-nginx-controller
</span></span></code></pre></div><hr><h3 id=2-nodeportê°€-ëª¨ë“ -ì¸í„°í˜ì´ìŠ¤ì—ì„œ-ì—´ë ¤-ìˆëŠ”ì§€-í™•ì¸><strong>2ï¸âƒ£ <code>NodePort</code>ê°€ ëª¨ë“  ì¸í„°í˜ì´ìŠ¤ì—ì„œ ì—´ë ¤ ìˆëŠ”ì§€ í™•ì¸</strong><a hidden class=anchor aria-hidden=true href=#2-nodeportê°€-ëª¨ë“ -ì¸í„°í˜ì´ìŠ¤ì—ì„œ-ì—´ë ¤-ìˆëŠ”ì§€-í™•ì¸>#</a></h3><p>ğŸ“Œ <strong>Ingress Serviceê°€ External Trafficì„ ì˜¬ë°”ë¥´ê²Œ ë°›ë„ë¡ ì„¤ì •</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl edit svc -n ingress-nginx my-nginx-ingress-nginx-controller
</span></span></code></pre></div><p>ğŸš€ <strong>ì•„ë˜ ì„¤ì •ì„ ì¶”ê°€ ë˜ëŠ” í™•ì¸ (<code>ExternalTrafficPolicy: Cluster</code> ìœ ì§€)</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>type</span>: <span style=color:#ae81ff>NodePort</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>externalTrafficPolicy</span>: <span style=color:#ae81ff>Cluster</span>
</span></span></code></pre></div><p>ğŸ“Œ <strong>ë³€ê²½ í›„ Ingress Controller ì¬ì‹œì‘</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl rollout restart deployment -n ingress-nginx my-nginx-ingress-nginx-controller
</span></span></code></pre></div><hr><h3 id=3-ë°©í™”ë²½-ì„¤ì •-í™•ì¸-wsl2-í™˜ê²½><strong>3ï¸âƒ£ ë°©í™”ë²½ ì„¤ì • í™•ì¸ (WSL2 í™˜ê²½)</strong><a hidden class=anchor aria-hidden=true href=#3-ë°©í™”ë²½-ì„¤ì •-í™•ì¸-wsl2-í™˜ê²½>#</a></h3><p>í˜„ì¬ WSL2ì—ì„œ ì‹¤í–‰ ì¤‘ì´ë¯€ë¡œ <strong>WSL2ì˜ ë„¤íŠ¸ì›Œí¬ ì„¤ì •ì´ Ingress Controllerì˜ <code>NodePort</code>ë¥¼ ì°¨ë‹¨í•  ìˆ˜ ìˆìŒ</strong>.</p><p>ğŸ“Œ <strong>WSL2ì—ì„œ <code>NodePort</code> í¬íŠ¸ë¥¼ í—ˆìš©</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>sudo iptables -A INPUT -p tcp --dport <span style=color:#ae81ff>31813</span> -j ACCEPT
</span></span><span style=display:flex><span>sudo iptables -A OUTPUT -p tcp --sport <span style=color:#ae81ff>31813</span> -j ACCEPT
</span></span></code></pre></div><p>ğŸ“Œ <strong>í˜„ì¬ ì—´ë¦° í¬íŠ¸ í™•ì¸</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>sudo netstat -tulnp | grep <span style=color:#ae81ff>31813</span>
</span></span></code></pre></div><p>âœ… ì •ìƒì ì¸ ê²½ìš°:</p><pre tabindex=0><code>tcp6       0      0 :::31813                :::*                    LISTEN      1234/nginx
</code></pre><p>ğŸš¨ <strong>í¬íŠ¸ê°€ ì—´ë ¤ ìˆì§€ ì•Šìœ¼ë©´ WSL2 ë„¤íŠ¸ì›Œí¬ êµ¬ì„±ì„ ë³€ê²½í•´ì•¼ í•¨.</strong></p><hr><h3 id=4-curlë¡œ-ë‹¤ì‹œ-í…ŒìŠ¤íŠ¸><strong>4ï¸âƒ£ <code>curl</code>ë¡œ ë‹¤ì‹œ í…ŒìŠ¤íŠ¸</strong><a hidden class=anchor aria-hidden=true href=#4-curlë¡œ-ë‹¤ì‹œ-í…ŒìŠ¤íŠ¸>#</a></h3><p>ğŸ“Œ <strong>ì´ì œ ë‹¤ì‹œ <code>curl</code>ì„ ì‹¤í–‰í•˜ì—¬ í™•ì¸</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>curl -k -vvv https://bd-82898.local:31813
</span></span></code></pre></div><p>âœ… <strong>ì •ìƒì ì¸ ê²½ìš°</strong></p><pre tabindex=0><code>* Connected to bd-82898.local (172.31.180.118) port 31813
* TLS handshake successful
...
HTTP/1.1 200 OK
</code></pre><p>ğŸš¨ <strong>ì—¬ì „íˆ <code>Connection refused</code>ê°€ ë°œìƒí•˜ë©´?</strong></p><ul><li><code>NodePort</code>ê°€ ì •ìƒì ìœ¼ë¡œ ì—´ë ¤ ìˆëŠ”ì§€ ë‹¤ì‹œ í™•ì¸ (<code>netstat -tulnp | grep 31813</code>)</li><li>Ingress Controller ë¡œê·¸ í™•ì¸ (<code>kubectl logs -n ingress-nginx &lt;pod-name></code>)</li></ul><hr><h2 id=-ìµœì¢…-í•´ê²°-ë°©ë²•-ìš”ì•½-1><strong>ğŸš€ ìµœì¢… í•´ê²° ë°©ë²• ìš”ì•½</strong><a hidden class=anchor aria-hidden=true href=#-ìµœì¢…-í•´ê²°-ë°©ë²•-ìš”ì•½-1>#</a></h2><ol><li><strong>Ingress Controllerê°€ ì‹¤í–‰ ì¤‘ì¸ì§€ í™•ì¸</strong><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl get pods -n ingress-nginx
</span></span></code></pre></div></li><li><strong><code>NodePort(31813)</code>ê°€ ì—´ë ¤ ìˆëŠ”ì§€ í™•ì¸</strong><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>netstat -tulnp | grep <span style=color:#ae81ff>31813</span>
</span></span></code></pre></div></li><li><strong>Ingress Controllerê°€ ì˜¬ë°”ë¥´ê²Œ ë°°í¬ë˜ì—ˆëŠ”ì§€ í™•ì¸ í›„ ì¬ì‹œì‘</strong><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl rollout restart deployment -n ingress-nginx my-nginx-ingress-nginx-controller
</span></span></code></pre></div></li><li><strong>WSL2ì—ì„œ <code>NodePort(31813)</code> ë°©í™”ë²½ í—ˆìš©</strong><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>sudo iptables -A INPUT -p tcp --dport <span style=color:#ae81ff>31813</span> -j ACCEPT
</span></span></code></pre></div></li><li><strong><code>curl</code> í…ŒìŠ¤íŠ¸ ì¬ì‹¤í–‰</strong><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>curl -k -vvv https://bd-82898.local:31813
</span></span></code></pre></div></li></ol><h2 id=-ì´ì œ-ë‹¤ì‹œ-ì‹¤í–‰í•´ë³´ê³ -curlì´-ì •ìƒì ìœ¼ë¡œ-ì‘ë‹µí•˜ëŠ”ì§€-í™•ì¸í•˜ì„¸ìš”>ğŸš€ <strong>ì´ì œ ë‹¤ì‹œ ì‹¤í–‰í•´ë³´ê³  <code>curl</code>ì´ ì •ìƒì ìœ¼ë¡œ ì‘ë‹µí•˜ëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”!</strong><a hidden class=anchor aria-hidden=true href=#-ì´ì œ-ë‹¤ì‹œ-ì‹¤í–‰í•´ë³´ê³ -curlì´-ì •ìƒì ìœ¼ë¡œ-ì‘ë‹µí•˜ëŠ”ì§€-í™•ì¸í•˜ì„¸ìš”>#</a></h2><h1 id=nodeport-31813-connection-refused>NodePort (31813) Connection Refused<a hidden class=anchor aria-hidden=true href=#nodeport-31813-connection-refused>#</a></h1><h3 id=-ë¬¸ì œ-ë¶„ì„-ë°-í•´ê²°-ë°©ë²•-nodeport-31813-connection-refused><strong>ğŸ” ë¬¸ì œ ë¶„ì„ ë° í•´ê²° ë°©ë²•: <code>NodePort (31813) Connection Refused</code></strong><a hidden class=anchor aria-hidden=true href=#-ë¬¸ì œ-ë¶„ì„-ë°-í•´ê²°-ë°©ë²•-nodeport-31813-connection-refused>#</a></h3><h2 id=-ì£¼ìš”-ë¬¸ì œ-í™•ì¸-2><strong>ğŸš¨ ì£¼ìš” ë¬¸ì œ í™•ì¸</strong><a hidden class=anchor aria-hidden=true href=#-ì£¼ìš”-ë¬¸ì œ-í™•ì¸-2>#</a></h2><ol><li><p><strong><code>/etc/hosts</code> ì„¤ì • í™•ì¸ (<code>bd-82898.local</code>ì´ ì˜¬ë°”ë¥´ê²Œ ì„¤ì •ë¨) âœ…</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>cat /etc/hosts
</span></span></code></pre></div><pre tabindex=0><code>172.31.180.118   bd-82898.local
</code></pre><ul><li><strong>ì´ì œ <code>bd-82898.local</code>ì´ <code>172.31.180.118</code>(í´ëŸ¬ìŠ¤í„° ë…¸ë“œ IP)ë¡œ í•´ì„ë¨)</strong> â†’ ì˜¬ë°”ë¥´ê²Œ ì„¤ì •ë¨.</li></ul></li><li><p><strong>Ingress Controllerê°€ ì‹¤í–‰ ì¤‘ âœ…</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl get pods -n ingress-nginx
</span></span></code></pre></div><pre tabindex=0><code>NAME                                                READY   STATUS    RESTARTS   AGE
my-nginx-ingress-nginx-controller-c6559fb58-296k6   1/1     Running   0          7m28s
</code></pre><ul><li><strong>Ingress Controllerê°€ <code>Running</code> ìƒíƒœì´ë©° ì¬ì‹œì‘ë„ ìˆ˜í–‰ë¨.</strong></li></ul></li><li><p><strong><code>NodePort (31813)</code>ì´ ì—´ë ¤ ìˆì§€ ì•ŠìŒ âŒ</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>netstat -tulnp | grep <span style=color:#ae81ff>31813</span>
</span></span></code></pre></div><ul><li><strong>ê²°ê³¼ ì—†ìŒ â†’ Ingress Controllerê°€ <code>NodePort 31813</code>ì„ ë¦¬ìŠ¤ë‹í•˜ì§€ ì•ŠìŒ.</strong></li></ul></li><li><p><strong>Pod ë¡œê·¸ í™•ì¸ ë¶ˆê°€ (<code>Error from server (NotFound)</code>) âŒ</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl logs -n ingress-nginx my-nginx-ingress-nginx-controller-57f6bc457c-k9x7c
</span></span></code></pre></div><ul><li><strong>Pod ì´ë¦„ì´ ë³€ê²½ë¨ â†’ ì˜¬ë°”ë¥¸ Pod ì´ë¦„ ì‚¬ìš©í•´ì•¼ í•¨.</strong></li><li><strong>í˜„ì¬ ì‹¤í–‰ ì¤‘ì¸ Pod ë¡œê·¸ë¥¼ í™•ì¸í•´ì•¼ í•¨.</strong></li></ul></li></ol><hr><h2 id=-í•´ê²°-ë°©ë²•-3><strong>âœ… í•´ê²° ë°©ë²•</strong><a hidden class=anchor aria-hidden=true href=#-í•´ê²°-ë°©ë²•-3>#</a></h2><h3 id=1-ì˜¬ë°”ë¥¸-ingress-controller-pod-ë¡œê·¸-í™•ì¸><strong>1ï¸âƒ£ ì˜¬ë°”ë¥¸ Ingress Controller Pod ë¡œê·¸ í™•ì¸</strong><a hidden class=anchor aria-hidden=true href=#1-ì˜¬ë°”ë¥¸-ingress-controller-pod-ë¡œê·¸-í™•ì¸>#</a></h3><p>í˜„ì¬ <code>my-nginx-ingress-nginx-controller-57f6bc457c-k9x7c</code>ê°€ ì¡´ì¬í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ, <strong>ì‹¤ì œ ì‹¤í–‰ ì¤‘ì¸ Pod ë¡œê·¸ë¥¼ í™•ì¸í•´ì•¼ í•¨</strong>.</p><p>ğŸ“Œ <strong>í˜„ì¬ ì‹¤í–‰ ì¤‘ì¸ Ingress Pod í™•ì¸</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl get pods -n ingress-nginx
</span></span></code></pre></div><p>âœ… ì˜ˆì œ ì¶œë ¥:</p><pre tabindex=0><code>NAME                                                READY   STATUS    RESTARTS   AGE
my-nginx-ingress-nginx-controller-c6559fb58-296k6   1/1     Running   0          10m
</code></pre><p>ğŸš€ <strong>ì‹¤ì œ ì‹¤í–‰ ì¤‘ì¸ Podì˜ ë¡œê·¸ í™•ì¸</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl logs -n ingress-nginx my-nginx-ingress-nginx-controller-c6559fb58-296k6
</span></span></code></pre></div><ul><li>ë¡œê·¸ì— <strong><code>listening on port 31813</code></strong> ë˜ëŠ” <strong>TLS ì„¤ì • ê´€ë ¨ ì˜¤ë¥˜ê°€ ìˆëŠ”ì§€ í™•ì¸</strong>.</li></ul><hr><h3 id=2-nodeport-31813ì´-ì—´ë ¤-ìˆëŠ”ì§€-í™•ì¸-ë°-ingress-ì„¤ì •-í™•ì¸><strong>2ï¸âƒ£ <code>NodePort (31813)</code>ì´ ì—´ë ¤ ìˆëŠ”ì§€ í™•ì¸ ë° Ingress ì„¤ì • í™•ì¸</strong><a hidden class=anchor aria-hidden=true href=#2-nodeport-31813ì´-ì—´ë ¤-ìˆëŠ”ì§€-í™•ì¸-ë°-ingress-ì„¤ì •-í™•ì¸>#</a></h3><p>ğŸ“Œ <strong>Ingress Controllerê°€ <code>NodePort</code>ì—ì„œ ì„œë¹„ìŠ¤ë˜ê³  ìˆëŠ”ì§€ í™•ì¸</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl get svc -n ingress-nginx
</span></span></code></pre></div><p>âœ… ì •ìƒì ì¸ ê²½ìš°:</p><pre tabindex=0><code>NAME                                          TYPE        CLUSTER-IP     EXTERNAL-IP   PORT(S)                      AGE
my-nginx-ingress-nginx-controller             NodePort    10.96.58.210   &lt;none&gt;        80:30105/TCP,443:31813/TCP   69m
</code></pre><ul><li><strong><code>NodePort 31813</code>ì´ í• ë‹¹ë˜ì–´ ìˆì–´ì•¼ í•¨.</strong></li><li>ë§Œì•½ <code>NodePort</code>ê°€ ì„¤ì •ë˜ì§€ ì•Šì•˜ë‹¤ë©´, <strong>Ingressë¥¼ ë‹¤ì‹œ ì„¤ì •í•´ì•¼ í•¨</strong>.</li></ul><p>ğŸš€ <strong><code>NodePort</code> í¬íŠ¸ê°€ ì‹¤ì œë¡œ ë¦¬ìŠ¤ë‹ ì¤‘ì¸ì§€ í™•ì¸</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>netstat -tulnp | grep <span style=color:#ae81ff>31813</span>
</span></span></code></pre></div><p>âœ… ì •ìƒì ì¸ ê²½ìš°:</p><pre tabindex=0><code>tcp6       0      0 :::31813                :::*                    LISTEN      1234/nginx
</code></pre><p>ğŸš¨ <strong>ì—¬ì „íˆ ê²°ê³¼ê°€ ì—†ìœ¼ë©´ Ingress Controllerë¥¼ ë‹¤ì‹œ ë°°í¬í•´ì•¼ í•¨.</strong></p><hr><h3 id=3-ingress-controller-ì„¤ì •-ìˆ˜ì •-í•„ìš”í•œ-ê²½ìš°><strong>3ï¸âƒ£ Ingress Controller ì„¤ì • ìˆ˜ì • (í•„ìš”í•œ ê²½ìš°)</strong><a hidden class=anchor aria-hidden=true href=#3-ingress-controller-ì„¤ì •-ìˆ˜ì •-í•„ìš”í•œ-ê²½ìš°>#</a></h3><p>ğŸ“Œ <strong><code>NodePort</code> ì„¤ì •ì„ ê°•ì œ ì ìš©</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl edit svc -n ingress-nginx my-nginx-ingress-nginx-controller
</span></span></code></pre></div><p>ğŸš€ <strong>ì•„ë˜ ì„¤ì • í™•ì¸ ë° ì¶”ê°€</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>type</span>: <span style=color:#ae81ff>NodePort</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>externalTrafficPolicy</span>: <span style=color:#ae81ff>Cluster</span>
</span></span></code></pre></div><p>ğŸ“Œ <strong>ë³€ê²½ í›„ Ingress Controller ì¬ì‹œì‘</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl rollout restart deployment -n ingress-nginx my-nginx-ingress-nginx-controller
</span></span></code></pre></div><hr><h3 id=4-wsl2ì—ì„œ-nodeport-31813-í¬íŠ¸ê°€-ì°¨ë‹¨ë˜ì§€-ì•Šì•˜ëŠ”ì§€-í™•ì¸><strong>4ï¸âƒ£ WSL2ì—ì„œ <code>NodePort (31813)</code> í¬íŠ¸ê°€ ì°¨ë‹¨ë˜ì§€ ì•Šì•˜ëŠ”ì§€ í™•ì¸</strong><a hidden class=anchor aria-hidden=true href=#4-wsl2ì—ì„œ-nodeport-31813-í¬íŠ¸ê°€-ì°¨ë‹¨ë˜ì§€-ì•Šì•˜ëŠ”ì§€-í™•ì¸>#</a></h3><p>í˜„ì¬ <strong>WSL2ì—ì„œ ì‹¤í–‰ ì¤‘ì´ë¯€ë¡œ WSL2ì˜ ë„¤íŠ¸ì›Œí¬ ì„¤ì •ì´ <code>NodePort</code>ë¥¼ ì°¨ë‹¨í•  ê°€ëŠ¥ì„±ì´ ìˆìŒ</strong>.</p><p>ğŸ“Œ <strong>WSL2ì—ì„œ <code>NodePort (31813)</code> ë°©í™”ë²½ í—ˆìš©</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>sudo iptables -A INPUT -p tcp --dport <span style=color:#ae81ff>31813</span> -j ACCEPT
</span></span><span style=display:flex><span>sudo iptables -A OUTPUT -p tcp --sport <span style=color:#ae81ff>31813</span> -j ACCEPT
</span></span></code></pre></div><p>ğŸ“Œ <strong>í˜„ì¬ ì—´ë¦° í¬íŠ¸ í™•ì¸</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>sudo netstat -tulnp | grep <span style=color:#ae81ff>31813</span>
</span></span></code></pre></div><p>âœ… ì •ìƒì ì¸ ê²½ìš°:</p><pre tabindex=0><code>tcp6       0      0 :::31813                :::*                    LISTEN      1234/nginx
</code></pre><p>ğŸš¨ <strong>í¬íŠ¸ê°€ ì—´ë ¤ ìˆì§€ ì•Šìœ¼ë©´ WSL2 ë„¤íŠ¸ì›Œí¬ êµ¬ì„±ì„ ë³€ê²½í•´ì•¼ í•¨.</strong></p><hr><h3 id=5-curlë¡œ-ë‹¤ì‹œ-í…ŒìŠ¤íŠ¸><strong>5ï¸âƒ£ <code>curl</code>ë¡œ ë‹¤ì‹œ í…ŒìŠ¤íŠ¸</strong><a hidden class=anchor aria-hidden=true href=#5-curlë¡œ-ë‹¤ì‹œ-í…ŒìŠ¤íŠ¸>#</a></h3><p>ğŸ“Œ <strong>ì´ì œ ë‹¤ì‹œ <code>curl</code>ì„ ì‹¤í–‰í•˜ì—¬ í™•ì¸</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>curl -k -vvv https://bd-82898.local:31813
</span></span></code></pre></div><p>âœ… <strong>ì •ìƒì ì¸ ê²½ìš°</strong></p><pre tabindex=0><code>* Connected to bd-82898.local (172.31.180.118) port 31813
* TLS handshake successful
...
HTTP/1.1 200 OK
</code></pre><p>ğŸš¨ <strong>ì—¬ì „íˆ <code>Connection refused</code>ê°€ ë°œìƒí•˜ë©´?</strong></p><ul><li><code>NodePort</code>ê°€ ì •ìƒì ìœ¼ë¡œ ì—´ë ¤ ìˆëŠ”ì§€ ë‹¤ì‹œ í™•ì¸ (<code>netstat -tulnp | grep 31813</code>)</li><li>Ingress Controller ë¡œê·¸ í™•ì¸ (<code>kubectl logs -n ingress-nginx &lt;pod-name></code>)</li></ul><hr><h2 id=-ìµœì¢…-í•´ê²°-ë°©ë²•-ìš”ì•½-2><strong>ğŸš€ ìµœì¢… í•´ê²° ë°©ë²• ìš”ì•½</strong><a hidden class=anchor aria-hidden=true href=#-ìµœì¢…-í•´ê²°-ë°©ë²•-ìš”ì•½-2>#</a></h2><ol><li><strong>Ingress Controllerê°€ ì‹¤í–‰ ì¤‘ì¸ì§€ í™•ì¸</strong><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl get pods -n ingress-nginx
</span></span></code></pre></div></li><li><strong>ì‹¤ì œ ì‹¤í–‰ ì¤‘ì¸ Pod ë¡œê·¸ í™•ì¸</strong><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl logs -n ingress-nginx my-nginx-ingress-nginx-controller-c6559fb58-296k6
</span></span></code></pre></div></li><li><strong><code>NodePort (31813)</code>ê°€ ì—´ë ¤ ìˆëŠ”ì§€ í™•ì¸</strong><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>netstat -tulnp | grep <span style=color:#ae81ff>31813</span>
</span></span></code></pre></div></li><li><strong>Ingress Controllerê°€ ì˜¬ë°”ë¥´ê²Œ ë°°í¬ë˜ì—ˆëŠ”ì§€ í™•ì¸ í›„ ì¬ì‹œì‘</strong><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl rollout restart deployment -n ingress-nginx my-nginx-ingress-nginx-controller
</span></span></code></pre></div></li><li><strong>WSL2ì—ì„œ <code>NodePort (31813)</code> ë°©í™”ë²½ í—ˆìš©</strong><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>sudo iptables -A INPUT -p tcp --dport <span style=color:#ae81ff>31813</span> -j ACCEPT
</span></span></code></pre></div></li><li><strong><code>curl</code> í…ŒìŠ¤íŠ¸ ì¬ì‹¤í–‰</strong><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>curl -k -vvv https://bd-82898.local:31813
</span></span></code></pre></div></li></ol><p>ğŸš€ <strong>ì´ì œ ë‹¤ì‹œ ì‹¤í–‰í•´ë³´ê³  <code>curl</code>ì´ ì •ìƒì ìœ¼ë¡œ ì‘ë‹µí•˜ëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”!</strong></p><hr><h1 id=nodeport-31813-connection-refused-1>NodePort (31813) Connection Refused<a hidden class=anchor aria-hidden=true href=#nodeport-31813-connection-refused-1>#</a></h1><h3 id=-ë¬¸ì œ-ë¶„ì„-ë°-í•´ê²°-ë°©ë²•-nodeport-31813-connection-refused-1><strong>ğŸ” ë¬¸ì œ ë¶„ì„ ë° í•´ê²° ë°©ë²•: <code>NodePort (31813) Connection Refused</code></strong><a hidden class=anchor aria-hidden=true href=#-ë¬¸ì œ-ë¶„ì„-ë°-í•´ê²°-ë°©ë²•-nodeport-31813-connection-refused-1>#</a></h3><hr><h2 id=-ì£¼ìš”-ë¬¸ì œ-ìš”ì•½><strong>ğŸš¨ ì£¼ìš” ë¬¸ì œ ìš”ì•½</strong><a hidden class=anchor aria-hidden=true href=#-ì£¼ìš”-ë¬¸ì œ-ìš”ì•½>#</a></h2><ol><li><p><strong>Ingress Controller Podì´ ì •ìƒ ì‹¤í–‰ë¨ (<code>Running</code>)</strong> âœ…</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl get pods -n ingress-nginx
</span></span></code></pre></div><pre tabindex=0><code>NAME                                                 READY   STATUS    RESTARTS   AGE
my-nginx-ingress-nginx-controller-6b7b86d57d-2trlq   1/1     Running   0          80s
</code></pre><ul><li>Ingress Controllerê°€ ì •ìƒì ìœ¼ë¡œ ì‹¤í–‰ ì¤‘ì„.</li></ul></li><li><p><strong><code>NodePort (31813)</code>ì—ì„œ ì„œë¹„ìŠ¤ë˜ì§€ ì•ŠìŒ (<code>Connection refused</code>)</strong> âŒ</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>curl -k -vvv https://bd-82898.local:31813
</span></span></code></pre></div><pre tabindex=0><code>* connect to 172.31.180.118 port 31813 failed: Connection refused
* Failed to connect to bd-82898.local port 31813
</code></pre><ul><li><strong>Ingress Controllerê°€ <code>NodePort</code>ë¥¼ ë¦¬ìŠ¤ë‹í•˜ì§€ ì•Šê±°ë‚˜, WSL2ì—ì„œ ì°¨ë‹¨ë¨.</strong></li></ul></li><li><p><strong><code>netstat -tulnp | grep 31813</code> ì‹¤í–‰ ì‹œ ì•„ë¬´ëŸ° ê²°ê³¼ê°€ ì—†ìŒ</strong> âŒ</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>netstat -tulnp | grep <span style=color:#ae81ff>31813</span>
</span></span></code></pre></div><ul><li><strong>Ingress Controllerê°€ <code>31813</code> í¬íŠ¸ë¥¼ ì—´ì§€ ì•ŠìŒ.</strong></li><li><strong>Kubernetesì˜ <code>NodePort</code> ì„¤ì • ë¬¸ì œ ê°€ëŠ¥ì„± ìˆìŒ.</strong></li></ul></li></ol><hr><h2 id=-í•´ê²°-ë°©ë²•-4><strong>âœ… í•´ê²° ë°©ë²•</strong><a hidden class=anchor aria-hidden=true href=#-í•´ê²°-ë°©ë²•-4>#</a></h2><h3 id=1-nodeport-31813ê°€-ì˜¬ë°”ë¥´ê²Œ-ì„¤ì •ë˜ì—ˆëŠ”ì§€-í™•ì¸><strong>1ï¸âƒ£ <code>NodePort (31813)</code>ê°€ ì˜¬ë°”ë¥´ê²Œ ì„¤ì •ë˜ì—ˆëŠ”ì§€ í™•ì¸</strong><a hidden class=anchor aria-hidden=true href=#1-nodeport-31813ê°€-ì˜¬ë°”ë¥´ê²Œ-ì„¤ì •ë˜ì—ˆëŠ”ì§€-í™•ì¸>#</a></h3><p>ğŸ“Œ <strong>Ingress Controllerì˜ ì„œë¹„ìŠ¤ ì„¤ì •ì„ í™•ì¸</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl get svc -n ingress-nginx
</span></span></code></pre></div><p>âœ… ì˜ˆìƒë˜ëŠ” ì •ìƒì ì¸ ê²½ìš°:</p><pre tabindex=0><code>NAME                                          TYPE        CLUSTER-IP     EXTERNAL-IP   PORT(S)                      AGE
my-nginx-ingress-nginx-controller             NodePort    10.96.58.210   &lt;none&gt;        80:30105/TCP,443:31813/TCP   69m
</code></pre><p>ğŸš¨ <strong>ë§Œì•½ <code>443:31813/TCP</code>ê°€ ì—†ê±°ë‚˜ <code>TYPE=ClusterIP</code>ì´ë©´, <code>NodePort</code> ì„¤ì •ì´ ì˜ëª»ë¨.</strong><br>ì´ë¥¼ ìˆ˜ì •í•´ì•¼ í•¨.</p><hr><h3 id=2-nodeport-31813ê°€-ingress-controller-podì—ì„œ-ë¦¬ìŠ¤ë‹ë˜ëŠ”ì§€-í™•ì¸><strong>2ï¸âƒ£ <code>NodePort (31813)</code>ê°€ Ingress Controller Podì—ì„œ ë¦¬ìŠ¤ë‹ë˜ëŠ”ì§€ í™•ì¸</strong><a hidden class=anchor aria-hidden=true href=#2-nodeport-31813ê°€-ingress-controller-podì—ì„œ-ë¦¬ìŠ¤ë‹ë˜ëŠ”ì§€-í™•ì¸>#</a></h3><p>ğŸ“Œ <strong>Ingress Controllerì˜ ì‹¤ì œ Podì—ì„œ <code>31813</code> í¬íŠ¸ë¥¼ ë¦¬ìŠ¤ë‹í•˜ê³  ìˆëŠ”ì§€ í™•ì¸</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl exec -it -n ingress-nginx my-nginx-ingress-nginx-controller-6b7b86d57d-2trlq -- netstat -tulnp | grep <span style=color:#ae81ff>31813</span>
</span></span></code></pre></div><p>âœ… <strong>ì •ìƒì ì¸ ê²½ìš° (Pod ë‚´ë¶€ì—ì„œ <code>31813</code> í¬íŠ¸ê°€ ì—´ë ¤ ìˆìŒ):</strong></p><pre tabindex=0><code>tcp6       0      0 :::31813                :::*                    LISTEN      1234/nginx
</code></pre><p>ğŸš¨ <strong>ë§Œì•½ í¬íŠ¸ê°€ ì—´ë ¤ ìˆì§€ ì•Šë‹¤ë©´?</strong></p><ul><li>Ingress ì„¤ì •ì´ ì˜ëª»ë˜ì–´ ìˆì„ ê°€ëŠ¥ì„±ì´ í¼.</li><li>ì•„ë˜ <strong>Ingress ì„¤ì •ì„ ê°•ì œ ìˆ˜ì •</strong>í•´ì•¼ í•¨.</li></ul><hr><h3 id=3-ingress-controller-ì„œë¹„ìŠ¤-ì„¤ì •ì„-ê°•ì œ-ìˆ˜ì •><strong>3ï¸âƒ£ Ingress Controller ì„œë¹„ìŠ¤ ì„¤ì •ì„ ê°•ì œ ìˆ˜ì •</strong><a hidden class=anchor aria-hidden=true href=#3-ingress-controller-ì„œë¹„ìŠ¤-ì„¤ì •ì„-ê°•ì œ-ìˆ˜ì •>#</a></h3><p>ğŸ“Œ <strong>Ingress Controllerì˜ <code>NodePort</code>ê°€ ì •í™•í•˜ê²Œ ì„¤ì •ë˜ì—ˆëŠ”ì§€ í™•ì¸</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl edit svc -n ingress-nginx my-nginx-ingress-nginx-controller
</span></span></code></pre></div><p>ğŸš€ <strong>ì•„ë˜ ì„¤ì • í™•ì¸ ë° ì¶”ê°€ (<code>externalTrafficPolicy: Cluster</code> ìœ ì§€)</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>type</span>: <span style=color:#ae81ff>NodePort</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>externalTrafficPolicy</span>: <span style=color:#ae81ff>Cluster</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>ports</span>:
</span></span><span style=display:flex><span>    - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>https</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>port</span>: <span style=color:#ae81ff>443</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>targetPort</span>: <span style=color:#ae81ff>https</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>nodePort</span>: <span style=color:#ae81ff>31813</span>  <span style=color:#75715e># &lt;- ì˜¬ë°”ë¥´ê²Œ ì„¤ì •ë˜ì–´ì•¼ í•¨</span>
</span></span></code></pre></div><p>ğŸ“Œ <strong>ë³€ê²½ í›„ Ingress Controller ì¬ì‹œì‘</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl rollout restart deployment -n ingress-nginx my-nginx-ingress-nginx-controller
</span></span></code></pre></div><hr><h3 id=4-wsl2ì—ì„œ-nodeport-31813-í¬íŠ¸ê°€-ì°¨ë‹¨ë˜ì§€-ì•Šì•˜ëŠ”ì§€-í™•ì¸-1><strong>4ï¸âƒ£ WSL2ì—ì„œ <code>NodePort (31813)</code> í¬íŠ¸ê°€ ì°¨ë‹¨ë˜ì§€ ì•Šì•˜ëŠ”ì§€ í™•ì¸</strong><a hidden class=anchor aria-hidden=true href=#4-wsl2ì—ì„œ-nodeport-31813-í¬íŠ¸ê°€-ì°¨ë‹¨ë˜ì§€-ì•Šì•˜ëŠ”ì§€-í™•ì¸-1>#</a></h3><p>ğŸ“Œ <strong>WSL2ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ì™¸ë¶€ íŠ¸ë˜í”½ì„ ì°¨ë‹¨í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ, ìˆ˜ë™ìœ¼ë¡œ <code>NodePort</code>ë¥¼ í—ˆìš©í•´ì•¼ í•¨.</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>sudo iptables -A INPUT -p tcp --dport <span style=color:#ae81ff>31813</span> -j ACCEPT
</span></span><span style=display:flex><span>sudo iptables -A OUTPUT -p tcp --sport <span style=color:#ae81ff>31813</span> -j ACCEPT
</span></span></code></pre></div><p>ğŸ“Œ <strong>í˜„ì¬ ì—´ë¦° í¬íŠ¸ í™•ì¸</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>sudo netstat -tulnp | grep <span style=color:#ae81ff>31813</span>
</span></span></code></pre></div><p>âœ… ì •ìƒì ì¸ ê²½ìš°:</p><pre tabindex=0><code>tcp6       0      0 :::31813                :::*                    LISTEN      1234/nginx
</code></pre><p>ğŸš¨ <strong>í¬íŠ¸ê°€ ì—´ë ¤ ìˆì§€ ì•Šìœ¼ë©´ WSL2 ë„¤íŠ¸ì›Œí¬ êµ¬ì„±ì„ ë³€ê²½í•´ì•¼ í•¨.</strong></p><hr><h3 id=5-curlë¡œ-ë‹¤ì‹œ-í…ŒìŠ¤íŠ¸-1><strong>5ï¸âƒ£ <code>curl</code>ë¡œ ë‹¤ì‹œ í…ŒìŠ¤íŠ¸</strong><a hidden class=anchor aria-hidden=true href=#5-curlë¡œ-ë‹¤ì‹œ-í…ŒìŠ¤íŠ¸-1>#</a></h3><p>ğŸ“Œ <strong>ì´ì œ ë‹¤ì‹œ <code>curl</code>ì„ ì‹¤í–‰í•˜ì—¬ í™•ì¸</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>curl -k -vvv https://bd-82898.local:31813
</span></span></code></pre></div><p>âœ… <strong>ì •ìƒì ì¸ ê²½ìš°</strong></p><pre tabindex=0><code>* Connected to bd-82898.local (172.31.180.118) port 31813
* TLS handshake successful
...
HTTP/1.1 200 OK
</code></pre><p>ğŸš¨ <strong>ì—¬ì „íˆ <code>Connection refused</code>ê°€ ë°œìƒí•˜ë©´?</strong></p><ul><li><code>NodePort</code>ê°€ ì •ìƒì ìœ¼ë¡œ ì—´ë ¤ ìˆëŠ”ì§€ ë‹¤ì‹œ í™•ì¸ (<code>netstat -tulnp | grep 31813</code>)</li><li>Ingress Controller ë¡œê·¸ í™•ì¸ (<code>kubectl logs -n ingress-nginx &lt;pod-name></code>)</li></ul><hr><h2 id=-ìµœì¢…-í•´ê²°-ë°©ë²•-ìš”ì•½-3><strong>ğŸš€ ìµœì¢… í•´ê²° ë°©ë²• ìš”ì•½</strong><a hidden class=anchor aria-hidden=true href=#-ìµœì¢…-í•´ê²°-ë°©ë²•-ìš”ì•½-3>#</a></h2><ol><li><strong>Ingress Controllerê°€ ì‹¤í–‰ ì¤‘ì¸ì§€ í™•ì¸</strong><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl get pods -n ingress-nginx
</span></span></code></pre></div></li><li><strong>Ingress Controllerì˜ <code>NodePort</code> ì„¤ì • í™•ì¸</strong><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl get svc -n ingress-nginx
</span></span></code></pre></div></li><li><strong>Pod ë‚´ë¶€ì—ì„œ <code>NodePort (31813)</code>ê°€ ë¦¬ìŠ¤ë‹ë˜ëŠ”ì§€ í™•ì¸</strong><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl exec -it -n ingress-nginx my-nginx-ingress-nginx-controller-6b7b86d57d-2trlq -- netstat -tulnp | grep <span style=color:#ae81ff>31813</span>
</span></span></code></pre></div></li><li><strong>Ingress Controller ì„œë¹„ìŠ¤ ì„¤ì •ì„ ê°•ì œ ìˆ˜ì •</strong><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl edit svc -n ingress-nginx my-nginx-ingress-nginx-controller
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>type</span>: <span style=color:#ae81ff>NodePort</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>externalTrafficPolicy</span>: <span style=color:#ae81ff>Cluster</span>
</span></span></code></pre></div></li><li><strong>Ingress Controller ì¬ì‹œì‘</strong><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl rollout restart deployment -n ingress-nginx my-nginx-ingress-nginx-controller
</span></span></code></pre></div></li><li><strong>WSL2ì—ì„œ <code>NodePort (31813)</code> ë°©í™”ë²½ í—ˆìš©</strong><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>sudo iptables -A INPUT -p tcp --dport <span style=color:#ae81ff>31813</span> -j ACCEPT
</span></span></code></pre></div></li><li><strong><code>curl</code> í…ŒìŠ¤íŠ¸ ì¬ì‹¤í–‰</strong><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>curl -k -vvv https://bd-82898.local:31813
</span></span></code></pre></div></li></ol><p>ğŸš€ <strong>ì´ì œ ë‹¤ì‹œ ì‹¤í–‰í•´ë³´ê³  <code>curl</code>ì´ ì •ìƒì ìœ¼ë¡œ ì‘ë‹µí•˜ëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”!</strong></p><hr><h1 id=heading><a hidden class=anchor aria-hidden=true href=#heading>#</a></h1><hr><h1 id=heading-1><a hidden class=anchor aria-hidden=true href=#heading-1>#</a></h1><hr><h1 id=heading-2><a hidden class=anchor aria-hidden=true href=#heading-2>#</a></h1><hr><h1 id=heading-3><a hidden class=anchor aria-hidden=true href=#heading-3>#</a></h1><hr><h1 id=heading-4><a hidden class=anchor aria-hidden=true href=#heading-4>#</a></h1><hr><h1 id=heading-5><a hidden class=anchor aria-hidden=true href=#heading-5>#</a></h1><hr><h1 id=heading-6><a hidden class=anchor aria-hidden=true href=#heading-6>#</a></h1><hr><h1 id=heading-7><a hidden class=anchor aria-hidden=true href=#heading-7>#</a></h1><hr><h1 id=heading-8><a hidden class=anchor aria-hidden=true href=#heading-8>#</a></h1><hr><h1 id=heading-9><a hidden class=anchor aria-hidden=true href=#heading-9>#</a></h1><hr><h1 id=heading-10><a hidden class=anchor aria-hidden=true href=#heading-10>#</a></h1><hr><h1 id=heading-11><a hidden class=anchor aria-hidden=true href=#heading-11>#</a></h1><hr><h1 id=heading-12><a hidden class=anchor aria-hidden=true href=#heading-12>#</a></h1><hr><h1 id=heading-13><a hidden class=anchor aria-hidden=true href=#heading-13>#</a></h1><hr><h1 id=heading-14><a hidden class=anchor aria-hidden=true href=#heading-14>#</a></h1><hr><h1 id=heading-15><a hidden class=anchor aria-hidden=true href=#heading-15>#</a></h1><hr><h1 id=heading-16><a hidden class=anchor aria-hidden=true href=#heading-16>#</a></h1><hr><h1 id=heading-17><a hidden class=anchor aria-hidden=true href=#heading-17>#</a></h1><hr><h1 id=heading-18><a hidden class=anchor aria-hidden=true href=#heading-18>#</a></h1><hr><h1 id=heading-19><a hidden class=anchor aria-hidden=true href=#heading-19>#</a></h1><hr><h1 id=heading-20><a hidden class=anchor aria-hidden=true href=#heading-20>#</a></h1><hr><h1 id=heading-21><a hidden class=anchor aria-hidden=true href=#heading-21>#</a></h1><hr><h1 id=heading-22><a hidden class=anchor aria-hidden=true href=#heading-22>#</a></h1><hr><h1 id=heading-23><a hidden class=anchor aria-hidden=true href=#heading-23>#</a></h1><hr><h1 id=heading-24><a hidden class=anchor aria-hidden=true href=#heading-24>#</a></h1><hr><h1 id=heading-25><a hidden class=anchor aria-hidden=true href=#heading-25>#</a></h1><hr><h1 id=heading-26><a hidden class=anchor aria-hidden=true href=#heading-26>#</a></h1></div><footer class=post-footer><ul class=post-tags></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://jongyongpark.github.io/>RyanLabs</a></span> Â·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>