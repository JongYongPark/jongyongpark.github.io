<!doctype html><html lang=ko dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Coverity API SSL Issue | RyanLabs</title>
<meta name=keywords content="Coverity,API,SSL"><meta name=description content='Blackduck API 호출 시 발생하는 SSL 인증서 문제를 해결하는 Java 코드 - disable SSL
Blackduck API 호출 시 발생하는 SSL 인증서 문제를 해결하는 Java 코드를 작성해드리겠습니다:
import javax.net.ssl.*;
import java.io.*;
import java.net.HttpURLConnection;
import java.net.URL;
import java.security.cert.X509Certificate;
import java.nio.charset.StandardCharsets;

public class BlackDuckApiClient {
    
    private static void disableSSLVerification() {
        try {
            TrustManager[] trustAllCerts = new TrustManager[] {
                new X509TrustManager() {
                    public X509Certificate[] getAcceptedIssuers() { return null; }
                    public void checkClientTrusted(X509Certificate[] certs, String authType) { }
                    public void checkServerTrusted(X509Certificate[] certs, String authType) { }
                }
            };

            SSLContext sc = SSLContext.getInstance("SSL");
            sc.init(null, trustAllCerts, new java.security.SecureRandom());
            HttpsURLConnection.setDefaultSSLSocketFactory(sc.getSocketFactory());
            
            HostnameVerifier allHostsValid = (hostname, session) -> true;
            HttpsURLConnection.setDefaultHostnameVerifier(allHostsValid);
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    public static String authenticate(String baseUrl, String username, String password) {
        try {
            URL url = new URL(baseUrl + "/api/tokens/authenticate");
            HttpURLConnection conn = (HttpURLConnection) url.openConnection();
            
            // 요청 설정
            conn.setRequestMethod("POST");
            conn.setRequestProperty("Accept", "application/vnd.blackducksoftware.user-4+json");
            conn.setRequestProperty("Content-Type", "application/json");
            
            // Basic Auth 설정
            String auth = username + ":" + password;
            String encodedAuth = java.util.Base64.getEncoder().encodeToString(auth.getBytes());
            conn.setRequestProperty("Authorization", "Basic " + encodedAuth);
            
            conn.setDoOutput(true);
            
            // 응답 읽기
            int responseCode = conn.getResponseCode();
            if (responseCode == HttpURLConnection.HTTP_OK) {
                BufferedReader in = new BufferedReader(
                    new InputStreamReader(conn.getInputStream(), StandardCharsets.UTF_8));
                String inputLine;
                StringBuilder response = new StringBuilder();
                
                while ((inputLine = in.readLine()) != null) {
                    response.append(inputLine);
                }
                in.close();
                
                return response.toString();
            } else {
                System.out.println("Response Code: " + responseCode);
                return null;
            }
        } catch (Exception e) {
            e.printStackTrace();
            return null;
        }
    }

    public static void main(String[] args) {
        // SSL 검증 비활성화
        disableSSLVerification();
        
        String baseUrl = "https://your-blackduck-server";
        String username = "your-username";
        String password = "your-password";
        
        String response = authenticate(baseUrl, username, password);
        System.out.println("Response: " + response);
    }
}
안전한 운영 환경을 위한 인증서 설정 방법:'><meta name=author content><link rel=canonical href=https://jongyongpark.github.io/posts/technical-support/coverity/cov-api-ssl/><link crossorigin=anonymous href=/assets/css/stylesheet.9de45e225101e4f99701d2b68fc6b8a1ef6027928be6391fa15bf7f56326c909.css integrity="sha256-neReIlEB5PmXAdK2j8a4oe9gJ5KL5jkfoVv39WMmyQk=" rel="preload stylesheet" as=style><link rel=icon href=https://jongyongpark.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://jongyongpark.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://jongyongpark.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://jongyongpark.github.io/apple-touch-icon.png><link rel=mask-icon href=https://jongyongpark.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=ko href=https://jongyongpark.github.io/posts/technical-support/coverity/cov-api-ssl/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://jongyongpark.github.io/posts/technical-support/coverity/cov-api-ssl/"><meta property="og:site_name" content="RyanLabs"><meta property="og:title" content="Coverity API SSL Issue"><meta property="og:description" content='Blackduck API 호출 시 발생하는 SSL 인증서 문제를 해결하는 Java 코드 - disable SSL Blackduck API 호출 시 발생하는 SSL 인증서 문제를 해결하는 Java 코드를 작성해드리겠습니다:
import javax.net.ssl.*; import java.io.*; import java.net.HttpURLConnection; import java.net.URL; import java.security.cert.X509Certificate; import java.nio.charset.StandardCharsets; public class BlackDuckApiClient { private static void disableSSLVerification() { try { TrustManager[] trustAllCerts = new TrustManager[] { new X509TrustManager() { public X509Certificate[] getAcceptedIssuers() { return null; } public void checkClientTrusted(X509Certificate[] certs, String authType) { } public void checkServerTrusted(X509Certificate[] certs, String authType) { } } }; SSLContext sc = SSLContext.getInstance("SSL"); sc.init(null, trustAllCerts, new java.security.SecureRandom()); HttpsURLConnection.setDefaultSSLSocketFactory(sc.getSocketFactory()); HostnameVerifier allHostsValid = (hostname, session) -> true; HttpsURLConnection.setDefaultHostnameVerifier(allHostsValid); } catch (Exception e) { e.printStackTrace(); } } public static String authenticate(String baseUrl, String username, String password) { try { URL url = new URL(baseUrl + "/api/tokens/authenticate"); HttpURLConnection conn = (HttpURLConnection) url.openConnection(); // 요청 설정 conn.setRequestMethod("POST"); conn.setRequestProperty("Accept", "application/vnd.blackducksoftware.user-4+json"); conn.setRequestProperty("Content-Type", "application/json"); // Basic Auth 설정 String auth = username + ":" + password; String encodedAuth = java.util.Base64.getEncoder().encodeToString(auth.getBytes()); conn.setRequestProperty("Authorization", "Basic " + encodedAuth); conn.setDoOutput(true); // 응답 읽기 int responseCode = conn.getResponseCode(); if (responseCode == HttpURLConnection.HTTP_OK) { BufferedReader in = new BufferedReader( new InputStreamReader(conn.getInputStream(), StandardCharsets.UTF_8)); String inputLine; StringBuilder response = new StringBuilder(); while ((inputLine = in.readLine()) != null) { response.append(inputLine); } in.close(); return response.toString(); } else { System.out.println("Response Code: " + responseCode); return null; } } catch (Exception e) { e.printStackTrace(); return null; } } public static void main(String[] args) { // SSL 검증 비활성화 disableSSLVerification(); String baseUrl = "https://your-blackduck-server"; String username = "your-username"; String password = "your-password"; String response = authenticate(baseUrl, username, password); System.out.println("Response: " + response); } } 안전한 운영 환경을 위한 인증서 설정 방법:'><meta property="og:locale" content="ko"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-02-24T00:00:00+00:00"><meta property="article:modified_time" content="2025-02-24T00:00:00+00:00"><meta property="article:tag" content="Coverity"><meta property="article:tag" content="API"><meta property="article:tag" content="SSL"><meta name=twitter:card content="summary"><meta name=twitter:title content="Coverity API SSL Issue"><meta name=twitter:description content='Blackduck API 호출 시 발생하는 SSL 인증서 문제를 해결하는 Java 코드 - disable SSL
Blackduck API 호출 시 발생하는 SSL 인증서 문제를 해결하는 Java 코드를 작성해드리겠습니다:
import javax.net.ssl.*;
import java.io.*;
import java.net.HttpURLConnection;
import java.net.URL;
import java.security.cert.X509Certificate;
import java.nio.charset.StandardCharsets;

public class BlackDuckApiClient {
    
    private static void disableSSLVerification() {
        try {
            TrustManager[] trustAllCerts = new TrustManager[] {
                new X509TrustManager() {
                    public X509Certificate[] getAcceptedIssuers() { return null; }
                    public void checkClientTrusted(X509Certificate[] certs, String authType) { }
                    public void checkServerTrusted(X509Certificate[] certs, String authType) { }
                }
            };

            SSLContext sc = SSLContext.getInstance("SSL");
            sc.init(null, trustAllCerts, new java.security.SecureRandom());
            HttpsURLConnection.setDefaultSSLSocketFactory(sc.getSocketFactory());
            
            HostnameVerifier allHostsValid = (hostname, session) -> true;
            HttpsURLConnection.setDefaultHostnameVerifier(allHostsValid);
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    public static String authenticate(String baseUrl, String username, String password) {
        try {
            URL url = new URL(baseUrl + "/api/tokens/authenticate");
            HttpURLConnection conn = (HttpURLConnection) url.openConnection();
            
            // 요청 설정
            conn.setRequestMethod("POST");
            conn.setRequestProperty("Accept", "application/vnd.blackducksoftware.user-4+json");
            conn.setRequestProperty("Content-Type", "application/json");
            
            // Basic Auth 설정
            String auth = username + ":" + password;
            String encodedAuth = java.util.Base64.getEncoder().encodeToString(auth.getBytes());
            conn.setRequestProperty("Authorization", "Basic " + encodedAuth);
            
            conn.setDoOutput(true);
            
            // 응답 읽기
            int responseCode = conn.getResponseCode();
            if (responseCode == HttpURLConnection.HTTP_OK) {
                BufferedReader in = new BufferedReader(
                    new InputStreamReader(conn.getInputStream(), StandardCharsets.UTF_8));
                String inputLine;
                StringBuilder response = new StringBuilder();
                
                while ((inputLine = in.readLine()) != null) {
                    response.append(inputLine);
                }
                in.close();
                
                return response.toString();
            } else {
                System.out.println("Response Code: " + responseCode);
                return null;
            }
        } catch (Exception e) {
            e.printStackTrace();
            return null;
        }
    }

    public static void main(String[] args) {
        // SSL 검증 비활성화
        disableSSLVerification();
        
        String baseUrl = "https://your-blackduck-server";
        String username = "your-username";
        String password = "your-password";
        
        String response = authenticate(baseUrl, username, password);
        System.out.println("Response: " + response);
    }
}
안전한 운영 환경을 위한 인증서 설정 방법:'><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://jongyongpark.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Coverity API SSL Issue","item":"https://jongyongpark.github.io/posts/technical-support/coverity/cov-api-ssl/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Coverity API SSL Issue","name":"Coverity API SSL Issue","description":"Blackduck API 호출 시 발생하는 SSL 인증서 문제를 해결하는 Java 코드 - disable SSL Blackduck API 호출 시 발생하는 SSL 인증서 문제를 해결하는 Java 코드를 작성해드리겠습니다:\nimport javax.net.ssl.*; import java.io.*; import java.net.HttpURLConnection; import java.net.URL; import java.security.cert.X509Certificate; import java.nio.charset.StandardCharsets; public class BlackDuckApiClient { private static void disableSSLVerification() { try { TrustManager[] trustAllCerts = new TrustManager[] { new X509TrustManager() { public X509Certificate[] getAcceptedIssuers() { return null; } public void checkClientTrusted(X509Certificate[] certs, String authType) { } public void checkServerTrusted(X509Certificate[] certs, String authType) { } } }; SSLContext sc = SSLContext.getInstance(\u0026#34;SSL\u0026#34;); sc.init(null, trustAllCerts, new java.security.SecureRandom()); HttpsURLConnection.setDefaultSSLSocketFactory(sc.getSocketFactory()); HostnameVerifier allHostsValid = (hostname, session) -\u0026gt; true; HttpsURLConnection.setDefaultHostnameVerifier(allHostsValid); } catch (Exception e) { e.printStackTrace(); } } public static String authenticate(String baseUrl, String username, String password) { try { URL url = new URL(baseUrl + \u0026#34;/api/tokens/authenticate\u0026#34;); HttpURLConnection conn = (HttpURLConnection) url.openConnection(); // 요청 설정 conn.setRequestMethod(\u0026#34;POST\u0026#34;); conn.setRequestProperty(\u0026#34;Accept\u0026#34;, \u0026#34;application/vnd.blackducksoftware.user-4+json\u0026#34;); conn.setRequestProperty(\u0026#34;Content-Type\u0026#34;, \u0026#34;application/json\u0026#34;); // Basic Auth 설정 String auth = username + \u0026#34;:\u0026#34; + password; String encodedAuth = java.util.Base64.getEncoder().encodeToString(auth.getBytes()); conn.setRequestProperty(\u0026#34;Authorization\u0026#34;, \u0026#34;Basic \u0026#34; + encodedAuth); conn.setDoOutput(true); // 응답 읽기 int responseCode = conn.getResponseCode(); if (responseCode == HttpURLConnection.HTTP_OK) { BufferedReader in = new BufferedReader( new InputStreamReader(conn.getInputStream(), StandardCharsets.UTF_8)); String inputLine; StringBuilder response = new StringBuilder(); while ((inputLine = in.readLine()) != null) { response.append(inputLine); } in.close(); return response.toString(); } else { System.out.println(\u0026#34;Response Code: \u0026#34; + responseCode); return null; } } catch (Exception e) { e.printStackTrace(); return null; } } public static void main(String[] args) { // SSL 검증 비활성화 disableSSLVerification(); String baseUrl = \u0026#34;https://your-blackduck-server\u0026#34;; String username = \u0026#34;your-username\u0026#34;; String password = \u0026#34;your-password\u0026#34;; String response = authenticate(baseUrl, username, password); System.out.println(\u0026#34;Response: \u0026#34; + response); } } 안전한 운영 환경을 위한 인증서 설정 방법:\n","keywords":["Coverity","API","SSL"],"articleBody":"Blackduck API 호출 시 발생하는 SSL 인증서 문제를 해결하는 Java 코드 - disable SSL Blackduck API 호출 시 발생하는 SSL 인증서 문제를 해결하는 Java 코드를 작성해드리겠습니다:\nimport javax.net.ssl.*; import java.io.*; import java.net.HttpURLConnection; import java.net.URL; import java.security.cert.X509Certificate; import java.nio.charset.StandardCharsets; public class BlackDuckApiClient { private static void disableSSLVerification() { try { TrustManager[] trustAllCerts = new TrustManager[] { new X509TrustManager() { public X509Certificate[] getAcceptedIssuers() { return null; } public void checkClientTrusted(X509Certificate[] certs, String authType) { } public void checkServerTrusted(X509Certificate[] certs, String authType) { } } }; SSLContext sc = SSLContext.getInstance(\"SSL\"); sc.init(null, trustAllCerts, new java.security.SecureRandom()); HttpsURLConnection.setDefaultSSLSocketFactory(sc.getSocketFactory()); HostnameVerifier allHostsValid = (hostname, session) -\u003e true; HttpsURLConnection.setDefaultHostnameVerifier(allHostsValid); } catch (Exception e) { e.printStackTrace(); } } public static String authenticate(String baseUrl, String username, String password) { try { URL url = new URL(baseUrl + \"/api/tokens/authenticate\"); HttpURLConnection conn = (HttpURLConnection) url.openConnection(); // 요청 설정 conn.setRequestMethod(\"POST\"); conn.setRequestProperty(\"Accept\", \"application/vnd.blackducksoftware.user-4+json\"); conn.setRequestProperty(\"Content-Type\", \"application/json\"); // Basic Auth 설정 String auth = username + \":\" + password; String encodedAuth = java.util.Base64.getEncoder().encodeToString(auth.getBytes()); conn.setRequestProperty(\"Authorization\", \"Basic \" + encodedAuth); conn.setDoOutput(true); // 응답 읽기 int responseCode = conn.getResponseCode(); if (responseCode == HttpURLConnection.HTTP_OK) { BufferedReader in = new BufferedReader( new InputStreamReader(conn.getInputStream(), StandardCharsets.UTF_8)); String inputLine; StringBuilder response = new StringBuilder(); while ((inputLine = in.readLine()) != null) { response.append(inputLine); } in.close(); return response.toString(); } else { System.out.println(\"Response Code: \" + responseCode); return null; } } catch (Exception e) { e.printStackTrace(); return null; } } public static void main(String[] args) { // SSL 검증 비활성화 disableSSLVerification(); String baseUrl = \"https://your-blackduck-server\"; String username = \"your-username\"; String password = \"your-password\"; String response = authenticate(baseUrl, username, password); System.out.println(\"Response: \" + response); } } 안전한 운영 환경을 위한 인증서 설정 방법:\nBlackduck 서버의 인증서 내보내기: # 브라우저에서 인증서 내보내기 또는 관리자로부터 인증서 파일(.cer) 받기 Java 키스토어에 인증서 추가: # JVM의 cacerts에 인증서 추가 keytool -import -alias blackduck -file blackduck.cer -keystore \"$JAVA_HOME/lib/security/cacerts\" -storepass changeit Java 코드에서 키스토어 설정: System.setProperty(\"javax.net.ssl.trustStore\", \"path/to/cacerts\"); System.setProperty(\"javax.net.ssl.trustStorePassword\", \"changeit\"); 주의사항:\n운영 환경에서는 disableSSLVerification() 메소드 사용을 피하고 인증서를 올바르게 설정하세요 실제 구현 시 username과 password는 설정 파일이나 환경 변수로 관리하세요 API 응답의 에러 처리를 추가하세요 연결과 스트림은 반드시 닫아주세요 이 코드는 Blackduck API의 인증 토큰을 얻는 기본적인 구현입니다. 실제 사용 시에는 보안 요구사항과 환경에 맞게 수정이 필요할 수 있습니다.\nBlackduck API 호출 시 발생하는 SSL 인증서 문제를 해결하는 Java 코드 - save cert into trust store 네, SSL 인증서를 안전하게 처리하는 BlackDuck API 클라이언트 코드를 작성해드리겠습니다:\nimport javax.net.ssl.*; import java.io.*; import java.net.URL; import java.security.KeyStore; import java.security.cert.CertificateException; import java.security.cert.X509Certificate; import java.nio.charset.StandardCharsets; import java.util.Base64; public class SecureBlackDuckApiClient { private final String baseUrl; private final String trustStorePath; private final String trustStorePassword; private KeyStore trustStore; public SecureBlackDuckApiClient(String baseUrl, String trustStorePath, String trustStorePassword) { this.baseUrl = baseUrl; this.trustStorePath = trustStorePath; this.trustStorePassword = trustStorePassword; initializeTrustStore(); } private void initializeTrustStore() { try { trustStore = KeyStore.getInstance(KeyStore.getDefaultType()); File trustStoreFile = new File(trustStorePath); if (trustStoreFile.exists()) { // 기존 트러스트 스토어 로드 try (FileInputStream fis = new FileInputStream(trustStoreFile)) { trustStore.load(fis, trustStorePassword.toCharArray()); } } else { // 새로운 트러스트 스토어 생성 trustStore.load(null, trustStorePassword.toCharArray()); } } catch (Exception e) { throw new RuntimeException(\"Trust store initialization failed\", e); } } private void saveCertificateToTrustStore(X509Certificate cert, String alias) throws Exception { trustStore.setCertificateEntry(alias, cert); try (FileOutputStream fos = new FileOutputStream(trustStorePath)) { trustStore.store(fos, trustStorePassword.toCharArray()); } } private X509Certificate[] getServerCertificates(String hostname, int port) throws Exception { SSLContext context = SSLContext.getInstance(\"TLS\"); X509TrustManager trustManager = new X509TrustManager() { public X509Certificate[] getAcceptedIssuers() { return new X509Certificate[0]; } public void checkClientTrusted(X509Certificate[] chain, String authType) throws CertificateException { } public void checkServerTrusted(X509Certificate[] chain, String authType) throws CertificateException { serverCertificateChain = chain; } }; context.init(null, new TrustManager[]{trustManager}, null); SSLSocketFactory factory = context.getSocketFactory(); try (SSLSocket socket = (SSLSocket) factory.createSocket(hostname, port)) { socket.startHandshake(); return serverCertificateChain; } } private transient X509Certificate[] serverCertificateChain; private void setupSSLContext() throws Exception { // 서버 URL에서 호스트와 포트 추출 URL url = new URL(baseUrl); String hostname = url.getHost(); int port = url.getPort() != -1 ? url.getPort() : 443; // 서버 인증서 가져오기 X509Certificate[] certificates = getServerCertificates(hostname, port); // 인증서를 트러스트 스토어에 저장 for (int i = 0; i \u003c certificates.length; i++) { String alias = hostname + \"-cert-\" + i; saveCertificateToTrustStore(certificates[i], alias); } // SSL 컨텍스트 설정 TrustManagerFactory tmf = TrustManagerFactory.getInstance(TrustManagerFactory.getDefaultAlgorithm()); tmf.init(trustStore); SSLContext sslContext = SSLContext.getInstance(\"TLS\"); sslContext.init(null, tmf.getTrustManagers(), null); HttpsURLConnection.setDefaultSSLSocketFactory(sslContext.getSocketFactory()); } public String authenticate(String username, String password) throws Exception { // SSL 컨텍스트 설정 setupSSLContext(); // API 요청 URL url = new URL(baseUrl + \"/api/tokens/authenticate\"); HttpsURLConnection conn = (HttpsURLConnection) url.openConnection(); try { // 요청 설정 conn.setRequestMethod(\"POST\"); conn.setRequestProperty(\"Accept\", \"application/vnd.blackducksoftware.user-4+json\"); conn.setRequestProperty(\"Content-Type\", \"application/json\"); // Basic Auth 설정 String auth = username + \":\" + password; String encodedAuth = Base64.getEncoder().encodeToString(auth.getBytes(StandardCharsets.UTF_8)); conn.setRequestProperty(\"Authorization\", \"Basic \" + encodedAuth); conn.setDoOutput(true); // 응답 처리 try (BufferedReader br = new BufferedReader( new InputStreamReader(conn.getInputStream(), StandardCharsets.UTF_8))) { StringBuilder response = new StringBuilder(); String line; while ((line = br.readLine()) != null) { response.append(line); } return response.toString(); } } finally { conn.disconnect(); } } public static void main(String[] args) { try { String baseUrl = \"https://your-blackduck-server\"; String trustStorePath = \"path/to/truststore.jks\"; String trustStorePassword = \"your-truststore-password\"; SecureBlackDuckApiClient client = new SecureBlackDuckApiClient( baseUrl, trustStorePath, trustStorePassword); String response = client.authenticate(\"username\", \"password\"); System.out.println(\"Authentication Response: \" + response); } catch (Exception e) { e.printStackTrace(); } } } 이 코드의 주요 특징:\n자동으로 서버 인증서를 가져와서 신뢰할 수 있는 저장소에 저장합니다. 저장된 인증서를 사용하여 안전한 HTTPS 연결을 설정합니다. 트러스트 스토어를 파일로 관리하여 재사용할 수 있습니다. 사용 방법:\n// 클라이언트 생성 SecureBlackDuckApiClient client = new SecureBlackDuckApiClient( \"https://your-blackduck-server\", \"/path/to/truststore.jks\", \"truststore-password\" ); // API 호출 String response = client.authenticate(\"username\", \"password\"); 주의사항:\n실제 사용 시 비밀번호와 민감한 정보는 설정 파일이나 환경 변수로 관리하세요. 예외 처리를 더 세밀하게 구현하세요. 트러스트 스토어 파일의 권한 설정에 주의하세요. 정기적으로 인증서를 갱신하는 로직을 추가하세요. ","wordCount":"896","inLanguage":"ko","datePublished":"2025-02-24T00:00:00Z","dateModified":"2025-02-24T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://jongyongpark.github.io/posts/technical-support/coverity/cov-api-ssl/"},"publisher":{"@type":"Organization","name":"RyanLabs","logo":{"@type":"ImageObject","url":"https://jongyongpark.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://jongyongpark.github.io/ accesskey=h title="RyanLabs (Alt + H)">RyanLabs</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://jongyongpark.github.io/search/ title=검색><span>검색</span></a></li><li><a href=https://jongyongpark.github.io/categories/ title=카테고리><span>카테고리</span></a></li><li><a href=https://jongyongpark.github.io/tags/ title=태그><span>태그</span></a></li><li><a href=https://jongyongpark.github.io/archives/ title=연도><span>연도</span></a></li><li><a href=https://jongyongpark.github.io/lectures/ title=강의><span>강의</span></a></li><li><a href=https://jongyongpark.github.io/about/ title=어바웃미><span>어바웃미</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Coverity API SSL Issue</h1><div class=post-meta><span title='2025-02-24 00:00:00 +0000 UTC'>2월 24, 2025</span></div></header><div class=post-content><h1 id=blackduck-api-호출-시-발생하는-ssl-인증서-문제를-해결하는-java-코드---disable-ssl>Blackduck API 호출 시 발생하는 SSL 인증서 문제를 해결하는 Java 코드 - disable SSL<a hidden class=anchor aria-hidden=true href=#blackduck-api-호출-시-발생하는-ssl-인증서-문제를-해결하는-java-코드---disable-ssl>#</a></h1><p>Blackduck API 호출 시 발생하는 SSL 인증서 문제를 해결하는 Java 코드를 작성해드리겠습니다:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>import</span> javax.net.ssl.*;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> java.io.*;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> java.net.HttpURLConnection;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> java.net.URL;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> java.security.cert.X509Certificate;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> java.nio.charset.StandardCharsets;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>BlackDuckApiClient</span> {
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>disableSSLVerification</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>            TrustManager<span style=color:#f92672>[]</span> trustAllCerts <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> TrustManager<span style=color:#f92672>[]</span> {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>new</span> X509TrustManager() {
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>public</span> X509Certificate<span style=color:#f92672>[]</span> <span style=color:#a6e22e>getAcceptedIssuers</span>() { <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>null</span>; }
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>checkClientTrusted</span>(X509Certificate<span style=color:#f92672>[]</span> certs, String authType) { }
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>checkServerTrusted</span>(X509Certificate<span style=color:#f92672>[]</span> certs, String authType) { }
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>            };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            SSLContext sc <span style=color:#f92672>=</span> SSLContext.<span style=color:#a6e22e>getInstance</span>(<span style=color:#e6db74>&#34;SSL&#34;</span>);
</span></span><span style=display:flex><span>            sc.<span style=color:#a6e22e>init</span>(<span style=color:#66d9ef>null</span>, trustAllCerts, <span style=color:#66d9ef>new</span> java.<span style=color:#a6e22e>security</span>.<span style=color:#a6e22e>SecureRandom</span>());
</span></span><span style=display:flex><span>            HttpsURLConnection.<span style=color:#a6e22e>setDefaultSSLSocketFactory</span>(sc.<span style=color:#a6e22e>getSocketFactory</span>());
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            HostnameVerifier allHostsValid <span style=color:#f92672>=</span> (hostname, session) <span style=color:#f92672>-&gt;</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>            HttpsURLConnection.<span style=color:#a6e22e>setDefaultHostnameVerifier</span>(allHostsValid);
</span></span><span style=display:flex><span>        } <span style=color:#66d9ef>catch</span> (Exception e) {
</span></span><span style=display:flex><span>            e.<span style=color:#a6e22e>printStackTrace</span>();
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> String <span style=color:#a6e22e>authenticate</span>(String baseUrl, String username, String password) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>            URL url <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> URL(baseUrl <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;/api/tokens/authenticate&#34;</span>);
</span></span><span style=display:flex><span>            HttpURLConnection conn <span style=color:#f92672>=</span> (HttpURLConnection) url.<span style=color:#a6e22e>openConnection</span>();
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#75715e>// 요청 설정</span>
</span></span><span style=display:flex><span>            conn.<span style=color:#a6e22e>setRequestMethod</span>(<span style=color:#e6db74>&#34;POST&#34;</span>);
</span></span><span style=display:flex><span>            conn.<span style=color:#a6e22e>setRequestProperty</span>(<span style=color:#e6db74>&#34;Accept&#34;</span>, <span style=color:#e6db74>&#34;application/vnd.blackducksoftware.user-4+json&#34;</span>);
</span></span><span style=display:flex><span>            conn.<span style=color:#a6e22e>setRequestProperty</span>(<span style=color:#e6db74>&#34;Content-Type&#34;</span>, <span style=color:#e6db74>&#34;application/json&#34;</span>);
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#75715e>// Basic Auth 설정</span>
</span></span><span style=display:flex><span>            String auth <span style=color:#f92672>=</span> username <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;:&#34;</span> <span style=color:#f92672>+</span> password;
</span></span><span style=display:flex><span>            String encodedAuth <span style=color:#f92672>=</span> java.<span style=color:#a6e22e>util</span>.<span style=color:#a6e22e>Base64</span>.<span style=color:#a6e22e>getEncoder</span>().<span style=color:#a6e22e>encodeToString</span>(auth.<span style=color:#a6e22e>getBytes</span>());
</span></span><span style=display:flex><span>            conn.<span style=color:#a6e22e>setRequestProperty</span>(<span style=color:#e6db74>&#34;Authorization&#34;</span>, <span style=color:#e6db74>&#34;Basic &#34;</span> <span style=color:#f92672>+</span> encodedAuth);
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            conn.<span style=color:#a6e22e>setDoOutput</span>(<span style=color:#66d9ef>true</span>);
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#75715e>// 응답 읽기</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>int</span> responseCode <span style=color:#f92672>=</span> conn.<span style=color:#a6e22e>getResponseCode</span>();
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (responseCode <span style=color:#f92672>==</span> HttpURLConnection.<span style=color:#a6e22e>HTTP_OK</span>) {
</span></span><span style=display:flex><span>                BufferedReader in <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> BufferedReader(
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>new</span> InputStreamReader(conn.<span style=color:#a6e22e>getInputStream</span>(), StandardCharsets.<span style=color:#a6e22e>UTF_8</span>));
</span></span><span style=display:flex><span>                String inputLine;
</span></span><span style=display:flex><span>                StringBuilder response <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> StringBuilder();
</span></span><span style=display:flex><span>                
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>while</span> ((inputLine <span style=color:#f92672>=</span> in.<span style=color:#a6e22e>readLine</span>()) <span style=color:#f92672>!=</span> <span style=color:#66d9ef>null</span>) {
</span></span><span style=display:flex><span>                    response.<span style=color:#a6e22e>append</span>(inputLine);
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>                in.<span style=color:#a6e22e>close</span>();
</span></span><span style=display:flex><span>                
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>return</span> response.<span style=color:#a6e22e>toString</span>();
</span></span><span style=display:flex><span>            } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>                System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;Response Code: &#34;</span> <span style=color:#f92672>+</span> responseCode);
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>null</span>;
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        } <span style=color:#66d9ef>catch</span> (Exception e) {
</span></span><span style=display:flex><span>            e.<span style=color:#a6e22e>printStackTrace</span>();
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>null</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>main</span>(String<span style=color:#f92672>[]</span> args) {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// SSL 검증 비활성화</span>
</span></span><span style=display:flex><span>        disableSSLVerification();
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        String baseUrl <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;https://your-blackduck-server&#34;</span>;
</span></span><span style=display:flex><span>        String username <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;your-username&#34;</span>;
</span></span><span style=display:flex><span>        String password <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;your-password&#34;</span>;
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        String response <span style=color:#f92672>=</span> authenticate(baseUrl, username, password);
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;Response: &#34;</span> <span style=color:#f92672>+</span> response);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>안전한 운영 환경을 위한 인증서 설정 방법:</p><ol><li>Blackduck 서버의 인증서 내보내기:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># 브라우저에서 인증서 내보내기 또는 관리자로부터 인증서 파일(.cer) 받기</span>
</span></span></code></pre></div><ol><li>Java 키스토어에 인증서 추가:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># JVM의 cacerts에 인증서 추가</span>
</span></span><span style=display:flex><span>keytool -import -alias blackduck -file blackduck.cer -keystore <span style=color:#e6db74>&#34;</span>$JAVA_HOME<span style=color:#e6db74>/lib/security/cacerts&#34;</span> -storepass changeit
</span></span></code></pre></div><ol><li>Java 코드에서 키스토어 설정:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>System.<span style=color:#a6e22e>setProperty</span>(<span style=color:#e6db74>&#34;javax.net.ssl.trustStore&#34;</span>, <span style=color:#e6db74>&#34;path/to/cacerts&#34;</span>);
</span></span><span style=display:flex><span>System.<span style=color:#a6e22e>setProperty</span>(<span style=color:#e6db74>&#34;javax.net.ssl.trustStorePassword&#34;</span>, <span style=color:#e6db74>&#34;changeit&#34;</span>);
</span></span></code></pre></div><p>주의사항:</p><ul><li>운영 환경에서는 <code>disableSSLVerification()</code> 메소드 사용을 피하고 인증서를 올바르게 설정하세요</li><li>실제 구현 시 username과 password는 설정 파일이나 환경 변수로 관리하세요</li><li>API 응답의 에러 처리를 추가하세요</li><li>연결과 스트림은 반드시 닫아주세요</li></ul><p>이 코드는 Blackduck API의 인증 토큰을 얻는 기본적인 구현입니다. 실제 사용 시에는 보안 요구사항과 환경에 맞게 수정이 필요할 수 있습니다.</p><h1 id=blackduck-api-호출-시-발생하는-ssl-인증서-문제를-해결하는-java-코드---save-cert-into-trust-store>Blackduck API 호출 시 발생하는 SSL 인증서 문제를 해결하는 Java 코드 - save cert into trust store<a hidden class=anchor aria-hidden=true href=#blackduck-api-호출-시-발생하는-ssl-인증서-문제를-해결하는-java-코드---save-cert-into-trust-store>#</a></h1><p>네, SSL 인증서를 안전하게 처리하는 BlackDuck API 클라이언트 코드를 작성해드리겠습니다:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>import</span> javax.net.ssl.*;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> java.io.*;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> java.net.URL;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> java.security.KeyStore;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> java.security.cert.CertificateException;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> java.security.cert.X509Certificate;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> java.nio.charset.StandardCharsets;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> java.util.Base64;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>SecureBlackDuckApiClient</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>final</span> String baseUrl;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>final</span> String trustStorePath;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>final</span> String trustStorePassword;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> KeyStore trustStore;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>SecureBlackDuckApiClient</span>(String baseUrl, String trustStorePath, String trustStorePassword) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>baseUrl</span> <span style=color:#f92672>=</span> baseUrl;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>trustStorePath</span> <span style=color:#f92672>=</span> trustStorePath;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>trustStorePassword</span> <span style=color:#f92672>=</span> trustStorePassword;
</span></span><span style=display:flex><span>        initializeTrustStore();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>initializeTrustStore</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>            trustStore <span style=color:#f92672>=</span> KeyStore.<span style=color:#a6e22e>getInstance</span>(KeyStore.<span style=color:#a6e22e>getDefaultType</span>());
</span></span><span style=display:flex><span>            File trustStoreFile <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> File(trustStorePath);
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (trustStoreFile.<span style=color:#a6e22e>exists</span>()) {
</span></span><span style=display:flex><span>                <span style=color:#75715e>// 기존 트러스트 스토어 로드</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>try</span> (FileInputStream fis <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> FileInputStream(trustStoreFile)) {
</span></span><span style=display:flex><span>                    trustStore.<span style=color:#a6e22e>load</span>(fis, trustStorePassword.<span style=color:#a6e22e>toCharArray</span>());
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>            } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>                <span style=color:#75715e>// 새로운 트러스트 스토어 생성</span>
</span></span><span style=display:flex><span>                trustStore.<span style=color:#a6e22e>load</span>(<span style=color:#66d9ef>null</span>, trustStorePassword.<span style=color:#a6e22e>toCharArray</span>());
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        } <span style=color:#66d9ef>catch</span> (Exception e) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> RuntimeException(<span style=color:#e6db74>&#34;Trust store initialization failed&#34;</span>, e);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>saveCertificateToTrustStore</span>(X509Certificate cert, String alias) <span style=color:#66d9ef>throws</span> Exception {
</span></span><span style=display:flex><span>        trustStore.<span style=color:#a6e22e>setCertificateEntry</span>(alias, cert);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>try</span> (FileOutputStream fos <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> FileOutputStream(trustStorePath)) {
</span></span><span style=display:flex><span>            trustStore.<span style=color:#a6e22e>store</span>(fos, trustStorePassword.<span style=color:#a6e22e>toCharArray</span>());
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> X509Certificate<span style=color:#f92672>[]</span> <span style=color:#a6e22e>getServerCertificates</span>(String hostname, <span style=color:#66d9ef>int</span> port) <span style=color:#66d9ef>throws</span> Exception {
</span></span><span style=display:flex><span>        SSLContext context <span style=color:#f92672>=</span> SSLContext.<span style=color:#a6e22e>getInstance</span>(<span style=color:#e6db74>&#34;TLS&#34;</span>);
</span></span><span style=display:flex><span>        X509TrustManager trustManager <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> X509TrustManager() {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>public</span> X509Certificate<span style=color:#f92672>[]</span> <span style=color:#a6e22e>getAcceptedIssuers</span>() { <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>new</span> X509Certificate<span style=color:#f92672>[</span>0<span style=color:#f92672>]</span>; }
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>checkClientTrusted</span>(X509Certificate<span style=color:#f92672>[]</span> chain, String authType) <span style=color:#66d9ef>throws</span> CertificateException { }
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>checkServerTrusted</span>(X509Certificate<span style=color:#f92672>[]</span> chain, String authType) <span style=color:#66d9ef>throws</span> CertificateException {
</span></span><span style=display:flex><span>                serverCertificateChain <span style=color:#f92672>=</span> chain;
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        };
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        context.<span style=color:#a6e22e>init</span>(<span style=color:#66d9ef>null</span>, <span style=color:#66d9ef>new</span> TrustManager<span style=color:#f92672>[]</span>{trustManager}, <span style=color:#66d9ef>null</span>);
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        SSLSocketFactory factory <span style=color:#f92672>=</span> context.<span style=color:#a6e22e>getSocketFactory</span>();
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>try</span> (SSLSocket socket <span style=color:#f92672>=</span> (SSLSocket) factory.<span style=color:#a6e22e>createSocket</span>(hostname, port)) {
</span></span><span style=display:flex><span>            socket.<span style=color:#a6e22e>startHandshake</span>();
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> serverCertificateChain;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>transient</span> X509Certificate<span style=color:#f92672>[]</span> serverCertificateChain;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>setupSSLContext</span>() <span style=color:#66d9ef>throws</span> Exception {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 서버 URL에서 호스트와 포트 추출</span>
</span></span><span style=display:flex><span>        URL url <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> URL(baseUrl);
</span></span><span style=display:flex><span>        String hostname <span style=color:#f92672>=</span> url.<span style=color:#a6e22e>getHost</span>();
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> port <span style=color:#f92672>=</span> url.<span style=color:#a6e22e>getPort</span>() <span style=color:#f92672>!=</span> <span style=color:#f92672>-</span>1 <span style=color:#f92672>?</span> url.<span style=color:#a6e22e>getPort</span>() : 443;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 서버 인증서 가져오기</span>
</span></span><span style=display:flex><span>        X509Certificate<span style=color:#f92672>[]</span> certificates <span style=color:#f92672>=</span> getServerCertificates(hostname, port);
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 인증서를 트러스트 스토어에 저장</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> 0; i <span style=color:#f92672>&lt;</span> certificates.<span style=color:#a6e22e>length</span>; i<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>            String alias <span style=color:#f92672>=</span> hostname <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;-cert-&#34;</span> <span style=color:#f92672>+</span> i;
</span></span><span style=display:flex><span>            saveCertificateToTrustStore(certificates<span style=color:#f92672>[</span>i<span style=color:#f92672>]</span>, alias);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// SSL 컨텍스트 설정</span>
</span></span><span style=display:flex><span>        TrustManagerFactory tmf <span style=color:#f92672>=</span> TrustManagerFactory.<span style=color:#a6e22e>getInstance</span>(TrustManagerFactory.<span style=color:#a6e22e>getDefaultAlgorithm</span>());
</span></span><span style=display:flex><span>        tmf.<span style=color:#a6e22e>init</span>(trustStore);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        SSLContext sslContext <span style=color:#f92672>=</span> SSLContext.<span style=color:#a6e22e>getInstance</span>(<span style=color:#e6db74>&#34;TLS&#34;</span>);
</span></span><span style=display:flex><span>        sslContext.<span style=color:#a6e22e>init</span>(<span style=color:#66d9ef>null</span>, tmf.<span style=color:#a6e22e>getTrustManagers</span>(), <span style=color:#66d9ef>null</span>);
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        HttpsURLConnection.<span style=color:#a6e22e>setDefaultSSLSocketFactory</span>(sslContext.<span style=color:#a6e22e>getSocketFactory</span>());
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> String <span style=color:#a6e22e>authenticate</span>(String username, String password) <span style=color:#66d9ef>throws</span> Exception {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// SSL 컨텍스트 설정</span>
</span></span><span style=display:flex><span>        setupSSLContext();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// API 요청</span>
</span></span><span style=display:flex><span>        URL url <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> URL(baseUrl <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;/api/tokens/authenticate&#34;</span>);
</span></span><span style=display:flex><span>        HttpsURLConnection conn <span style=color:#f92672>=</span> (HttpsURLConnection) url.<span style=color:#a6e22e>openConnection</span>();
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>            <span style=color:#75715e>// 요청 설정</span>
</span></span><span style=display:flex><span>            conn.<span style=color:#a6e22e>setRequestMethod</span>(<span style=color:#e6db74>&#34;POST&#34;</span>);
</span></span><span style=display:flex><span>            conn.<span style=color:#a6e22e>setRequestProperty</span>(<span style=color:#e6db74>&#34;Accept&#34;</span>, <span style=color:#e6db74>&#34;application/vnd.blackducksoftware.user-4+json&#34;</span>);
</span></span><span style=display:flex><span>            conn.<span style=color:#a6e22e>setRequestProperty</span>(<span style=color:#e6db74>&#34;Content-Type&#34;</span>, <span style=color:#e6db74>&#34;application/json&#34;</span>);
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#75715e>// Basic Auth 설정</span>
</span></span><span style=display:flex><span>            String auth <span style=color:#f92672>=</span> username <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;:&#34;</span> <span style=color:#f92672>+</span> password;
</span></span><span style=display:flex><span>            String encodedAuth <span style=color:#f92672>=</span> Base64.<span style=color:#a6e22e>getEncoder</span>().<span style=color:#a6e22e>encodeToString</span>(auth.<span style=color:#a6e22e>getBytes</span>(StandardCharsets.<span style=color:#a6e22e>UTF_8</span>));
</span></span><span style=display:flex><span>            conn.<span style=color:#a6e22e>setRequestProperty</span>(<span style=color:#e6db74>&#34;Authorization&#34;</span>, <span style=color:#e6db74>&#34;Basic &#34;</span> <span style=color:#f92672>+</span> encodedAuth);
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            conn.<span style=color:#a6e22e>setDoOutput</span>(<span style=color:#66d9ef>true</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#75715e>// 응답 처리</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>try</span> (BufferedReader br <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> BufferedReader(
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>new</span> InputStreamReader(conn.<span style=color:#a6e22e>getInputStream</span>(), StandardCharsets.<span style=color:#a6e22e>UTF_8</span>))) {
</span></span><span style=display:flex><span>                StringBuilder response <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> StringBuilder();
</span></span><span style=display:flex><span>                String line;
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>while</span> ((line <span style=color:#f92672>=</span> br.<span style=color:#a6e22e>readLine</span>()) <span style=color:#f92672>!=</span> <span style=color:#66d9ef>null</span>) {
</span></span><span style=display:flex><span>                    response.<span style=color:#a6e22e>append</span>(line);
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>return</span> response.<span style=color:#a6e22e>toString</span>();
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        } <span style=color:#66d9ef>finally</span> {
</span></span><span style=display:flex><span>            conn.<span style=color:#a6e22e>disconnect</span>();
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>main</span>(String<span style=color:#f92672>[]</span> args) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>            String baseUrl <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;https://your-blackduck-server&#34;</span>;
</span></span><span style=display:flex><span>            String trustStorePath <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;path/to/truststore.jks&#34;</span>;
</span></span><span style=display:flex><span>            String trustStorePassword <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;your-truststore-password&#34;</span>;
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            SecureBlackDuckApiClient client <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> SecureBlackDuckApiClient(
</span></span><span style=display:flex><span>                baseUrl, trustStorePath, trustStorePassword);
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            String response <span style=color:#f92672>=</span> client.<span style=color:#a6e22e>authenticate</span>(<span style=color:#e6db74>&#34;username&#34;</span>, <span style=color:#e6db74>&#34;password&#34;</span>);
</span></span><span style=display:flex><span>            System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;Authentication Response: &#34;</span> <span style=color:#f92672>+</span> response);
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>        } <span style=color:#66d9ef>catch</span> (Exception e) {
</span></span><span style=display:flex><span>            e.<span style=color:#a6e22e>printStackTrace</span>();
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>이 코드의 주요 특징:</p><ol><li>자동으로 서버 인증서를 가져와서 신뢰할 수 있는 저장소에 저장합니다.</li><li>저장된 인증서를 사용하여 안전한 HTTPS 연결을 설정합니다.</li><li>트러스트 스토어를 파일로 관리하여 재사용할 수 있습니다.</li></ol><p>사용 방법:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#75715e>// 클라이언트 생성</span>
</span></span><span style=display:flex><span>SecureBlackDuckApiClient client <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> SecureBlackDuckApiClient(
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;https://your-blackduck-server&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;/path/to/truststore.jks&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;truststore-password&#34;</span>
</span></span><span style=display:flex><span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// API 호출</span>
</span></span><span style=display:flex><span>String response <span style=color:#f92672>=</span> client.<span style=color:#a6e22e>authenticate</span>(<span style=color:#e6db74>&#34;username&#34;</span>, <span style=color:#e6db74>&#34;password&#34;</span>);
</span></span></code></pre></div><p>주의사항:</p><ol><li>실제 사용 시 비밀번호와 민감한 정보는 설정 파일이나 환경 변수로 관리하세요.</li><li>예외 처리를 더 세밀하게 구현하세요.</li><li>트러스트 스토어 파일의 권한 설정에 주의하세요.</li><li>정기적으로 인증서를 갱신하는 로직을 추가하세요.</li></ol></div><footer class=post-footer><ul class=post-tags><li><a href=https://jongyongpark.github.io/tags/coverity/>Coverity</a></li><li><a href=https://jongyongpark.github.io/tags/api/>API</a></li><li><a href=https://jongyongpark.github.io/tags/ssl/>SSL</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://jongyongpark.github.io/>RyanLabs</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>